lists of files in version control and sdist match
/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/fs/__init__.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__("pkg_resources").declare_namespace(__name__)  # type: ignore
 Network docker_services_cli_default  Creating
 Network docker_services_cli_default  Created
 Container docker_services_cli-postgresql-1  Creating
 Container docker_services_cli-opensearch-1  Creating
 Container docker_services_cli-rabbitmq-1  Creating
 Container docker_services_cli-redis-1  Creating
 Container docker_services_cli-redis-1  Created
 Container docker_services_cli-rabbitmq-1  Created
 Container docker_services_cli-opensearch-1  Created
 Container docker_services_cli-postgresql-1  Created
 Container docker_services_cli-rabbitmq-1  Starting
 Container docker_services_cli-postgresql-1  Starting
 Container docker_services_cli-redis-1  Starting
 Container docker_services_cli-opensearch-1  Starting
 Container docker_services_cli-redis-1  Started
 Container docker_services_cli-postgresql-1  Started
 Container docker_services_cli-rabbitmq-1  Started
 Container docker_services_cli-opensearch-1  Started
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/passlib/utils/__init__.py,line=854::'crypt' is deprecated and slated for removal in Python 3.13
============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-8.4.2, pluggy-1.6.0
rootdir: /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo
configfile: setup.cfg
testpaths: docs, tests, invenio_audit_logs
plugins: github-actions-annotate-failures-0.3.0, pycodestyle-2.5.0, flask-1.3.0, black-ng-0.4.1, invenio-3.4.2, isort-4.0.0, cov-7.0.0, pydocstyle-2.4.0
collected 114 items
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/jsonresolver/contrib/jsonschema.py,line=31::jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/jsonresolver/contrib/jsonschema.py,line=31::jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records/resolver.py,line=14::jsonschema.exceptions.RefResolutionError is deprecated as of version 4.18.0. If you wish to catch potential reference resolution errors, directly catch referencing.exceptions.Unresolvable.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records/resolver.py,line=14::jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records/resolver.py,line=14::jsonschema.exceptions.RefResolutionError is deprecated as of version 4.18.0. If you wish to catch potential reference resolution errors, directly catch referencing.exceptions.Unresolvable.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records/resolver.py,line=14::jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/fs/__init__.py,line=4::pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/pkg_resources/__init__.py,line=3146::Deprecated call to `pkg_resources.declare_namespace('sphinxcontrib')`.%0AImplementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/fs/__init__.py,line=4::Deprecated call to `pkg_resources.declare_namespace('fs')`.%0AImplementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/fs/opener/__init__.py,line=6::Deprecated call to `pkg_resources.declare_namespace('fs.opener')`.%0AImplementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/pkg_resources/__init__.py,line=2558::Deprecated call to `pkg_resources.declare_namespace('fs')`.%0AImplementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/marshmallow_utils/fields/generated.py,line=12::The '__version_info__' attribute is deprecated and will be removed in in a future version. Use feature detection or 'packaging.Version(importlib.metadata.version("marshmallow")).release' instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/marshmallow_utils/fields/generated.py,line=12::The '__version_info__' attribute is deprecated and will be removed in in a future version. Use feature detection or 'packaging.Version(importlib.metadata.version("marshmallow")).release' instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/files/schema.py,line=154::The 'default' argument to fields is deprecated. Use 'dump_default' instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/base/links.py,line=140::Link is deprecated and will be removed in v14.0. Use `ExternalLink` for third-party links and `EndpointLink` for InvenioRDM links.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/base/links.py,line=140::Link is deprecated and will be removed in v14.0. Use `ExternalLink` for third-party links and `EndpointLink` for InvenioRDM links.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/base/links.py,line=140::Link is deprecated and will be removed in v14.0. Use `ExternalLink` for third-party links and `EndpointLink` for InvenioRDM links.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/base/links.py,line=140::Link is deprecated and will be removed in v14.0. Use `ExternalLink` for third-party links and `EndpointLink` for InvenioRDM links.

docs/conf.py ...                                                         [  2%]
tests/conftest.py ...                                                    [  5%]
tests/mock_module/__init__.py ...                                        [  7%]
tests/mock_module/auditlog/actions.py ...                                [ 10%]
tests/services/__init__.py ...                                           [ 13%]
tests/services/conftest.py ...                                           [ 15%]
tests/services/test_action_builder.py ...                                [ 18%]
tests/services/test_service.py ...::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_rest/ext.py,line=29::CSRF validation will be enabled by default in the version 1.3.x
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py,line=3624::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_security/utils.py,line=77::Remember me support has been removed.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_security/utils.py,line=87::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/sqlalchemy_utils/models.py,line=33::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_kvsession/__init__.py,line=39::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/invenio_audit_logs/services/service.py,line=38::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/schema.py,line=90::The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/marshmallow/fields.py,line=631::The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records/models.py,line=44::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/schema.py,line=105::The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
.::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py,line=3624::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py,line=3624::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_security/utils.py,line=77::Remember me support has been removed.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_security/utils.py,line=87::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/sqlalchemy_utils/models.py,line=33::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_kvsession/__init__.py,line=39::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
.::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/invenio_audit_logs/services/service.py,line=38::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/schema.py,line=90::The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/marshmallow/fields.py,line=631::The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/marshmallow/fields.py,line=631::The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py,line=3624::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py,line=3624::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records/models.py,line=44::datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/schema.py,line=105::The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/marshmallow/fields.py,line=631::The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/marshmallow/fields.py,line=631::The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/marshmallow/fields.py,line=631::The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
                                     [ 22%]
tests/test_alembic.py ..::error file=package-repo/tests/test_alembic.py,line=35::test_alembic%0A%0AAssertionError: assert [('add_table'...a=None)), ...] == []%0A  %0A  Left contains 49 more items, first extra item: ('add_table', Table('access_actionssystemroles', MetaData(), Column('role_name', String(length=40), table=<access_acti...lause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionssystemroles>), schema=None))%0A  %0A  Full diff:%0A  - []%0A  + [%0A  +     (%0A  +         'add_table',%0A  +         Table('access_actionssystemroles', MetaData(), Column('role_name', String(length=40), table=<access_actionssystemroles>, nullable=False), Column('id', Integer(), table=<access_actionssystemroles>, primary_key=True, nullable=False), Column('action', String(length=80), table=<access_actionssystemroles>), Column('exclude', Boolean(name='exclude'), table=<access_actionssystemroles>, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionssystemroles>), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_access_actionssystemroles_action', Column('action', String(length=80), table=<access_actionssystemroles>)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_access_actionssystemroles_argument', Column('argument', String(length=255), table=<access_actionssystemroles>)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_access_actionssystemroles_role_name', Column('role_name', String(length=40), table=<access_actionssystemroles>, nullable=False)),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('accounts_domain_category', MetaData(), Column('id', Integer(), table=<accounts_domain_category>, primary_key=True, nullable=False), Column('label', String(length=255), table=<accounts_domain_category>), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('accounts_domain_org', MetaData(), Column('id', Integer(), table=<accounts_domain_org>, primary_key=True, nullable=False), Column('pid', String(length=255), table=<accounts_domain_org>), Column('name', String(length=255), table=<accounts_domain_org>, nullable=False), Column('json', JSON(), table=<accounts_domain_org>, nullable=False, default=CallableColumnDefault(<function DomainOrg.<lambda> at 0x7f40bb761580>)), Column('parent_id', Integer(), ForeignKey('accounts_domain_org.id'), table=<accounts_domain_org>), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('accounts_role', MetaData(), Column('id', String(length=80), table=<accounts_role>, primary_key=True, nullable=False, default=CallableColumnDefault(<function Role.<lambda> at 0x7f40bbbee020>)), Column('name', String(length=80), table=<accounts_role>), Column('description', String(length=255), table=<accounts_role>), Column('is_managed', Boolean(), table=<accounts_role>, nullable=False, default=ScalarElementColumnDefault(True)), Column('version_id', Integer(), table=<accounts_role>, nullable=False), Column('created', DateTime(), table=<accounts_role>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_role>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('accounts_user', MetaData(), Column('id', Integer(), table=<accounts_user>, primary_key=True, nullable=False), Column('username', String(length=255), table=<accounts_user>), Column('displayname', String(length=255), table=<accounts_user>), Column('email', String(length=255), table=<accounts_user>), Column('domain', String(length=255), table=<accounts_user>), Column('password', String(length=255), table=<accounts_user>), Column('active', Boolean(name='active'), table=<accounts_user>), Column('confirmed_at', DateTime(), table=<accounts_user>), Column('version_id', Integer(), table=<accounts_user>, nullable=False), Column('profile', JSON(), table=<accounts_user>, default=CallableColumnDefault(<function User.<lambda> at 0x7f40bbbef380>)), Column('preferences', JSON(), table=<accounts_user>, default=CallableColumnDefault(<function User.<lambda> at 0x7f40bbbef4c0>)), Column('blocked_at', DateTime(), table=<accounts_user>), Column('verified_at', DateTime(), table=<accounts_user>), Column('created', DateTime(), table=<accounts_user>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_user>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('audit_logs_metadata', MetaData(), Column('action', String(length=255), table=<audit_logs_metadata>, nullable=False), Column('resource_type', String(length=255), table=<audit_logs_metadata>, nullable=False), Column('user_id', String(length=255), table=<audit_logs_metadata>, nullable=False), Column('id', UUIDType(), table=<audit_logs_metadata>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bab40e00>)), Column('json', JSON(), table=<audit_logs_metadata>, default=CallableColumnDefault(<function RecordMetadataBase.<lambda> at 0x7f40bab40f40>)), Column('version_id', Integer(), table=<audit_logs_metadata>, nullable=False), Column('created', DateTime(), table=<audit_logs_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd4e0>)), Column('updated', DateTime(), table=<audit_logs_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd9e0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('files_files', MetaData(), Column('id', UUIDType(), table=<files_files>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb9ede0>)), Column('uri', Text(), table=<files_files>), Column('storage_class', String(length=1), table=<files_files>), Column('size', BigInteger(), table=<files_files>, default=ScalarElementColumnDefault(0)), Column('checksum', String(length=255), table=<files_files>), Column('readable', Boolean(name='readable'), table=<files_files>, nullable=False, default=ScalarElementColumnDefault(True)), Column('writable', Boolean(name='writable'), table=<files_files>, nullable=False, default=ScalarElementColumnDefault(True)), Column('last_check_at', DateTime(), table=<files_files>), Column('last_check', Boolean(name='last_check'), table=<files_files>, default=ScalarElementColumnDefault(True)), Column('created', DateTime(), table=<files_files>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_files>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('files_location', MetaData(), Column('id', Integer(), table=<files_location>, primary_key=True, nullable=False), Column('name', String(length=20), table=<files_location>, nullable=False), Column('uri', String(length=255), table=<files_location>, nullable=False), Column('default', Boolean(name='default'), table=<files_location>, nullable=False, default=ScalarElementColumnDefault(False)), Column('created', DateTime(), table=<files_location>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_location>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('pidstore_pid', MetaData(), Column('id', Integer(), table=<pidstore_pid>, primary_key=True, nullable=False), Column('pid_type', String(length=6), table=<pidstore_pid>, nullable=False), Column('pid_value', String(length=255), table=<pidstore_pid>, nullable=False), Column('pid_provider', String(length=8), table=<pidstore_pid>), Column('status', ChoiceType(length=1), table=<pidstore_pid>, nullable=False), Column('object_type', String(length=3), table=<pidstore_pid>), Column('object_uuid', UUIDType(), table=<pidstore_pid>), Column('created', DateTime(), table=<pidstore_pid>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<pidstore_pid>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('idx_object', Column('object_type', String(length=3), table=<pidstore_pid>), Column('object_uuid', UUIDType(), table=<pidstore_pid>)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('idx_status', Column('status', ChoiceType(length=1), table=<pidstore_pid>, nullable=False)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('uidx_type_pid', Column('pid_type', String(length=6), table=<pidstore_pid>, nullable=False), Column('pid_value', String(length=255), table=<pidstore_pid>, nullable=False), unique=True),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('pidstore_recid', MetaData(), Column('recid', BigInteger(), table=<pidstore_recid>, primary_key=True, nullable=False), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('records_metadata', MetaData(), Column('id', UUIDType(), table=<records_metadata>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bab40e00>)), Column('json', JSON(), table=<records_metadata>, default=CallableColumnDefault(<function RecordMetadataBase.<lambda> at 0x7f40bab40f40>)), Column('version_id', Integer(), table=<records_metadata>, nullable=False), Column('created', DateTime(), table=<records_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd4e0>)), Column('updated', DateTime(), table=<records_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd9e0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('records_metadata_version', MetaData(), Column('id', UUIDType(), table=<records_metadata_version>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bab40e00>)), Column('json', JSON(), table=<records_metadata_version>, default=CallableColumnDefault(<function RecordMetadataBase.<lambda> at 0x7f40bab40f40>)), Column('version_id', Integer(), table=<records_metadata_version>), Column('created', DateTime(), table=<records_metadata_version>, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd4e0>)), Column('updated', DateTime(), table=<records_metadata_version>, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd9e0>)), Column('transaction_id', BigInteger(), table=<records_metadata_version>, primary_key=True, nullable=False), Column('end_transaction_id', BigInteger(), table=<records_metadata_version>), Column('operation_type', SmallInteger(), table=<records_metadata_version>, nullable=False), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_records_metadata_version_end_transaction_id', Column('end_transaction_id', BigInteger(), table=<records_metadata_version>)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_records_metadata_version_operation_type', Column('operation_type', SmallInteger(), table=<records_metadata_version>, nullable=False)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_records_metadata_version_transaction_id', Column('transaction_id', BigInteger(), table=<records_metadata_version>, primary_key=True, nullable=False)),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('access_actionsroles', MetaData(), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=<access_actionsroles>, nullable=False), Column('id', Integer(), table=<access_actionsroles>, primary_key=True, nullable=False), Column('action', String(length=80), table=<access_actionsroles>), Column('exclude', Boolean(name='exclude'), table=<access_actionsroles>, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionsroles>), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_access_actionsroles_action', Column('action', String(length=80), table=<access_actionsroles>)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_access_actionsroles_argument', Column('argument', String(length=255), table=<access_actionsroles>)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_access_actionsroles_role_id', Column('role_id', String(length=80), table=<access_actionsroles>, nullable=False)),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('access_actionsusers', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<access_actionsusers>, nullable=False), Column('id', Integer(), table=<access_actionsusers>, primary_key=True, nullable=False), Column('action', String(length=80), table=<access_actionsusers>), Column('exclude', Boolean(name='exclude'), table=<access_actionsusers>, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionsusers>), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_access_actionsusers_action', Column('action', String(length=80), table=<access_actionsusers>)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_access_actionsusers_argument', Column('argument', String(length=255), table=<access_actionsusers>)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_access_actionsusers_user_id', Column('user_id', Integer(), table=<access_actionsusers>, nullable=False)),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('accounts_domains', MetaData(), Column('id', Integer(), table=<accounts_domains>, primary_key=True, nullable=False), Column('domain', String(length=255), table=<accounts_domains>, nullable=False), Column('tld', String(length=255), table=<accounts_domains>, nullable=False), Column('status', ChoiceType(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(<DomainStatus.new: 1>)), Column('flagged', Boolean(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(False)), Column('flagged_source', String(length=255), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault('')), Column('org_id', Integer(), ForeignKey('accounts_domain_org.id'), table=<accounts_domains>), Column('category', Integer(), ForeignKey('accounts_domain_category.id'), table=<accounts_domains>), Column('num_users', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_active', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_inactive', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_confirmed', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_verified', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_blocked', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('created', DateTime(), table=<accounts_domains>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_domains>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('accounts_user_login_information', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<accounts_user_login_information>, primary_key=True, nullable=False), Column('last_login_at', DateTime(), table=<accounts_user_login_information>), Column('current_login_at', DateTime(), table=<accounts_user_login_information>), Column('last_login_ip', IPAddressType(length=50), table=<accounts_user_login_information>), Column('current_login_ip', IPAddressType(length=50), table=<accounts_user_login_information>), Column('login_count', Integer(), table=<accounts_user_login_information>), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('accounts_user_session_activity', MetaData(), Column('sid_s', String(length=255), table=<accounts_user_session_activity>, primary_key=True, nullable=False), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<accounts_user_session_activity>), Column('ip', String(length=80), table=<accounts_user_session_activity>), Column('country', String(length=3), table=<accounts_user_session_activity>), Column('browser', String(length=80), table=<accounts_user_session_activity>), Column('browser_version', String(length=30), table=<accounts_user_session_activity>), Column('os', String(length=80), table=<accounts_user_session_activity>), Column('device', String(length=80), table=<accounts_user_session_activity>), Column('created', DateTime(), table=<accounts_user_session_activity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_user_session_activity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('accounts_useridentity', MetaData(), Column('id', String(length=255), table=<accounts_useridentity>, primary_key=True, nullable=False), Column('method', String(length=255), table=<accounts_useridentity>, primary_key=True, nullable=False), Column('id_user', Integer(), ForeignKey('accounts_user.id'), table=<accounts_useridentity>, nullable=False), Column('created', DateTime(), table=<accounts_useridentity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_useridentity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('accounts_useridentity_id_user_method', Column('id_user', Integer(), table=<accounts_useridentity>, nullable=False), Column('method', String(length=255), table=<accounts_useridentity>, primary_key=True, nullable=False), unique=True),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('accounts_userrole', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<accounts_userrole>), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=<accounts_userrole>), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('files_bucket', MetaData(), Column('id', UUIDType(), table=<files_bucket>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb662a0>)), Column('default_location', Integer(), ForeignKey('files_location.id'), table=<files_bucket>, nullable=False), Column('default_storage_class', String(length=1), table=<files_bucket>, nullable=False, default=CallableColumnDefault(<function Bucket.<lambda> at 0x7f40bcb679c0>)), Column('size', BigInteger(), table=<files_bucket>, nullable=False, default=ScalarElementColumnDefault(0)), Column('quota_size', BigInteger(), table=<files_bucket>, default=CallableColumnDefault(<function Bucket.<lambda> at 0x7f40bcb67b00>)), Column('max_file_size', BigInteger(), table=<files_bucket>, default=CallableColumnDefault(<function Bucket.<lambda> at 0x7f40bcb67c40>)), Column('locked', Boolean(name='locked'), table=<files_bucket>, nullable=False, default=ScalarElementColumnDefault(False)), Column('deleted', Boolean(name='deleted'), table=<files_bucket>, nullable=False, default=ScalarElementColumnDefault(False)), Column('created', DateTime(), table=<files_bucket>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_bucket>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('pidstore_redirect', MetaData(), Column('id', UUIDType(), table=<pidstore_redirect>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40ba7d6f20>)), Column('pid_id', Integer(), ForeignKey('pidstore_pid.id'), table=<pidstore_redirect>, nullable=False), Column('created', DateTime(), table=<pidstore_redirect>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<pidstore_redirect>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('transaction', MetaData(), Column('id', BigInteger(), table=<transaction>, primary_key=True, nullable=False, default=Sequence('transaction_id_seq', metadata=MetaData())), Column('remote_addr', String(length=50), table=<transaction>), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<transaction>), Column('issued_at', DateTime(), table=<transaction>, default=CallableColumnDefault(<function utc_now at 0x7f40bacf2f20>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_transaction_user_id', Column('user_id', Integer(), table=<transaction>)),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('files_buckettags', MetaData(), Column('bucket_id', UUIDType(), ForeignKey('files_bucket.id'), table=<files_buckettags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb9dd00>)), Column('key', String(length=255), table=<files_buckettags>, primary_key=True, nullable=False), Column('value', Text(), table=<files_buckettags>, nullable=False), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_files_buckettags_bucket_id', Column('bucket_id', UUIDType(), table=<files_buckettags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb9dd00>))),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('files_multipartobject', MetaData(), Column('upload_id', UUIDType(), table=<files_multipartobject>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbe13a0>)), Column('bucket_id', UUIDType(), ForeignKey('files_bucket.id'), table=<files_multipartobject>), Column('key', Text(), table=<files_multipartobject>), Column('file_id', UUIDType(), ForeignKey('files_files.id'), table=<files_multipartobject>, nullable=False), Column('chunk_size', Integer(), table=<files_multipartobject>), Column('size', BigInteger(), table=<files_multipartobject>), Column('completed', Boolean(name='completed'), table=<files_multipartobject>, nullable=False, default=ScalarElementColumnDefault(False)), Column('created', DateTime(), table=<files_multipartobject>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_multipartobject>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_files_multipartobject_bucket_id', Column('bucket_id', UUIDType(), table=<files_multipartobject>)),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('files_object', MetaData(), Column('version_id', UUIDType(), table=<files_object>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbb84a0>)), Column('key', Text(), table=<files_object>, nullable=False), Column('bucket_id', UUIDType(), ForeignKey('files_bucket.id'), table=<files_object>, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbb9120>)), Column('file_id', UUIDType(), ForeignKey('files_files.id'), table=<files_object>), Column('_mimetype', String(length=255), table=<files_object>), Column('is_head', Boolean(name='is_head'), table=<files_object>, nullable=False, default=ScalarElementColumnDefault(True)), Column('created', DateTime(), table=<files_object>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_object>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_files_object__mimetype', Column('_mimetype', String(length=255), table=<files_object>)),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_files_object_bucket_id', Column('bucket_id', UUIDType(), table=<files_object>, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbb9120>))),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('files_multipartobject_part', MetaData(), Column('upload_id', UUIDType(), ForeignKey('files_multipartobject.upload_id'), table=<files_multipartobject_part>, primary_key=True, nullable=False), Column('part_number', Integer(), table=<files_multipartobject_part>, primary_key=True, nullable=False), Column('checksum', String(length=255), table=<files_multipartobject_part>), Column('created', DateTime(), table=<files_multipartobject_part>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_multipartobject_part>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_table',%0A  +         Table('files_objecttags', MetaData(), Column('version_id', UUIDType(), ForeignKey('files_object.version_id'), table=<files_objecttags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbe0180>)), Column('key', String(length=255), table=<files_objecttags>, primary_key=True, nullable=False), Column('value', Text(), table=<files_objecttags>, nullable=False), schema=None),%0A  +     ),%0A  +     (%0A  +         'add_index',%0A  +         Index('ix_files_objecttags_version_id', Column('version_id', UUIDType(), table=<files_objecttags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbe0180>))),%0A  +     ),%0A  + ]
F::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_rest/ext.py,line=29::CSRF validation will be enabled by default in the version 1.3.x
::warning file=/home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_caching/__init__.py,line=145::Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
                                                [ 25%]
tests/test_invenio_audit_logs.py ....                                    [ 28%]
invenio_audit_logs/__init__.py ...                                       [ 31%]
invenio_audit_logs/alembic/1743073617_create_audit_logs_branch.py ...    [ 34%]
invenio_audit_logs/alembic/1743073720_create_audit_logs_table.py ...     [ 36%]
invenio_audit_logs/config.py ...                                         [ 39%]
invenio_audit_logs/ext.py ...                                            [ 42%]
invenio_audit_logs/proxies.py ...                                        [ 44%]
invenio_audit_logs/records/__init__.py ...                               [ 47%]
invenio_audit_logs/records/api.py ...                                    [ 50%]
invenio_audit_logs/records/mappings/__init__.py ...                      [ 52%]
invenio_audit_logs/records/mappings/templates/__init__.py ...            [ 55%]
invenio_audit_logs/records/mappings/templates/os-v1/__init__.py ...      [ 57%]
invenio_audit_logs/records/mappings/templates/os-v2/__init__.py ...      [ 60%]
invenio_audit_logs/records/models.py ...                                 [ 63%]
invenio_audit_logs/records/systemfields/__init__.py ...                  [ 65%]
invenio_audit_logs/records/systemfields/action.py ...                    [ 68%]
invenio_audit_logs/resources/__init__.py ...                             [ 71%]
invenio_audit_logs/resources/config.py ...                               [ 73%]
invenio_audit_logs/resources/resource.py ...                             [ 76%]
invenio_audit_logs/services/__init__.py ...                              [ 78%]
invenio_audit_logs/services/action.py ...                                [ 81%]
invenio_audit_logs/services/config.py ...                                [ 84%]
invenio_audit_logs/services/permissions.py ...                           [ 86%]
invenio_audit_logs/services/results.py ...                               [ 89%]
invenio_audit_logs/services/schema.py ...                                [ 92%]
invenio_audit_logs/services/service.py ...                               [ 94%]
invenio_audit_logs/services/uow.py ...                                   [ 97%]
invenio_audit_logs/views.py ...                                          [100%]

=================================== FAILURES ===================================
_________________________________ test_alembic _________________________________

base_app = <Flask 'invenio'>
database = <SQLAlchemy postgresql+psycopg2://invenio:***@localhost:5432/invenio>

    def test_alembic(base_app, database):
        """Test alembic recipes."""
        db = database
        ext = base_app.extensions["invenio-db"]
    
        if db.engine.name == "sqlite":
            raise pytest.skip("Upgrades are not supported on SQLite.")
    
        base_app.config["ALEMBIC_CONTEXT"] = alembic_test_context()
    
        # Check that this package's SQLAlchemy models have been properly registered
        assert "audit_logs_metadata" in db.metadata.tables
    
        # Check that Alembic agrees that there's no further tables to create.
        assert list(ext.alembic.compare_metadata()) == []
    
        # Drop everything and recreate tables all with Alembic
        db.drop_all()
        drop_alembic_version_table()
        ext.alembic.upgrade()
>       assert list(ext.alembic.compare_metadata()) == []
E       AssertionError: assert [('add_table'...a=None)), ...] == []
E         
E         Left contains 49 more items, first extra item: ('add_table', Table('access_actionssystemroles', MetaData(), Column('role_name', String(length=40), table=<access_acti...lause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionssystemroles>), schema=None))
E         
E         Full diff:
E         - []
E         + [
E         +     (
E         +         'add_table',
E         +         Table('access_actionssystemroles', MetaData(), Column('role_name', String(length=40), table=<access_actionssystemroles>, nullable=False), Column('id', Integer(), table=<access_actionssystemroles>, primary_key=True, nullable=False), Column('action', String(length=80), table=<access_actionssystemroles>), Column('exclude', Boolean(name='exclude'), table=<access_actionssystemroles>, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionssystemroles>), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_access_actionssystemroles_action', Column('action', String(length=80), table=<access_actionssystemroles>)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_access_actionssystemroles_argument', Column('argument', String(length=255), table=<access_actionssystemroles>)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_access_actionssystemroles_role_name', Column('role_name', String(length=40), table=<access_actionssystemroles>, nullable=False)),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('accounts_domain_category', MetaData(), Column('id', Integer(), table=<accounts_domain_category>, primary_key=True, nullable=False), Column('label', String(length=255), table=<accounts_domain_category>), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('accounts_domain_org', MetaData(), Column('id', Integer(), table=<accounts_domain_org>, primary_key=True, nullable=False), Column('pid', String(length=255), table=<accounts_domain_org>), Column('name', String(length=255), table=<accounts_domain_org>, nullable=False), Column('json', JSON(), table=<accounts_domain_org>, nullable=False, default=CallableColumnDefault(<function DomainOrg.<lambda> at 0x7f40bb761580>)), Column('parent_id', Integer(), ForeignKey('accounts_domain_org.id'), table=<accounts_domain_org>), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('accounts_role', MetaData(), Column('id', String(length=80), table=<accounts_role>, primary_key=True, nullable=False, default=CallableColumnDefault(<function Role.<lambda> at 0x7f40bbbee020>)), Column('name', String(length=80), table=<accounts_role>), Column('description', String(length=255), table=<accounts_role>), Column('is_managed', Boolean(), table=<accounts_role>, nullable=False, default=ScalarElementColumnDefault(True)), Column('version_id', Integer(), table=<accounts_role>, nullable=False), Column('created', DateTime(), table=<accounts_role>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_role>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('accounts_user', MetaData(), Column('id', Integer(), table=<accounts_user>, primary_key=True, nullable=False), Column('username', String(length=255), table=<accounts_user>), Column('displayname', String(length=255), table=<accounts_user>), Column('email', String(length=255), table=<accounts_user>), Column('domain', String(length=255), table=<accounts_user>), Column('password', String(length=255), table=<accounts_user>), Column('active', Boolean(name='active'), table=<accounts_user>), Column('confirmed_at', DateTime(), table=<accounts_user>), Column('version_id', Integer(), table=<accounts_user>, nullable=False), Column('profile', JSON(), table=<accounts_user>, default=CallableColumnDefault(<function User.<lambda> at 0x7f40bbbef380>)), Column('preferences', JSON(), table=<accounts_user>, default=CallableColumnDefault(<function User.<lambda> at 0x7f40bbbef4c0>)), Column('blocked_at', DateTime(), table=<accounts_user>), Column('verified_at', DateTime(), table=<accounts_user>), Column('created', DateTime(), table=<accounts_user>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_user>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('audit_logs_metadata', MetaData(), Column('action', String(length=255), table=<audit_logs_metadata>, nullable=False), Column('resource_type', String(length=255), table=<audit_logs_metadata>, nullable=False), Column('user_id', String(length=255), table=<audit_logs_metadata>, nullable=False), Column('id', UUIDType(), table=<audit_logs_metadata>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bab40e00>)), Column('json', JSON(), table=<audit_logs_metadata>, default=CallableColumnDefault(<function RecordMetadataBase.<lambda> at 0x7f40bab40f40>)), Column('version_id', Integer(), table=<audit_logs_metadata>, nullable=False), Column('created', DateTime(), table=<audit_logs_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd4e0>)), Column('updated', DateTime(), table=<audit_logs_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd9e0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('files_files', MetaData(), Column('id', UUIDType(), table=<files_files>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb9ede0>)), Column('uri', Text(), table=<files_files>), Column('storage_class', String(length=1), table=<files_files>), Column('size', BigInteger(), table=<files_files>, default=ScalarElementColumnDefault(0)), Column('checksum', String(length=255), table=<files_files>), Column('readable', Boolean(name='readable'), table=<files_files>, nullable=False, default=ScalarElementColumnDefault(True)), Column('writable', Boolean(name='writable'), table=<files_files>, nullable=False, default=ScalarElementColumnDefault(True)), Column('last_check_at', DateTime(), table=<files_files>), Column('last_check', Boolean(name='last_check'), table=<files_files>, default=ScalarElementColumnDefault(True)), Column('created', DateTime(), table=<files_files>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_files>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('files_location', MetaData(), Column('id', Integer(), table=<files_location>, primary_key=True, nullable=False), Column('name', String(length=20), table=<files_location>, nullable=False), Column('uri', String(length=255), table=<files_location>, nullable=False), Column('default', Boolean(name='default'), table=<files_location>, nullable=False, default=ScalarElementColumnDefault(False)), Column('created', DateTime(), table=<files_location>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_location>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('pidstore_pid', MetaData(), Column('id', Integer(), table=<pidstore_pid>, primary_key=True, nullable=False), Column('pid_type', String(length=6), table=<pidstore_pid>, nullable=False), Column('pid_value', String(length=255), table=<pidstore_pid>, nullable=False), Column('pid_provider', String(length=8), table=<pidstore_pid>), Column('status', ChoiceType(length=1), table=<pidstore_pid>, nullable=False), Column('object_type', String(length=3), table=<pidstore_pid>), Column('object_uuid', UUIDType(), table=<pidstore_pid>), Column('created', DateTime(), table=<pidstore_pid>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<pidstore_pid>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('idx_object', Column('object_type', String(length=3), table=<pidstore_pid>), Column('object_uuid', UUIDType(), table=<pidstore_pid>)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('idx_status', Column('status', ChoiceType(length=1), table=<pidstore_pid>, nullable=False)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('uidx_type_pid', Column('pid_type', String(length=6), table=<pidstore_pid>, nullable=False), Column('pid_value', String(length=255), table=<pidstore_pid>, nullable=False), unique=True),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('pidstore_recid', MetaData(), Column('recid', BigInteger(), table=<pidstore_recid>, primary_key=True, nullable=False), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('records_metadata', MetaData(), Column('id', UUIDType(), table=<records_metadata>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bab40e00>)), Column('json', JSON(), table=<records_metadata>, default=CallableColumnDefault(<function RecordMetadataBase.<lambda> at 0x7f40bab40f40>)), Column('version_id', Integer(), table=<records_metadata>, nullable=False), Column('created', DateTime(), table=<records_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd4e0>)), Column('updated', DateTime(), table=<records_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd9e0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('records_metadata_version', MetaData(), Column('id', UUIDType(), table=<records_metadata_version>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bab40e00>)), Column('json', JSON(), table=<records_metadata_version>, default=CallableColumnDefault(<function RecordMetadataBase.<lambda> at 0x7f40bab40f40>)), Column('version_id', Integer(), table=<records_metadata_version>), Column('created', DateTime(), table=<records_metadata_version>, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd4e0>)), Column('updated', DateTime(), table=<records_metadata_version>, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd9e0>)), Column('transaction_id', BigInteger(), table=<records_metadata_version>, primary_key=True, nullable=False), Column('end_transaction_id', BigInteger(), table=<records_metadata_version>), Column('operation_type', SmallInteger(), table=<records_metadata_version>, nullable=False), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_records_metadata_version_end_transaction_id', Column('end_transaction_id', BigInteger(), table=<records_metadata_version>)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_records_metadata_version_operation_type', Column('operation_type', SmallInteger(), table=<records_metadata_version>, nullable=False)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_records_metadata_version_transaction_id', Column('transaction_id', BigInteger(), table=<records_metadata_version>, primary_key=True, nullable=False)),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('access_actionsroles', MetaData(), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=<access_actionsroles>, nullable=False), Column('id', Integer(), table=<access_actionsroles>, primary_key=True, nullable=False), Column('action', String(length=80), table=<access_actionsroles>), Column('exclude', Boolean(name='exclude'), table=<access_actionsroles>, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionsroles>), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_access_actionsroles_action', Column('action', String(length=80), table=<access_actionsroles>)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_access_actionsroles_argument', Column('argument', String(length=255), table=<access_actionsroles>)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_access_actionsroles_role_id', Column('role_id', String(length=80), table=<access_actionsroles>, nullable=False)),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('access_actionsusers', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<access_actionsusers>, nullable=False), Column('id', Integer(), table=<access_actionsusers>, primary_key=True, nullable=False), Column('action', String(length=80), table=<access_actionsusers>), Column('exclude', Boolean(name='exclude'), table=<access_actionsusers>, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionsusers>), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_access_actionsusers_action', Column('action', String(length=80), table=<access_actionsusers>)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_access_actionsusers_argument', Column('argument', String(length=255), table=<access_actionsusers>)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_access_actionsusers_user_id', Column('user_id', Integer(), table=<access_actionsusers>, nullable=False)),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('accounts_domains', MetaData(), Column('id', Integer(), table=<accounts_domains>, primary_key=True, nullable=False), Column('domain', String(length=255), table=<accounts_domains>, nullable=False), Column('tld', String(length=255), table=<accounts_domains>, nullable=False), Column('status', ChoiceType(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(<DomainStatus.new: 1>)), Column('flagged', Boolean(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(False)), Column('flagged_source', String(length=255), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault('')), Column('org_id', Integer(), ForeignKey('accounts_domain_org.id'), table=<accounts_domains>), Column('category', Integer(), ForeignKey('accounts_domain_category.id'), table=<accounts_domains>), Column('num_users', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_active', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_inactive', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_confirmed', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_verified', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_blocked', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('created', DateTime(), table=<accounts_domains>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_domains>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('accounts_user_login_information', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<accounts_user_login_information>, primary_key=True, nullable=False), Column('last_login_at', DateTime(), table=<accounts_user_login_information>), Column('current_login_at', DateTime(), table=<accounts_user_login_information>), Column('last_login_ip', IPAddressType(length=50), table=<accounts_user_login_information>), Column('current_login_ip', IPAddressType(length=50), table=<accounts_user_login_information>), Column('login_count', Integer(), table=<accounts_user_login_information>), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('accounts_user_session_activity', MetaData(), Column('sid_s', String(length=255), table=<accounts_user_session_activity>, primary_key=True, nullable=False), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<accounts_user_session_activity>), Column('ip', String(length=80), table=<accounts_user_session_activity>), Column('country', String(length=3), table=<accounts_user_session_activity>), Column('browser', String(length=80), table=<accounts_user_session_activity>), Column('browser_version', String(length=30), table=<accounts_user_session_activity>), Column('os', String(length=80), table=<accounts_user_session_activity>), Column('device', String(length=80), table=<accounts_user_session_activity>), Column('created', DateTime(), table=<accounts_user_session_activity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_user_session_activity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('accounts_useridentity', MetaData(), Column('id', String(length=255), table=<accounts_useridentity>, primary_key=True, nullable=False), Column('method', String(length=255), table=<accounts_useridentity>, primary_key=True, nullable=False), Column('id_user', Integer(), ForeignKey('accounts_user.id'), table=<accounts_useridentity>, nullable=False), Column('created', DateTime(), table=<accounts_useridentity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_useridentity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('accounts_useridentity_id_user_method', Column('id_user', Integer(), table=<accounts_useridentity>, nullable=False), Column('method', String(length=255), table=<accounts_useridentity>, primary_key=True, nullable=False), unique=True),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('accounts_userrole', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<accounts_userrole>), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=<accounts_userrole>), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('files_bucket', MetaData(), Column('id', UUIDType(), table=<files_bucket>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb662a0>)), Column('default_location', Integer(), ForeignKey('files_location.id'), table=<files_bucket>, nullable=False), Column('default_storage_class', String(length=1), table=<files_bucket>, nullable=False, default=CallableColumnDefault(<function Bucket.<lambda> at 0x7f40bcb679c0>)), Column('size', BigInteger(), table=<files_bucket>, nullable=False, default=ScalarElementColumnDefault(0)), Column('quota_size', BigInteger(), table=<files_bucket>, default=CallableColumnDefault(<function Bucket.<lambda> at 0x7f40bcb67b00>)), Column('max_file_size', BigInteger(), table=<files_bucket>, default=CallableColumnDefault(<function Bucket.<lambda> at 0x7f40bcb67c40>)), Column('locked', Boolean(name='locked'), table=<files_bucket>, nullable=False, default=ScalarElementColumnDefault(False)), Column('deleted', Boolean(name='deleted'), table=<files_bucket>, nullable=False, default=ScalarElementColumnDefault(False)), Column('created', DateTime(), table=<files_bucket>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_bucket>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('pidstore_redirect', MetaData(), Column('id', UUIDType(), table=<pidstore_redirect>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40ba7d6f20>)), Column('pid_id', Integer(), ForeignKey('pidstore_pid.id'), table=<pidstore_redirect>, nullable=False), Column('created', DateTime(), table=<pidstore_redirect>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<pidstore_redirect>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('transaction', MetaData(), Column('id', BigInteger(), table=<transaction>, primary_key=True, nullable=False, default=Sequence('transaction_id_seq', metadata=MetaData())), Column('remote_addr', String(length=50), table=<transaction>), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<transaction>), Column('issued_at', DateTime(), table=<transaction>, default=CallableColumnDefault(<function utc_now at 0x7f40bacf2f20>)), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_transaction_user_id', Column('user_id', Integer(), table=<transaction>)),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('files_buckettags', MetaData(), Column('bucket_id', UUIDType(), ForeignKey('files_bucket.id'), table=<files_buckettags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb9dd00>)), Column('key', String(length=255), table=<files_buckettags>, primary_key=True, nullable=False), Column('value', Text(), table=<files_buckettags>, nullable=False), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_files_buckettags_bucket_id', Column('bucket_id', UUIDType(), table=<files_buckettags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb9dd00>))),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('files_multipartobject', MetaData(), Column('upload_id', UUIDType(), table=<files_multipartobject>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbe13a0>)), Column('bucket_id', UUIDType(), ForeignKey('files_bucket.id'), table=<files_multipartobject>), Column('key', Text(), table=<files_multipartobject>), Column('file_id', UUIDType(), ForeignKey('files_files.id'), table=<files_multipartobject>, nullable=False), Column('chunk_size', Integer(), table=<files_multipartobject>), Column('size', BigInteger(), table=<files_multipartobject>), Column('completed', Boolean(name='completed'), table=<files_multipartobject>, nullable=False, default=ScalarElementColumnDefault(False)), Column('created', DateTime(), table=<files_multipartobject>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_multipartobject>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_files_multipartobject_bucket_id', Column('bucket_id', UUIDType(), table=<files_multipartobject>)),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('files_object', MetaData(), Column('version_id', UUIDType(), table=<files_object>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbb84a0>)), Column('key', Text(), table=<files_object>, nullable=False), Column('bucket_id', UUIDType(), ForeignKey('files_bucket.id'), table=<files_object>, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbb9120>)), Column('file_id', UUIDType(), ForeignKey('files_files.id'), table=<files_object>), Column('_mimetype', String(length=255), table=<files_object>), Column('is_head', Boolean(name='is_head'), table=<files_object>, nullable=False, default=ScalarElementColumnDefault(True)), Column('created', DateTime(), table=<files_object>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_object>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_files_object__mimetype', Column('_mimetype', String(length=255), table=<files_object>)),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_files_object_bucket_id', Column('bucket_id', UUIDType(), table=<files_object>, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbb9120>))),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('files_multipartobject_part', MetaData(), Column('upload_id', UUIDType(), ForeignKey('files_multipartobject.upload_id'), table=<files_multipartobject_part>, primary_key=True, nullable=False), Column('part_number', Integer(), table=<files_multipartobject_part>, primary_key=True, nullable=False), Column('checksum', String(length=255), table=<files_multipartobject_part>), Column('created', DateTime(), table=<files_multipartobject_part>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_multipartobject_part>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
E         +     ),
E         +     (
E         +         'add_table',
E         +         Table('files_objecttags', MetaData(), Column('version_id', UUIDType(), ForeignKey('files_object.version_id'), table=<files_objecttags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbe0180>)), Column('key', String(length=255), table=<files_objecttags>, primary_key=True, nullable=False), Column('value', Text(), table=<files_objecttags>, nullable=False), schema=None),
E         +     ),
E         +     (
E         +         'add_index',
E         +         Index('ix_files_objecttags_version_id', Column('version_id', UUIDType(), table=<files_objecttags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbe0180>))),
E         +     ),
E         + ]

tests/test_alembic.py:35: AssertionError
---------------------------- Captured stderr setup -----------------------------
JSONSCHEMAS_HOST is set to localhost
[2025-11-17 07:45:12,733] WARNING in ext: JSONSCHEMAS_HOST is set to localhost
JSONSCHEMAS_HOST is set to localhost
JSONSCHEMAS_HOST is set to localhost
------------------------------ Captured log setup ------------------------------
WARNING  invenio:ext.py:291 JSONSCHEMAS_HOST is set to localhost
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

.venv/lib/python3.12/site-packages/jsonresolver/contrib/jsonschema.py:31
.venv/lib/python3.12/site-packages/jsonresolver/contrib/jsonschema.py:31
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/jsonresolver/contrib/jsonschema.py:31: DeprecationWarning: jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
    from jsonschema import RefResolver as _RefResolver

.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14: DeprecationWarning: jsonschema.exceptions.RefResolutionError is deprecated as of version 4.18.0. If you wish to catch potential reference resolution errors, directly catch referencing.exceptions.Unresolvable.
    from jsonschema import RefResolutionError, RefResolver

.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14: DeprecationWarning: jsonschema.RefResolver is deprecated as of v4.18.0, in favor of the https://github.com/python-jsonschema/referencing library, which provides more compliant referencing behavior as well as more flexible APIs for customization. A future release will remove RefResolver. Please file a feature request (on referencing) if you are missing an API for the kind of customization you need.
    from jsonschema import RefResolutionError, RefResolver

.venv/lib/python3.12/site-packages/fs/__init__.py:4
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/fs/__init__.py:4: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

.venv/lib/python3.12/site-packages/pkg_resources/__init__.py:3146
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/pkg_resources/__init__.py:3146: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('sphinxcontrib')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

.venv/lib/python3.12/site-packages/fs/__init__.py:4
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/fs/__init__.py:4: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

.venv/lib/python3.12/site-packages/fs/opener/__init__.py:6
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/fs/opener/__init__.py:6: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs.opener')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

.venv/lib/python3.12/site-packages/pkg_resources/__init__.py:2558
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/pkg_resources/__init__.py:2558: DeprecationWarning: Deprecated call to `pkg_resources.declare_namespace('fs')`.
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

.venv/lib/python3.12/site-packages/marshmallow_utils/fields/generated.py:12
.venv/lib/python3.12/site-packages/marshmallow_utils/fields/generated.py:12
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/marshmallow_utils/fields/generated.py:12: DeprecationWarning: The '__version_info__' attribute is deprecated and will be removed in in a future version. Use feature detection or 'packaging.Version(importlib.metadata.version("marshmallow")).release' instead.
    from marshmallow import __version_info__ as marshmallow_version

.venv/lib/python3.12/site-packages/invenio_records_resources/services/files/schema.py:154
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/files/schema.py:154: RemovedInMarshmallow4Warning: The 'default' argument to fields is deprecated. Use 'dump_default' instead.
    storage_class = Str(default="L", dump_only=False)

.venv/lib/python3.12/site-packages/invenio_records_resources/services/base/links.py:140
.venv/lib/python3.12/site-packages/invenio_records_resources/services/base/links.py:140
.venv/lib/python3.12/site-packages/invenio_records_resources/services/base/links.py:140
.venv/lib/python3.12/site-packages/invenio_records_resources/services/base/links.py:140
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/base/links.py:140: DeprecationWarning: Link is deprecated and will be removed in v14.0. Use `ExternalLink` for third-party links and `EndpointLink` for InvenioRDM links.
    warnings.warn(

tests/services/test_service.py::test_audit_log_create
tests/test_alembic.py::test_alembic
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_rest/ext.py:29: FutureWarning: CSRF validation will be enabled by default in the version 1.3.x
    self.init_app(app)

tests/services/test_service.py::test_audit_log_create
tests/test_alembic.py::test_alembic
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_caching/__init__.py:145: DeprecationWarning: Using the initialization functions in flask_caching.backend is deprecated.  Use the a full path to backend classes directly.
    self._set_cache(app, config)

tests/services/test_service.py::test_audit_log_create
tests/services/test_service.py::test_audit_log_create_identity_mismatch
tests/services/test_service.py::test_audit_log_create_identity_mismatch
tests/services/test_service.py::test_audit_log_create_system_identity
tests/services/test_service.py::test_audit_log_create_system_identity
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/sqlalchemy/sql/schema.py:3624: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    return util.wrap_callable(lambda ctx: fn(), fn)  # type: ignore

tests/services/test_service.py::test_audit_log_create
tests/services/test_service.py::test_audit_log_create_identity_mismatch
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_security/utils.py:77: DeprecationWarning: Remember me support has been removed.
    warnings.warn("Remember me support has been removed.", DeprecationWarning)

tests/services/test_service.py::test_audit_log_create
tests/services/test_service.py::test_audit_log_create_identity_mismatch
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_security/utils.py:87: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    _security.datetime_factory(),

tests/services/test_service.py::test_audit_log_create
tests/services/test_service.py::test_audit_log_create_identity_mismatch
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/sqlalchemy_utils/models.py:33: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    target.updated = datetime.utcnow()

tests/services/test_service.py::test_audit_log_create
tests/services/test_service.py::test_audit_log_create_identity_mismatch
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/flask_kvsession/__init__.py:39: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    created = datetime.utcnow()

tests/services/test_service.py::test_audit_log_create
tests/services/test_service.py::test_audit_log_create_system_identity
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/invenio_audit_logs/services/service.py:38: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    data["created"] = datetime.utcnow().isoformat()

tests/services/test_service.py::test_audit_log_create
tests/services/test_service.py::test_audit_log_create_system_identity
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/schema.py:90: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    valid_data = self.schema(context=context, **schema_args).load(data)

tests/services/test_service.py::test_audit_log_create
tests/services/test_service.py::test_audit_log_create_system_identity
tests/services/test_service.py::test_audit_log_create_system_identity
tests/services/test_service.py::test_audit_log_create_system_identity
tests/services/test_service.py::test_audit_log_create_system_identity
tests/services/test_service.py::test_audit_log_create_system_identity
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/marshmallow/fields.py:631: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    self._schema = schema_class(

tests/services/test_service.py::test_audit_log_create
tests/services/test_service.py::test_audit_log_create_system_identity
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records/models.py:44: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    target.updated = datetime.utcnow()

tests/services/test_service.py::test_audit_log_create
tests/services/test_service.py::test_audit_log_create_system_identity
  /home/runner/work/invenio-bug-verification/invenio-bug-verification/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/schema.py:105: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    return self.schema(context=context, **schema_args).dump(data)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.12-final-0 _______________

Name                                                                Stmts   Miss  Cover   Missing
-------------------------------------------------------------------------------------------------
invenio_audit_logs/__init__.py                                          3      0   100%
invenio_audit_logs/alembic/1743073617_create_audit_logs_branch.py      10      2    80%   22, 27
invenio_audit_logs/alembic/1743073720_create_audit_logs_table.py       12      2    83%   24, 57
invenio_audit_logs/config.py                                           11      0   100%
invenio_audit_logs/ext.py                                              28      0   100%
invenio_audit_logs/proxies.py                                           8      0   100%
invenio_audit_logs/records/__init__.py                                  2      0   100%
invenio_audit_logs/records/api.py                                      21      0   100%
invenio_audit_logs/records/mappings/__init__.py                         0      0   100%
invenio_audit_logs/records/mappings/templates/__init__.py               0      0   100%
invenio_audit_logs/records/mappings/templates/os-v1/__init__.py         0      0   100%
invenio_audit_logs/records/mappings/templates/os-v2/__init__.py         0      0   100%
invenio_audit_logs/records/models.py                                    9      0   100%
invenio_audit_logs/records/systemfields/__init__.py                     2      0   100%
invenio_audit_logs/records/systemfields/action.py                      45     11    76%   26, 36-38, 42-44, 50, 54, 79-80
invenio_audit_logs/resources/__init__.py                                3      0   100%
invenio_audit_logs/resources/config.py                                 16      0   100%
invenio_audit_logs/resources/resource.py                               26      4    85%   52-57, 64-68
invenio_audit_logs/services/__init__.py                                 6      0   100%
invenio_audit_logs/services/action.py                                  22      6    73%   28, 41-42, 46, 51, 55
invenio_audit_logs/services/config.py                                  40      0   100%
invenio_audit_logs/services/permissions.py                              9      0   100%
invenio_audit_logs/services/results.py                                 51     19    63%   68-70, 77-80, 85-96, 100-115
invenio_audit_logs/services/schema.py                                  48      5    90%   105, 115, 188-191
invenio_audit_logs/services/service.py                                 20      1    95%   33
invenio_audit_logs/services/uow.py                                     15      0   100%
invenio_audit_logs/views.py                                             5      0   100%
-------------------------------------------------------------------------------------------------
TOTAL                                                                 412     50    88%
=========================== short test summary info ============================
FAILED tests/test_alembic.py::test_alembic - AssertionError: assert [('add_table'...a=None)), ...] == []
  
  Left contains 49 more items, first extra item: ('add_table', Table('access_actionssystemroles', MetaData(), Column('role_name', String(length=40), table=<access_acti...lause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionssystemroles>), schema=None))
  
  Full diff:
  - []
  + [
  +     (
  +         'add_table',
  +         Table('access_actionssystemroles', MetaData(), Column('role_name', String(length=40), table=<access_actionssystemroles>, nullable=False), Column('id', Integer(), table=<access_actionssystemroles>, primary_key=True, nullable=False), Column('action', String(length=80), table=<access_actionssystemroles>), Column('exclude', Boolean(name='exclude'), table=<access_actionssystemroles>, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionssystemroles>), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_access_actionssystemroles_action', Column('action', String(length=80), table=<access_actionssystemroles>)),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_access_actionssystemroles_argument', Column('argument', String(length=255), table=<access_actionssystemroles>)),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_access_actionssystemroles_role_name', Column('role_name', String(length=40), table=<access_actionssystemroles>, nullable=False)),
  +     ),
  +     (
  +         'add_table',
  +         Table('accounts_domain_category', MetaData(), Column('id', Integer(), table=<accounts_domain_category>, primary_key=True, nullable=False), Column('label', String(length=255), table=<accounts_domain_category>), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('accounts_domain_org', MetaData(), Column('id', Integer(), table=<accounts_domain_org>, primary_key=True, nullable=False), Column('pid', String(length=255), table=<accounts_domain_org>), Column('name', String(length=255), table=<accounts_domain_org>, nullable=False), Column('json', JSON(), table=<accounts_domain_org>, nullable=False, default=CallableColumnDefault(<function DomainOrg.<lambda> at 0x7f40bb761580>)), Column('parent_id', Integer(), ForeignKey('accounts_domain_org.id'), table=<accounts_domain_org>), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('accounts_role', MetaData(), Column('id', String(length=80), table=<accounts_role>, primary_key=True, nullable=False, default=CallableColumnDefault(<function Role.<lambda> at 0x7f40bbbee020>)), Column('name', String(length=80), table=<accounts_role>), Column('description', String(length=255), table=<accounts_role>), Column('is_managed', Boolean(), table=<accounts_role>, nullable=False, default=ScalarElementColumnDefault(True)), Column('version_id', Integer(), table=<accounts_role>, nullable=False), Column('created', DateTime(), table=<accounts_role>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_role>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('accounts_user', MetaData(), Column('id', Integer(), table=<accounts_user>, primary_key=True, nullable=False), Column('username', String(length=255), table=<accounts_user>), Column('displayname', String(length=255), table=<accounts_user>), Column('email', String(length=255), table=<accounts_user>), Column('domain', String(length=255), table=<accounts_user>), Column('password', String(length=255), table=<accounts_user>), Column('active', Boolean(name='active'), table=<accounts_user>), Column('confirmed_at', DateTime(), table=<accounts_user>), Column('version_id', Integer(), table=<accounts_user>, nullable=False), Column('profile', JSON(), table=<accounts_user>, default=CallableColumnDefault(<function User.<lambda> at 0x7f40bbbef380>)), Column('preferences', JSON(), table=<accounts_user>, default=CallableColumnDefault(<function User.<lambda> at 0x7f40bbbef4c0>)), Column('blocked_at', DateTime(), table=<accounts_user>), Column('verified_at', DateTime(), table=<accounts_user>), Column('created', DateTime(), table=<accounts_user>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_user>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('audit_logs_metadata', MetaData(), Column('action', String(length=255), table=<audit_logs_metadata>, nullable=False), Column('resource_type', String(length=255), table=<audit_logs_metadata>, nullable=False), Column('user_id', String(length=255), table=<audit_logs_metadata>, nullable=False), Column('id', UUIDType(), table=<audit_logs_metadata>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bab40e00>)), Column('json', JSON(), table=<audit_logs_metadata>, default=CallableColumnDefault(<function RecordMetadataBase.<lambda> at 0x7f40bab40f40>)), Column('version_id', Integer(), table=<audit_logs_metadata>, nullable=False), Column('created', DateTime(), table=<audit_logs_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd4e0>)), Column('updated', DateTime(), table=<audit_logs_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd9e0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('files_files', MetaData(), Column('id', UUIDType(), table=<files_files>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb9ede0>)), Column('uri', Text(), table=<files_files>), Column('storage_class', String(length=1), table=<files_files>), Column('size', BigInteger(), table=<files_files>, default=ScalarElementColumnDefault(0)), Column('checksum', String(length=255), table=<files_files>), Column('readable', Boolean(name='readable'), table=<files_files>, nullable=False, default=ScalarElementColumnDefault(True)), Column('writable', Boolean(name='writable'), table=<files_files>, nullable=False, default=ScalarElementColumnDefault(True)), Column('last_check_at', DateTime(), table=<files_files>), Column('last_check', Boolean(name='last_check'), table=<files_files>, default=ScalarElementColumnDefault(True)), Column('created', DateTime(), table=<files_files>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_files>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('files_location', MetaData(), Column('id', Integer(), table=<files_location>, primary_key=True, nullable=False), Column('name', String(length=20), table=<files_location>, nullable=False), Column('uri', String(length=255), table=<files_location>, nullable=False), Column('default', Boolean(name='default'), table=<files_location>, nullable=False, default=ScalarElementColumnDefault(False)), Column('created', DateTime(), table=<files_location>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_location>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('pidstore_pid', MetaData(), Column('id', Integer(), table=<pidstore_pid>, primary_key=True, nullable=False), Column('pid_type', String(length=6), table=<pidstore_pid>, nullable=False), Column('pid_value', String(length=255), table=<pidstore_pid>, nullable=False), Column('pid_provider', String(length=8), table=<pidstore_pid>), Column('status', ChoiceType(length=1), table=<pidstore_pid>, nullable=False), Column('object_type', String(length=3), table=<pidstore_pid>), Column('object_uuid', UUIDType(), table=<pidstore_pid>), Column('created', DateTime(), table=<pidstore_pid>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<pidstore_pid>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('idx_object', Column('object_type', String(length=3), table=<pidstore_pid>), Column('object_uuid', UUIDType(), table=<pidstore_pid>)),
  +     ),
  +     (
  +         'add_index',
  +         Index('idx_status', Column('status', ChoiceType(length=1), table=<pidstore_pid>, nullable=False)),
  +     ),
  +     (
  +         'add_index',
  +         Index('uidx_type_pid', Column('pid_type', String(length=6), table=<pidstore_pid>, nullable=False), Column('pid_value', String(length=255), table=<pidstore_pid>, nullable=False), unique=True),
  +     ),
  +     (
  +         'add_table',
  +         Table('pidstore_recid', MetaData(), Column('recid', BigInteger(), table=<pidstore_recid>, primary_key=True, nullable=False), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('records_metadata', MetaData(), Column('id', UUIDType(), table=<records_metadata>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bab40e00>)), Column('json', JSON(), table=<records_metadata>, default=CallableColumnDefault(<function RecordMetadataBase.<lambda> at 0x7f40bab40f40>)), Column('version_id', Integer(), table=<records_metadata>, nullable=False), Column('created', DateTime(), table=<records_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd4e0>)), Column('updated', DateTime(), table=<records_metadata>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd9e0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('records_metadata_version', MetaData(), Column('id', UUIDType(), table=<records_metadata_version>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bab40e00>)), Column('json', JSON(), table=<records_metadata_version>, default=CallableColumnDefault(<function RecordMetadataBase.<lambda> at 0x7f40bab40f40>)), Column('version_id', Integer(), table=<records_metadata_version>), Column('created', DateTime(), table=<records_metadata_version>, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd4e0>)), Column('updated', DateTime(), table=<records_metadata_version>, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bacfd9e0>)), Column('transaction_id', BigInteger(), table=<records_metadata_version>, primary_key=True, nullable=False), Column('end_transaction_id', BigInteger(), table=<records_metadata_version>), Column('operation_type', SmallInteger(), table=<records_metadata_version>, nullable=False), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_records_metadata_version_end_transaction_id', Column('end_transaction_id', BigInteger(), table=<records_metadata_version>)),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_records_metadata_version_operation_type', Column('operation_type', SmallInteger(), table=<records_metadata_version>, nullable=False)),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_records_metadata_version_transaction_id', Column('transaction_id', BigInteger(), table=<records_metadata_version>, primary_key=True, nullable=False)),
  +     ),
  +     (
  +         'add_table',
  +         Table('access_actionsroles', MetaData(), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=<access_actionsroles>, nullable=False), Column('id', Integer(), table=<access_actionsroles>, primary_key=True, nullable=False), Column('action', String(length=80), table=<access_actionsroles>), Column('exclude', Boolean(name='exclude'), table=<access_actionsroles>, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionsroles>), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_access_actionsroles_action', Column('action', String(length=80), table=<access_actionsroles>)),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_access_actionsroles_argument', Column('argument', String(length=255), table=<access_actionsroles>)),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_access_actionsroles_role_id', Column('role_id', String(length=80), table=<access_actionsroles>, nullable=False)),
  +     ),
  +     (
  +         'add_table',
  +         Table('access_actionsusers', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<access_actionsusers>, nullable=False), Column('id', Integer(), table=<access_actionsusers>, primary_key=True, nullable=False), Column('action', String(length=80), table=<access_actionsusers>), Column('exclude', Boolean(name='exclude'), table=<access_actionsusers>, nullable=False, default=ScalarElementColumnDefault(False), server_default=DefaultClause('0', for_update=False)), Column('argument', String(length=255), table=<access_actionsusers>), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_access_actionsusers_action', Column('action', String(length=80), table=<access_actionsusers>)),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_access_actionsusers_argument', Column('argument', String(length=255), table=<access_actionsusers>)),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_access_actionsusers_user_id', Column('user_id', Integer(), table=<access_actionsusers>, nullable=False)),
  +     ),
  +     (
  +         'add_table',
  +         Table('accounts_domains', MetaData(), Column('id', Integer(), table=<accounts_domains>, primary_key=True, nullable=False), Column('domain', String(length=255), table=<accounts_domains>, nullable=False), Column('tld', String(length=255), table=<accounts_domains>, nullable=False), Column('status', ChoiceType(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(<DomainStatus.new: 1>)), Column('flagged', Boolean(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(False)), Column('flagged_source', String(length=255), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault('')), Column('org_id', Integer(), ForeignKey('accounts_domain_org.id'), table=<accounts_domains>), Column('category', Integer(), ForeignKey('accounts_domain_category.id'), table=<accounts_domains>), Column('num_users', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_active', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_inactive', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_confirmed', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_verified', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('num_blocked', Integer(), table=<accounts_domains>, nullable=False, default=ScalarElementColumnDefault(0)), Column('created', DateTime(), table=<accounts_domains>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_domains>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('accounts_user_login_information', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<accounts_user_login_information>, primary_key=True, nullable=False), Column('last_login_at', DateTime(), table=<accounts_user_login_information>), Column('current_login_at', DateTime(), table=<accounts_user_login_information>), Column('last_login_ip', IPAddressType(length=50), table=<accounts_user_login_information>), Column('current_login_ip', IPAddressType(length=50), table=<accounts_user_login_information>), Column('login_count', Integer(), table=<accounts_user_login_information>), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('accounts_user_session_activity', MetaData(), Column('sid_s', String(length=255), table=<accounts_user_session_activity>, primary_key=True, nullable=False), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<accounts_user_session_activity>), Column('ip', String(length=80), table=<accounts_user_session_activity>), Column('country', String(length=3), table=<accounts_user_session_activity>), Column('browser', String(length=80), table=<accounts_user_session_activity>), Column('browser_version', String(length=30), table=<accounts_user_session_activity>), Column('os', String(length=80), table=<accounts_user_session_activity>), Column('device', String(length=80), table=<accounts_user_session_activity>), Column('created', DateTime(), table=<accounts_user_session_activity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_user_session_activity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('accounts_useridentity', MetaData(), Column('id', String(length=255), table=<accounts_useridentity>, primary_key=True, nullable=False), Column('method', String(length=255), table=<accounts_useridentity>, primary_key=True, nullable=False), Column('id_user', Integer(), ForeignKey('accounts_user.id'), table=<accounts_useridentity>, nullable=False), Column('created', DateTime(), table=<accounts_useridentity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<accounts_useridentity>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('accounts_useridentity_id_user_method', Column('id_user', Integer(), table=<accounts_useridentity>, nullable=False), Column('method', String(length=255), table=<accounts_useridentity>, primary_key=True, nullable=False), unique=True),
  +     ),
  +     (
  +         'add_table',
  +         Table('accounts_userrole', MetaData(), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<accounts_userrole>), Column('role_id', String(length=80), ForeignKey('accounts_role.id'), table=<accounts_userrole>), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('files_bucket', MetaData(), Column('id', UUIDType(), table=<files_bucket>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb662a0>)), Column('default_location', Integer(), ForeignKey('files_location.id'), table=<files_bucket>, nullable=False), Column('default_storage_class', String(length=1), table=<files_bucket>, nullable=False, default=CallableColumnDefault(<function Bucket.<lambda> at 0x7f40bcb679c0>)), Column('size', BigInteger(), table=<files_bucket>, nullable=False, default=ScalarElementColumnDefault(0)), Column('quota_size', BigInteger(), table=<files_bucket>, default=CallableColumnDefault(<function Bucket.<lambda> at 0x7f40bcb67b00>)), Column('max_file_size', BigInteger(), table=<files_bucket>, default=CallableColumnDefault(<function Bucket.<lambda> at 0x7f40bcb67c40>)), Column('locked', Boolean(name='locked'), table=<files_bucket>, nullable=False, default=ScalarElementColumnDefault(False)), Column('deleted', Boolean(name='deleted'), table=<files_bucket>, nullable=False, default=ScalarElementColumnDefault(False)), Column('created', DateTime(), table=<files_bucket>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_bucket>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('pidstore_redirect', MetaData(), Column('id', UUIDType(), table=<pidstore_redirect>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40ba7d6f20>)), Column('pid_id', Integer(), ForeignKey('pidstore_pid.id'), table=<pidstore_redirect>, nullable=False), Column('created', DateTime(), table=<pidstore_redirect>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754860>)), Column('updated', DateTime(), table=<pidstore_redirect>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40be754ea0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('transaction', MetaData(), Column('id', BigInteger(), table=<transaction>, primary_key=True, nullable=False, default=Sequence('transaction_id_seq', metadata=MetaData())), Column('remote_addr', String(length=50), table=<transaction>), Column('user_id', Integer(), ForeignKey('accounts_user.id'), table=<transaction>), Column('issued_at', DateTime(), table=<transaction>, default=CallableColumnDefault(<function utc_now at 0x7f40bacf2f20>)), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_transaction_user_id', Column('user_id', Integer(), table=<transaction>)),
  +     ),
  +     (
  +         'add_table',
  +         Table('files_buckettags', MetaData(), Column('bucket_id', UUIDType(), ForeignKey('files_bucket.id'), table=<files_buckettags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb9dd00>)), Column('key', String(length=255), table=<files_buckettags>, primary_key=True, nullable=False), Column('value', Text(), table=<files_buckettags>, nullable=False), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_files_buckettags_bucket_id', Column('bucket_id', UUIDType(), table=<files_buckettags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcb9dd00>))),
  +     ),
  +     (
  +         'add_table',
  +         Table('files_multipartobject', MetaData(), Column('upload_id', UUIDType(), table=<files_multipartobject>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbe13a0>)), Column('bucket_id', UUIDType(), ForeignKey('files_bucket.id'), table=<files_multipartobject>), Column('key', Text(), table=<files_multipartobject>), Column('file_id', UUIDType(), ForeignKey('files_files.id'), table=<files_multipartobject>, nullable=False), Column('chunk_size', Integer(), table=<files_multipartobject>), Column('size', BigInteger(), table=<files_multipartobject>), Column('completed', Boolean(name='completed'), table=<files_multipartobject>, nullable=False, default=ScalarElementColumnDefault(False)), Column('created', DateTime(), table=<files_multipartobject>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_multipartobject>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_files_multipartobject_bucket_id', Column('bucket_id', UUIDType(), table=<files_multipartobject>)),
  +     ),
  +     (
  +         'add_table',
  +         Table('files_object', MetaData(), Column('version_id', UUIDType(), table=<files_object>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbb84a0>)), Column('key', Text(), table=<files_object>, nullable=False), Column('bucket_id', UUIDType(), ForeignKey('files_bucket.id'), table=<files_object>, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbb9120>)), Column('file_id', UUIDType(), ForeignKey('files_files.id'), table=<files_object>), Column('_mimetype', String(length=255), table=<files_object>), Column('is_head', Boolean(name='is_head'), table=<files_object>, nullable=False, default=ScalarElementColumnDefault(True)), Column('created', DateTime(), table=<files_object>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_object>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_files_object__mimetype', Column('_mimetype', String(length=255), table=<files_object>)),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_files_object_bucket_id', Column('bucket_id', UUIDType(), table=<files_object>, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbb9120>))),
  +     ),
  +     (
  +         'add_table',
  +         Table('files_multipartobject_part', MetaData(), Column('upload_id', UUIDType(), ForeignKey('files_multipartobject.upload_id'), table=<files_multipartobject_part>, primary_key=True, nullable=False), Column('part_number', Integer(), table=<files_multipartobject_part>, primary_key=True, nullable=False), Column('checksum', String(length=255), table=<files_multipartobject_part>), Column('created', DateTime(), table=<files_multipartobject_part>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64c20>)), Column('updated', DateTime(), table=<files_multipartobject_part>, nullable=False, default=CallableColumnDefault(<function datetime.utcnow at 0x7f40bcb64cc0>)), schema=None),
  +     ),
  +     (
  +         'add_table',
  +         Table('files_objecttags', MetaData(), Column('version_id', UUIDType(), ForeignKey('files_object.version_id'), table=<files_objecttags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbe0180>)), Column('key', String(length=255), table=<files_objecttags>, primary_key=True, nullable=False), Column('value', Text(), table=<files_objecttags>, nullable=False), schema=None),
  +     ),
  +     (
  +         'add_index',
  +         Index('ix_files_objecttags_version_id', Column('version_id', UUIDType(), table=<files_objecttags>, primary_key=True, nullable=False, default=CallableColumnDefault(<function uuid4 at 0x7f40bcbe0180>))),
  +     ),
  + ]
================= 1 failed, 113 passed, 50 warnings in 16.87s ==================
 Container docker_services_cli-opensearch-1  Stopping
 Container docker_services_cli-redis-1  Stopping
 Container docker_services_cli-postgresql-1  Stopping
 Container docker_services_cli-rabbitmq-1  Stopping
 Container docker_services_cli-postgresql-1  Stopped
 Container docker_services_cli-postgresql-1  Removing
 Container docker_services_cli-redis-1  Stopped
 Container docker_services_cli-redis-1  Removing
 Container docker_services_cli-postgresql-1  Removed
 Container docker_services_cli-redis-1  Removed
 Container docker_services_cli-opensearch-1  Stopped
 Container docker_services_cli-opensearch-1  Removing
 Container docker_services_cli-opensearch-1  Removed
 Container docker_services_cli-rabbitmq-1  Stopped
 Container docker_services_cli-rabbitmq-1  Removing
 Container docker_services_cli-rabbitmq-1  Removed
 Network docker_services_cli_default  Removing
 Network docker_services_cli_default  Removed
