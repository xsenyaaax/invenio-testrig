 Network docker_services_cli_default  Creating
 Network docker_services_cli_default  Created
 Container docker_services_cli-redis-1  Creating
 Container docker_services_cli-rabbitmq-1  Creating
 Container docker_services_cli-postgresql-1  Creating
 Container docker_services_cli-opensearch-1  Creating
 Container docker_services_cli-rabbitmq-1  Created
 Container docker_services_cli-postgresql-1  Created
 Container docker_services_cli-redis-1  Created
 Container docker_services_cli-opensearch-1  Created
 Container docker_services_cli-opensearch-1  Starting
 Container docker_services_cli-rabbitmq-1  Starting
 Container docker_services_cli-redis-1  Starting
 Container docker_services_cli-postgresql-1  Starting
 Container docker_services_cli-redis-1  Started
 Container docker_services_cli-postgresql-1  Started
 Container docker_services_cli-rabbitmq-1  Started
 Container docker_services_cli-opensearch-1  Started
============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-8.4.2, pluggy-1.6.0
rootdir: /home/runner/work/invenio-testrig/invenio-testrig/package-repo
configfile: setup.cfg
testpaths: docs, tests, invenio_rdm_records
plugins: github-actions-annotate-failures-0.3.0, pycodestyle-2.5.0, flask-1.3.0, black-ng-0.4.1, Faker-38.2.0, invenio-3.4.2, isort-4.0.0, cov-7.0.0, mock-3.15.1, pydocstyle-2.4.0
collected 2069 items

docs/conf.py ...                                                         [  0%]
tests/__init__.py ...                                                    [  0%]
tests/conftest.py ...                                                    [  0%]
tests/contrib/__init__.py ...                                            [  0%]
tests/contrib/codemeta/__init__.py ...                                   [  0%]
tests/contrib/codemeta/conftest.py ...                                   [  0%]
tests/contrib/codemeta/test_codemeta_custom_fields.py ...
.
.
.
.
.
           [  1%]
tests/fake_datacite_client.py ...                                        [  1%]
tests/fixtures/__init__.py ...                                           [  1%]
tests/fixtures/conftest.py ...                                           [  1%]
tests/fixtures/load_error/__init__.py ...                                [  1%]
tests/fixtures/load_error/conflicting_module_A/__init__.py ...           [  1%]
tests/fixtures/load_error/conflicting_module_A/fixtures/vocabularies/__init__.py . [  2%]
..                                                                       [  2%]
tests/fixtures/load_error/conflicting_module_B/fixtures/vocabularies/__init__.py . [  2%]
..                                                                       [  2%]
tests/fixtures/load_error/conftest.py ...                                [  2%]
tests/fixtures/load_error/test_vocabularies_load_error.py ...
            [  2%]
tests/fixtures/mock_module_A/__init__.py ...                             [  2%]
tests/fixtures/mock_module_A/fixtures/vocabularies/__init__.py ...       [  2%]
tests/fixtures/mock_module_B/fixtures/vocabularies/__init__.py ...       [  2%]
tests/fixtures/test_cli.py ...
.
.
.
.                                       [  3%]
tests/fixtures/test_fixtures.py ...
.
.
.
.
.
.
.
.
                              [  3%]
tests/helpers.py ...                                                     [  4%]
tests/mock_module/__init__.py ...                                        [  4%]
tests/oaiserver/__init__.py ...                                          [  4%]
tests/oaiserver/test_oaipmh.py ...
.
.
                                     [  4%]
tests/records/__init__.py ...                                            [  4%]
tests/records/conftest.py ...                                            [  4%]
tests/records/dumpers/__init__.py ...                                    [  4%]
tests/records/dumpers/conftest.py ...                                    [  5%]
tests/records/dumpers/test_access_dumpers.py ...
s                        [  5%]
tests/records/dumpers/test_combined_subjects_dumper.py ...
               [  5%]
tests/records/dumpers/test_edtf_dumpers.py ...
.
.
.
.
.
.
.
.
                   [  5%]
tests/records/dumpers/test_files_dumpers.py ...
                          [  6%]
tests/records/dumpers/test_location_dumpers.py ...
.
.
.
s
                   [  6%]
tests/records/dumpers/test_pids_dumper.py ...
                            [  6%]
tests/records/systemfields/__init__.py ...                               [  6%]
tests/records/systemfields/conftest.py ...                               [  6%]
tests/records/systemfields/test_access_systemfield.py ........
.
.
....
.
.
.
. [  7%]
....
.
.
.
.
.
                                                                [  8%]
tests/records/systemfields/test_permission_flags.py ...
.
.
                [  8%]
tests/records/systemfields/test_tombstone.py ...
.
.
....
                   [  8%]
tests/records/test_api.py ...
                                            [  9%]
tests/records/test_jsonschema.py ...
.................................... [ 10%]
                                                                         [ 10%]
tests/records/test_quotas.py ...
.
                                        [ 11%]
tests/records/test_records_communities.py ...
                            [ 11%]
tests/records/test_relations_affiliations.py ...
.
.
.
.
.
.
.
.
                 [ 11%]
tests/records/test_relations_languages.py ...
.
.
.
                         [ 12%]
tests/records/test_relations_resource_types.py ...
.
.
                     [ 12%]
tests/records/test_relations_subjects.py ...
.
.
                           [ 12%]
tests/requests/__init__.py ...                                           [ 12%]
tests/requests/conftest.py ...                                           [ 12%]
tests/requests/test_record_deletion.py ...
.
.
.
                            [ 13%]
tests/requests/test_user_moderation_actions.py ...
.
.
                     [ 13%]
tests/resources/__init__.py ...                                          [ 13%]
tests/resources/conftest.py ...                                          [ 13%]
tests/resources/serializers/__init__.py ...                              [ 13%]
tests/resources/serializers/conftest.py ...                              [ 13%]
tests/resources/serializers/test_bibtex_serializer.py ...
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 14%]
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                                          [ 16%]
tests/resources/serializers/test_cff_serializer.py ...
                   [ 16%]
tests/resources/serializers/test_csl_serializer.py ...
.
.
.
                [ 16%]
tests/resources/serializers/test_datacite43_serializer.py ...
.
.
.
.
.
.
.
.
.
   [ 17%]
tests/resources/serializers/test_datacite45_serializer.py ...
.
.
.
.
.
.
.
.
.
   [ 17%]
tests/resources/serializers/test_datapackage_serializer.py ...
.
.
         [ 18%]
tests/resources/serializers/test_dcat_serializer.py ...
                  [ 18%]
tests/resources/serializers/test_dublincore_serializer.py ...
.
.
.
.
.
.
      [ 18%]
tests/resources/serializers/test_geojson_serializer.py ...
.
.
             [ 18%]
tests/resources/serializers/test_marcxml_serializer.py ...
.
              [ 19%]
tests/resources/serializers/test_schemaorg_serializer.py ...
.
.
           [ 19%]
tests/resources/serializers/test_signposting_serializer.py ...
.
.
.
.
       [ 19%]
tests/resources/serializers/test_ui_serializer.py ...
                    [ 19%]
tests/resources/test_access_requests.py ...
.
.
.
.
                          [ 20%]
tests/resources/test_draft_file_permissions.py ...
.
.
.
.
.
.
.
.
.
.
.
.
.
          [ 21%]
tests/resources/test_files.py ...
.
.
.
.
                                    [ 21%]
tests/resources/test_iiif_image_api.py ...
.
.
.
.
.
.
                         [ 21%]
tests/resources/test_iiif_presentation_api.py ...
.
.
.
.
                    [ 22%]
tests/resources/test_media_files.py ...
.
.
.
.
                              [ 22%]
tests/resources/test_publish_errors.py ...
.
s                             [ 22%]
tests/resources/test_record_file_permissions.py ...
.
.
.
.
.
.
.
               [ 23%]
tests/resources/test_request_deletion.py ...
.
.
.
.
                         [ 23%]
tests/resources/test_resources.py ...
.
.
.
.
.
.
.
.
.
.
.
.
ss.
.
.
.
.
.
.
.
.
             [ 24%]
tests/resources/test_resources_communities.py ...
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
. [ 26%]
.
.
.
.
                                                                     [ 26%]
tests/resources/test_resources_community_records.py ...
.
.
.
.
              [ 26%]
tests/resources/test_resources_oai.py ...
.
.
.
.
.
.
.
.
.
.
.
                     [ 27%]
tests/resources/test_resources_pids.py ...
.
.
.
.
.
                          [ 27%]
tests/resources/test_resources_record_communities.py ...
.
                [ 27%]
tests/resources/test_resources_review.py ...
.
.
.
.
.
.
.
.
.
                    [ 28%]
tests/resources/test_resources_search.py ...
                             [ 28%]
tests/resources/test_resources_user_access.py ...
.
.
.
.
.
.
.
                 [ 29%]
tests/resources/test_rocrate.py ...
.
                                     [ 29%]
tests/resources/test_serialized_links.py ...
.
.
.
                          [ 29%]
tests/resources/test_signposting.py ...
.
.
                                [ 29%]
tests/resources/vocabularies/__init__.py ...                             [ 29%]
tests/resources/vocabularies/conftest.py ...                             [ 30%]
tests/resources/vocabularies/test_affiliations_vocabulary.py ...
.
        [ 30%]
tests/resources/vocabularies/test_awards_vocabulary.py ...
.
              [ 30%]
tests/resources/vocabularies/test_funders_vocabulary.py ...
.
             [ 30%]
tests/resources/vocabularies/test_names_vocabulary.py ...
.
               [ 30%]
tests/resources/vocabularies/test_subjects_vocabulary.py ..s.
            [ 31%]
tests/secret_links/__init__.py ...                                       [ 31%]
tests/secret_links/conftest.py ...                                       [ 31%]
tests/secret_links/test_secret_links.py ...
.
.
.
.
..
.
.
                      [ 31%]
tests/secret_links/test_sharing.py ...
.
.
                                 [ 32%]
tests/secret_links/test_token_serializers.py ...
...
.
                     [ 32%]
tests/services/__init__.py ...                                           [ 32%]
tests/services/components/__init__.py ...                                [ 32%]
tests/services/components/conftest.py ...                                [ 32%]
tests/services/components/test_access_component.py ...
ssss.
              [ 33%]
tests/services/components/test_internal_notes_component.py ...
           [ 33%]
tests/services/components/test_metadata_component.py ...
                 [ 33%]
tests/services/components/test_pids_component.py ...
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
   [ 34%]
tests/services/components/test_relations_component.py ...
                [ 34%]
tests/services/components/test_signal_component.py ...
                   [ 34%]
tests/services/components/test_verified_component.py ...
.
                [ 35%]
tests/services/conftest.py ...                                           [ 35%]
tests/services/files/__init__.py ...                                     [ 35%]
tests/services/files/conftest.py ...                                     [ 35%]
tests/services/files/test_deleted_record_files.py ...
                    [ 35%]
tests/services/files/test_metadata_files.py ...
s                         [ 35%]
tests/services/files/test_revert_of_deleted_files_in_published_record.py . [ 35%]
..
                                                                       [ 35%]
tests/services/pids/__init__.py ...                                      [ 36%]
tests/services/pids/providers/__init__.py ...                            [ 36%]
tests/services/pids/providers/conftest.py ...                            [ 36%]
tests/services/pids/providers/test_datacite_pid_provider.py ...
.
.
.
.
.
.
.
.
. [ 36%]
.                                                                        [ 37%]
tests/services/pids/providers/test_external_pid_provider.py ...
.
.
.
.
      [ 37%]
tests/services/pids/providers/test_oai_invenio_pid_provider.py ...
.
.
     [ 37%]
tests/services/pids/test_pids_service.py ...
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
  [ 39%]
tests/services/pids/test_pids_tasks.py ...
.
.
.
.
.
.
                         [ 39%]
tests/services/schemas/__init__.py ...                                   [ 39%]
tests/services/schemas/conftest.py ...                                   [ 39%]
tests/services/schemas/test_access.py ...........                        [ 40%]
tests/services/schemas/test_additional_description.py ........s          [ 40%]
tests/services/schemas/test_additional_title.py ........ss               [ 41%]
tests/services/schemas/test_creator_contributor.py ...
.................. [ 42%]
.                                                                        [ 42%]
tests/services/schemas/test_dates.py ..........                          [ 42%]
tests/services/schemas/test_formats.py ...
....                           [ 43%]
tests/services/schemas/test_funding.py ...
.....                          [ 43%]
tests/services/schemas/test_identifier.py ......
...                      [ 43%]
tests/services/schemas/test_languages.py ...
.                            [ 44%]
tests/services/schemas/test_location.py ...
..........                    [ 44%]
tests/services/schemas/test_metadata.py ...
..                            [ 44%]
tests/services/schemas/test_pids.py .......                              [ 45%]
tests/services/schemas/test_publication_date.py ...
ss.......             [ 45%]
tests/services/schemas/test_rdm_record_schema.py ...
.                    [ 46%]
tests/services/schemas/test_reference.py ...
......                       [ 46%]
tests/services/schemas/test_related_identifier.py ...
.........           [ 47%]
tests/services/schemas/test_resource_type.py .....                       [ 47%]
tests/services/schemas/test_rights.py ...
.
.
.
.
.
.
.
.
.
.
.
.
.
                   [ 48%]
tests/services/schemas/test_sizes.py ...
....                             [ 48%]
tests/services/schemas/test_utils.py ..                                  [ 48%]
tests/services/schemas/test_version.py ...
...                            [ 48%]
tests/services/schemas/test_vocabulary.py ....                           [ 49%]
tests/services/test_deletion_policy.py ...
.
.
.
.
                           [ 49%]
tests/services/test_generators.py ........
.
                              [ 49%]
tests/services/test_oai_service.py ...
.
.
.
                                [ 50%]
tests/services/test_permissions_policy.py ...
.
                           [ 50%]
tests/services/test_rdm_service.py ...
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                  [ 51%]
tests/services/test_record_deletion.py ...
.
.
                             [ 51%]
tests/services/test_record_deletion_request.py ...
.
.
.
.
.
.
.
.
               [ 52%]
tests/services/test_service_access.py ...
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
              [ 53%]
tests/services/test_service_communities.py ...
.
.
                         [ 53%]
tests/services/test_service_community_records.py ...
.
.
.
.
.
.
.
.
.
            [ 53%]
tests/services/test_service_record_communities.py ...
.
.
.
.
.
.
.
             [ 54%]
tests/services/test_service_review.py ...
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
  [ 55%]
tests/services/test_service_tasks.py ...
.
.
                               [ 56%]
tests/services/test_sort.py ...
                                          [ 56%]
tests/test_alembic.py ..s                                                [ 56%]
tests/test_invenio_rdm_records.py ....
                                   [ 56%]
tests/tokens/__init__.py ...                                             [ 56%]
tests/tokens/conftest.py ...                                             [ 56%]
tests/tokens/test_feature_flag.py ...
                                    [ 57%]
tests/tokens/test_resource_access.py ...
.
.
.
.
.
.
.
.
.
.
.
.
.
.
                   [ 57%]
invenio_rdm_records/__init__.py ...                                      [ 58%]
invenio_rdm_records/access_requests_ui/__init__.py ...                   [ 58%]
invenio_rdm_records/access_requests_ui/views.py ...                      [ 58%]
invenio_rdm_records/administration/__init__.py ...                       [ 58%]
invenio_rdm_records/administration/views/__init__.py ...                 [ 58%]
invenio_rdm_records/administration/views/oai.py ...                      [ 58%]
invenio_rdm_records/alembic/__init__.py ...                              [ 58%]
invenio_rdm_records/alembic/0cf260eb8e97_create_table_for_secret_links.py . [ 59%]
..                                                                       [ 59%]
invenio_rdm_records/alembic/1746626978_drop_rdmrecordquota_user_id_unique_.py . [ 59%]
..                                                                       [ 59%]
invenio_rdm_records/alembic/2186256e8d9b_add_deletion_status_to_rdmrecords.py . [ 59%]
..                                                                       [ 59%]
invenio_rdm_records/alembic/4a15e8671f4d_create_rdm_records_tables.py .. [ 59%]
.                                                                        [ 59%]
invenio_rdm_records/alembic/88d1463de5c0_create_parent_record_table.py . [ 59%]
..                                                                       [ 59%]
invenio_rdm_records/alembic/8ed1a438601c_migrate_secret_links.py ...     [ 59%]
invenio_rdm_records/alembic/9e0ac518b9df_create_records_communities_m2m_table.py . [ 59%]
..                                                                       [ 59%]
invenio_rdm_records/alembic/a2a6819f14f1_create_files_and_media_files_versioning_.py . [ 60%]
..                                                                       [ 60%]
invenio_rdm_records/alembic/a3957490361d_remove_pidrelations_tables.py . [ 60%]
..                                                                       [ 60%]
invenio_rdm_records/alembic/a6bfa06b1a6d_add_origin_and_description_to_secret_links.py . [ 60%]
..                                                                       [ 60%]
invenio_rdm_records/alembic/b822ba22c688_create_rdm_records_branch.py .. [ 60%]
.                                                                        [ 60%]
invenio_rdm_records/alembic/cfcb8cb78708_create_access_request_tokens_table.py . [ 60%]
..                                                                       [ 60%]
invenio_rdm_records/alembic/faf0cefa79a0_create_record_quota_tables.py . [ 60%]
..                                                                       [ 60%]
invenio_rdm_records/alembic/ff860d48fb4b_create_media_files_table.py ... [ 60%]
                                                                         [ 60%]
invenio_rdm_records/alembic/ff9bec971d30_add_indexes.py ...              [ 61%]
invenio_rdm_records/alembic/ffd725001655_add_field_to_record_consent_to_share_.py . [ 61%]
..                                                                       [ 61%]
invenio_rdm_records/checks/__init__.py ...                               [ 61%]
invenio_rdm_records/checks/requests.py ...                               [ 61%]
invenio_rdm_records/cli.py ...                                           [ 61%]
invenio_rdm_records/config.py ...                                        [ 61%]
invenio_rdm_records/contrib/__init__.py ...                              [ 62%]
invenio_rdm_records/contrib/codemeta/__init__.py ...                     [ 62%]
invenio_rdm_records/contrib/codemeta/custom_fields.py ...                [ 62%]
invenio_rdm_records/contrib/codemeta/processors.py ...                   [ 62%]
invenio_rdm_records/contrib/imprint/__init__.py ...                      [ 62%]
invenio_rdm_records/contrib/imprint/custom_fields.py ...                 [ 62%]
invenio_rdm_records/contrib/imprint/processors.py ...                    [ 62%]
invenio_rdm_records/contrib/journal/__init__.py ...                      [ 63%]
invenio_rdm_records/contrib/journal/custom_fields.py ...                 [ 63%]
invenio_rdm_records/contrib/journal/processors.py ...                    [ 63%]
invenio_rdm_records/contrib/journal/sort.py ...                          [ 63%]
invenio_rdm_records/contrib/meeting/__init__.py ...                      [ 63%]
invenio_rdm_records/contrib/meeting/custom_fields.py ...                 [ 63%]
invenio_rdm_records/contrib/meeting/processors.py ...                    [ 63%]
invenio_rdm_records/contrib/meeting/sort.py ...                          [ 64%]
invenio_rdm_records/contrib/thesis/__init__.py ...                       [ 64%]
invenio_rdm_records/contrib/thesis/custom_fields.py ...                  [ 64%]
invenio_rdm_records/ext.py ...                                           [ 64%]
invenio_rdm_records/fixtures/__init__.py ...                             [ 64%]
invenio_rdm_records/fixtures/communities.py ...                          [ 64%]
invenio_rdm_records/fixtures/data/vocabularies/languages.py ...          [ 64%]
invenio_rdm_records/fixtures/demo.py ...                                 [ 65%]
invenio_rdm_records/fixtures/fixture.py ...                              [ 65%]
invenio_rdm_records/fixtures/records.py ...                              [ 65%]
invenio_rdm_records/fixtures/tasks.py ...                                [ 65%]
invenio_rdm_records/fixtures/users.py ...                                [ 65%]
invenio_rdm_records/fixtures/vocabularies.py ...                         [ 65%]
invenio_rdm_records/jobs/__init__.py ...                                 [ 65%]
invenio_rdm_records/jobs/jobs.py ...                                     [ 66%]
invenio_rdm_records/notifications/__init__.py ...                        [ 66%]
invenio_rdm_records/notifications/builders.py ...                        [ 66%]
invenio_rdm_records/oai.py ...                                           [ 66%]
invenio_rdm_records/oaiserver/__init__.py ...                            [ 66%]
invenio_rdm_records/oaiserver/resources/__init__.py ...                  [ 66%]
invenio_rdm_records/oaiserver/resources/config.py ...                    [ 66%]
invenio_rdm_records/oaiserver/resources/resources.py ...                 [ 67%]
invenio_rdm_records/oaiserver/services/__init__.py ...                   [ 67%]
invenio_rdm_records/oaiserver/services/config.py ...                     [ 67%]
invenio_rdm_records/oaiserver/services/errors.py ...                     [ 67%]
invenio_rdm_records/oaiserver/services/permissions.py ...                [ 67%]
invenio_rdm_records/oaiserver/services/results.py ...                    [ 67%]
invenio_rdm_records/oaiserver/services/schema.py ...                     [ 67%]
invenio_rdm_records/oaiserver/services/services.py ...                   [ 68%]
invenio_rdm_records/oaiserver/services/uow.py ...                        [ 68%]
invenio_rdm_records/proxies.py ...                                       [ 68%]
invenio_rdm_records/records/__init__.py ...                              [ 68%]
invenio_rdm_records/records/api.py ...                                   [ 68%]
invenio_rdm_records/records/dumpers/__init__.py ...                      [ 68%]
invenio_rdm_records/records/dumpers/access.py ...                        [ 68%]
invenio_rdm_records/records/dumpers/combined_subjects.py ...             [ 69%]
invenio_rdm_records/records/dumpers/edtf.py ...                          [ 69%]
invenio_rdm_records/records/dumpers/locations.py ...                     [ 69%]
invenio_rdm_records/records/dumpers/pids.py ...                          [ 69%]
invenio_rdm_records/records/dumpers/statistics.py ...                    [ 69%]
invenio_rdm_records/records/dumpers/subject_hierarchy.py ...             [ 69%]
invenio_rdm_records/records/jsonschemas/__init__.py ...                  [ 69%]
invenio_rdm_records/records/mappings/__init__.py ...                     [ 70%]
invenio_rdm_records/records/mappings/os-v1/__init__.py ...               [ 70%]
invenio_rdm_records/records/mappings/os-v2/__init__.py ...               [ 70%]
invenio_rdm_records/records/mappings/v7/__init__.py ...                  [ 70%]
invenio_rdm_records/records/models.py ...                                [ 70%]
invenio_rdm_records/records/processors/base.py ...                       [ 70%]
invenio_rdm_records/records/processors/tiles.py ...                      [ 71%]
invenio_rdm_records/records/stats/__init__.py ...                        [ 71%]
invenio_rdm_records/records/stats/api.py ...                             [ 71%]
invenio_rdm_records/records/stats/templates/__init__.py ...              [ 71%]
invenio_rdm_records/records/stats/templates/aggregations/__init__.py ... [ 71%]
                                                                         [ 71%]
invenio_rdm_records/records/stats/templates/aggregations/aggr_file_download/__init__.py . [ 71%]
..                                                                       [ 71%]
invenio_rdm_records/records/stats/templates/aggregations/aggr_file_download/os-v1/__init__.py . [ 71%]
..                                                                       [ 71%]
invenio_rdm_records/records/stats/templates/aggregations/aggr_file_download/os-v2/__init__.py . [ 71%]
..                                                                       [ 72%]
invenio_rdm_records/records/stats/templates/aggregations/aggr_file_download/v7/__init__.py . [ 72%]
..                                                                       [ 72%]
invenio_rdm_records/records/stats/templates/aggregations/aggr_record_view/__init__.py . [ 72%]
..                                                                       [ 72%]
invenio_rdm_records/records/stats/templates/aggregations/aggr_record_view/os-v1/__init__.py . [ 72%]
..                                                                       [ 72%]
invenio_rdm_records/records/stats/templates/aggregations/aggr_record_view/os-v2/__init__.py . [ 72%]
..                                                                       [ 72%]
invenio_rdm_records/records/stats/templates/aggregations/aggr_record_view/v7/__init__.py . [ 72%]
..                                                                       [ 72%]
invenio_rdm_records/records/stats/templates/events/__init__.py ...       [ 72%]
invenio_rdm_records/records/stats/templates/events/file_download/__init__.py . [ 72%]
..                                                                       [ 73%]
invenio_rdm_records/records/stats/templates/events/file_download/os-v1/__init__.py . [ 73%]
..                                                                       [ 73%]
invenio_rdm_records/records/stats/templates/events/file_download/os-v2/__init__.py . [ 73%]
..                                                                       [ 73%]
invenio_rdm_records/records/stats/templates/events/file_download/v7/__init__.py . [ 73%]
..                                                                       [ 73%]
invenio_rdm_records/records/stats/templates/events/record_view/__init__.py . [ 73%]
..                                                                       [ 73%]
invenio_rdm_records/records/stats/templates/events/record_view/os-v1/__init__.py . [ 73%]
..                                                                       [ 73%]
invenio_rdm_records/records/stats/templates/events/record_view/os-v2/__init__.py . [ 73%]
..                                                                       [ 73%]
invenio_rdm_records/records/stats/templates/events/record_view/v7/__init__.py . [ 73%]
..                                                                       [ 74%]
invenio_rdm_records/records/systemfields/__init__.py ...                 [ 74%]
invenio_rdm_records/records/systemfields/access/__init__.py ...          [ 74%]
invenio_rdm_records/records/systemfields/access/access_settings.py ...   [ 74%]
invenio_rdm_records/records/systemfields/access/embargo.py ...           [ 74%]
invenio_rdm_records/records/systemfields/access/field/__init__.py ...    [ 74%]
invenio_rdm_records/records/systemfields/access/field/parent.py ...      [ 74%]
invenio_rdm_records/records/systemfields/access/field/record.py ...      [ 75%]
invenio_rdm_records/records/systemfields/access/grants.py ...            [ 75%]
invenio_rdm_records/records/systemfields/access/links.py ...             [ 75%]
invenio_rdm_records/records/systemfields/access/owners.py ...            [ 75%]
invenio_rdm_records/records/systemfields/access/protection.py ...        [ 75%]
invenio_rdm_records/records/systemfields/deletion_status.py ...          [ 75%]
invenio_rdm_records/records/systemfields/draft_status.py ...             [ 75%]
invenio_rdm_records/records/systemfields/has_draftcheck.py ...           [ 76%]
invenio_rdm_records/records/systemfields/is_verified.py ...              [ 76%]
invenio_rdm_records/records/systemfields/statistics.py ...               [ 76%]
invenio_rdm_records/records/systemfields/tombstone.py ...                [ 76%]
invenio_rdm_records/requests/__init__.py ...                             [ 76%]
invenio_rdm_records/requests/access/__init__.py ...                      [ 76%]
invenio_rdm_records/requests/access/models.py ...                        [ 76%]
invenio_rdm_records/requests/access/permissions.py ...                   [ 77%]
invenio_rdm_records/requests/access/requests.py ...                      [ 77%]
invenio_rdm_records/requests/access/tasks.py ...                         [ 77%]
invenio_rdm_records/requests/base.py ...                                 [ 77%]
invenio_rdm_records/requests/community_inclusion.py ...                  [ 77%]
invenio_rdm_records/requests/community_submission.py ...                 [ 77%]
invenio_rdm_records/requests/decorators.py ...                           [ 77%]
invenio_rdm_records/requests/entity_resolvers.py ...                     [ 78%]
invenio_rdm_records/requests/record_deletion.py ...                      [ 78%]
invenio_rdm_records/requests/user_moderation/__init__.py ...             [ 78%]
invenio_rdm_records/requests/user_moderation/actions.py ...              [ 78%]
invenio_rdm_records/requests/user_moderation/tasks.py ...                [ 78%]
invenio_rdm_records/requests/user_moderation/utils.py ...                [ 78%]
invenio_rdm_records/resources/__init__.py ...                            [ 78%]
invenio_rdm_records/resources/args.py ...                                [ 79%]
invenio_rdm_records/resources/config.py ...                              [ 79%]
invenio_rdm_records/resources/deserializers/__init__.py ...              [ 79%]
invenio_rdm_records/resources/deserializers/errors.py ...                [ 79%]
invenio_rdm_records/resources/deserializers/rocrate/__init__.py ...      [ 79%]
invenio_rdm_records/resources/deserializers/rocrate/schema.py ...        [ 79%]
invenio_rdm_records/resources/errors.py ...                              [ 79%]
invenio_rdm_records/resources/iiif.py ...                                [ 80%]
invenio_rdm_records/resources/resources.py ...                           [ 80%]
invenio_rdm_records/resources/serializers/__init__.py ...                [ 80%]
invenio_rdm_records/resources/serializers/bibtex/__init__.py ...         [ 80%]
invenio_rdm_records/resources/serializers/bibtex/schema.py ...           [ 80%]
invenio_rdm_records/resources/serializers/bibtex/schema_formats.py ...   [ 80%]
invenio_rdm_records/resources/serializers/cff/__init__.py ...            [ 81%]
invenio_rdm_records/resources/serializers/cff/schema.py ...              [ 81%]
invenio_rdm_records/resources/serializers/codemeta/__init__.py ...       [ 81%]
invenio_rdm_records/resources/serializers/codemeta/schema.py ...         [ 81%]
invenio_rdm_records/resources/serializers/csl/__init__.py ...            [ 81%]
invenio_rdm_records/resources/serializers/csl/schema.py ...              [ 81%]
invenio_rdm_records/resources/serializers/csv/__init__.py ...            [ 81%]
invenio_rdm_records/resources/serializers/datacite/__init__.py ...       [ 82%]
invenio_rdm_records/resources/serializers/datacite/schema.py ...         [ 82%]
invenio_rdm_records/resources/serializers/datapackage/__init__.py ...    [ 82%]
invenio_rdm_records/resources/serializers/datapackage/schema.py ...      [ 82%]
invenio_rdm_records/resources/serializers/dcat/__init__.py ...           [ 82%]
invenio_rdm_records/resources/serializers/dcat/schema.py ...             [ 82%]
invenio_rdm_records/resources/serializers/dublincore/__init__.py ...     [ 82%]
invenio_rdm_records/resources/serializers/dublincore/schema.py ...       [ 83%]
invenio_rdm_records/resources/serializers/errors.py ...                  [ 83%]
invenio_rdm_records/resources/serializers/geojson/__init__.py ...        [ 83%]
invenio_rdm_records/resources/serializers/geojson/schema.py ...          [ 83%]
invenio_rdm_records/resources/serializers/iiif/__init__.py ...           [ 83%]
invenio_rdm_records/resources/serializers/iiif/schema.py ...             [ 83%]
invenio_rdm_records/resources/serializers/marcxml/__init__.py ...        [ 83%]
invenio_rdm_records/resources/serializers/marcxml/schema.py ...          [ 84%]
invenio_rdm_records/resources/serializers/schemaorg/__init__.py ...      [ 84%]
invenio_rdm_records/resources/serializers/schemaorg/schema.py ...        [ 84%]
invenio_rdm_records/resources/serializers/schemas.py ...                 [ 84%]
invenio_rdm_records/resources/serializers/signposting/__init__.py ...    [ 84%]
invenio_rdm_records/resources/serializers/signposting/schema.py ...      [ 84%]
invenio_rdm_records/resources/serializers/ui/__init__.py ...             [ 84%]
invenio_rdm_records/resources/serializers/ui/fields.py ...               [ 85%]
invenio_rdm_records/resources/serializers/ui/schema.py ...               [ 85%]
invenio_rdm_records/resources/serializers/utils.py ...                   [ 85%]
invenio_rdm_records/resources/stats/__init__.py ...                      [ 85%]
invenio_rdm_records/resources/stats/event_builders.py ...                [ 85%]
invenio_rdm_records/secret_links/__init__.py ...                         [ 85%]
invenio_rdm_records/secret_links/errors.py ...                           [ 85%]
invenio_rdm_records/secret_links/models.py ...                           [ 86%]
invenio_rdm_records/secret_links/permissions.py ...                      [ 86%]
invenio_rdm_records/secret_links/serializers.py ...                      [ 86%]
invenio_rdm_records/secret_links/signals.py ...                          [ 86%]
invenio_rdm_records/services/__init__.py ...                             [ 86%]
invenio_rdm_records/services/access/__init__.py ...                      [ 86%]
invenio_rdm_records/services/access/service.py ...                       [ 86%]
invenio_rdm_records/services/communities/__init__.py ...                 [ 87%]
invenio_rdm_records/services/communities/components.py ...               [ 87%]
invenio_rdm_records/services/communities/moderation.py ...               [ 87%]
invenio_rdm_records/services/communities/service.py ...                  [ 87%]
invenio_rdm_records/services/community_inclusion/__init__.py ...         [ 87%]
invenio_rdm_records/services/community_inclusion/service.py ...          [ 87%]
invenio_rdm_records/services/community_records/__init__.py ...           [ 87%]
invenio_rdm_records/services/community_records/service.py ...            [ 88%]
invenio_rdm_records/services/components/__init__.py ...                  [ 88%]
invenio_rdm_records/services/components/access.py ...                    [ 88%]
invenio_rdm_records/services/components/custom_fields.py ...             [ 88%]
invenio_rdm_records/services/components/files.py ...                     [ 88%]
invenio_rdm_records/services/components/internal_notes.py ...            [ 88%]
invenio_rdm_records/services/components/metadata.py ...                  [ 88%]
invenio_rdm_records/services/components/pids.py ...                      [ 89%]
invenio_rdm_records/services/components/record_deletion.py ...           [ 89%]
invenio_rdm_records/services/components/record_files.py ...              [ 89%]
invenio_rdm_records/services/components/review.py ...                    [ 89%]
invenio_rdm_records/services/components/signal.py ...                    [ 89%]
invenio_rdm_records/services/components/verified.py ...                  [ 89%]
invenio_rdm_records/services/config.py ...                               [ 89%]
invenio_rdm_records/services/customizations.py ...                       [ 90%]
invenio_rdm_records/services/decorators.py ...                           [ 90%]
invenio_rdm_records/services/deletion_policy.py ...                      [ 90%]
invenio_rdm_records/services/dummy.py ...                                [ 90%]
invenio_rdm_records/services/errors.py ...                               [ 90%]
invenio_rdm_records/services/facets.py ...                               [ 90%]
invenio_rdm_records/services/files/__init__.py ...                       [ 91%]
invenio_rdm_records/services/files/service.py ...                        [ 91%]
invenio_rdm_records/services/generators.py ...                           [ 91%]
invenio_rdm_records/services/github/__init__.py ...                      [ 91%]
invenio_rdm_records/services/github/metadata.py ...                      [ 91%]
invenio_rdm_records/services/github/release.py ...                       [ 91%]
invenio_rdm_records/services/github/utils.py ...                         [ 91%]
invenio_rdm_records/services/iiif/__init__.py ...                        [ 92%]
invenio_rdm_records/services/iiif/converter.py ...                       [ 92%]
invenio_rdm_records/services/iiif/service.py ...                         [ 92%]
invenio_rdm_records/services/iiif/storage.py ...                         [ 92%]
invenio_rdm_records/services/iiif/tasks.py ...                           [ 92%]
invenio_rdm_records/services/permissions.py ...                          [ 92%]
invenio_rdm_records/services/pids/__init__.py ...                        [ 92%]
invenio_rdm_records/services/pids/errors.py ...                          [ 93%]
invenio_rdm_records/services/pids/manager.py ...                         [ 93%]
invenio_rdm_records/services/pids/providers/__init__.py ...              [ 93%]
invenio_rdm_records/services/pids/providers/base.py ...                  [ 93%]
invenio_rdm_records/services/pids/providers/datacite.py ...              [ 93%]
invenio_rdm_records/services/pids/providers/external.py ...              [ 93%]
invenio_rdm_records/services/pids/providers/oai.py ...                   [ 93%]
invenio_rdm_records/services/pids/service.py ...                         [ 94%]
invenio_rdm_records/services/pids/tasks.py ...                           [ 94%]
invenio_rdm_records/services/queryparser.py ...                          [ 94%]
invenio_rdm_records/services/requests/__init__.py ...                    [ 94%]
invenio_rdm_records/services/requests/service.py ...                     [ 94%]
invenio_rdm_records/services/result_items.py ...                         [ 94%]
invenio_rdm_records/services/results.py ...                              [ 94%]
invenio_rdm_records/services/review/__init__.py ...                      [ 95%]
invenio_rdm_records/services/review/links.py ...                         [ 95%]
invenio_rdm_records/services/review/service.py ...                       [ 95%]
invenio_rdm_records/services/schemas/__init__.py ...                     [ 95%]
invenio_rdm_records/services/schemas/access.py ...                       [ 95%]
invenio_rdm_records/services/schemas/community_records.py ...            [ 95%]
invenio_rdm_records/services/schemas/files.py ...                        [ 95%]
invenio_rdm_records/services/schemas/metadata.py ...                     [ 96%]
invenio_rdm_records/services/schemas/parent/__init__.py ...              [ 96%]
invenio_rdm_records/services/schemas/parent/access.py ...                [ 96%]
invenio_rdm_records/services/schemas/parent/communities.py ...           [ 96%]
invenio_rdm_records/services/schemas/pids.py ...                         [ 96%]
invenio_rdm_records/services/schemas/quota.py ...                        [ 96%]
invenio_rdm_records/services/schemas/record.py ...                       [ 96%]
invenio_rdm_records/services/schemas/record_communities.py ...           [ 97%]
invenio_rdm_records/services/schemas/stats.py ...                        [ 97%]
invenio_rdm_records/services/schemas/tombstone.py ...                    [ 97%]
invenio_rdm_records/services/schemas/utils.py ...                        [ 97%]
invenio_rdm_records/services/schemas/versions.py ...                     [ 97%]
invenio_rdm_records/services/search_params.py ...                        [ 97%]
invenio_rdm_records/services/services.py ...                             [ 97%]
invenio_rdm_records/services/signals/__init__.py ...                     [ 98%]
invenio_rdm_records/services/signals/signals.py ...                      [ 98%]
invenio_rdm_records/services/sort.py ...                                 [ 98%]
invenio_rdm_records/services/stats/__init__.py ...                       [ 98%]
invenio_rdm_records/services/stats/permissions.py ...                    [ 98%]
invenio_rdm_records/services/tasks.py ...                                [ 98%]
invenio_rdm_records/tokens/__init__.py ...                               [ 98%]
invenio_rdm_records/tokens/errors.py ...                                 [ 99%]
invenio_rdm_records/tokens/permissions.py ...                            [ 99%]
invenio_rdm_records/tokens/resource_access.py ...                        [ 99%]
invenio_rdm_records/tokens/scopes.py ...                                 [ 99%]
invenio_rdm_records/utils.py ...                                         [ 99%]
invenio_rdm_records/views.py ...                                         [ 99%]
invenio_rdm_records/webpack.py ...                                       [100%]

=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/passlib/utils/__init__.py:854
    from crypt import crypt as _crypt

.venv/lib/python3.12/site-packages/jsonresolver/contrib/jsonschema.py:31
.venv/lib/python3.12/site-packages/jsonresolver/contrib/jsonschema.py:31
    from jsonschema import RefResolver as _RefResolver

.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
    from jsonschema import RefResolutionError, RefResolver

.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
    from jsonschema import RefResolutionError, RefResolver

.venv/lib/python3.12/site-packages/fs/__init__.py:4
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

.venv/lib/python3.12/site-packages/pkg_resources/__init__.py:3146
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(pkg)

.venv/lib/python3.12/site-packages/fs/__init__.py:4
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

.venv/lib/python3.12/site-packages/fs/opener/__init__.py:6
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    __import__("pkg_resources").declare_namespace(__name__)  # type: ignore

.venv/lib/python3.12/site-packages/pkg_resources/__init__.py:2558
  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages
    declare_namespace(parent)

.venv/lib/python3.12/site-packages/marshmallow_utils/fields/generated.py:12
.venv/lib/python3.12/site-packages/marshmallow_utils/fields/generated.py:12
    from marshmallow import __version_info__ as marshmallow_version

.venv/lib/python3.12/site-packages/invenio_records_resources/services/files/schema.py:154
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/files/schema.py:154: RemovedInMarshmallow4Warning: The 'default' argument to fields is deprecated. Use 'dump_default' instead.
    storage_class = Str(default="L", dump_only=False)

invenio_rdm_records/config.py:15
    import idutils

    warnings.warn(

.venv/lib/python3.12/site-packages/marshmallow/fields.py:986
.venv/lib/python3.12/site-packages/marshmallow/fields.py:986
.venv/lib/python3.12/site-packages/marshmallow/fields.py:986
.venv/lib/python3.12/site-packages/marshmallow/fields.py:986
.venv/lib/python3.12/site-packages/marshmallow/fields.py:986
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/marshmallow/fields.py:986: RemovedInMarshmallow4Warning: The 'default' argument to fields is deprecated. Use 'dump_default' instead.
    super().__init__(**kwargs)

.venv/lib/python3.12/site-packages/marshmallow/utils.py:361
.venv/lib/python3.12/site-packages/marshmallow/utils.py:361
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/marshmallow/utils.py:361: ChangedInMarshmallow4Warning: `Field` should not be instantiated. Use `fields.Raw` or  another field subclass instead.
    return cls_or_instance()

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/flask_resources/serializers/base.py:55: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    self.list_schema = list_schema_cls(

.venv/lib/python3.12/site-packages/flask_resources/serializers/base.py:53
.venv/lib/python3.12/site-packages/flask_resources/serializers/base.py:53
tests/resources/serializers/test_ui_serializer.py::test_ui_serializer
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/flask_resources/serializers/base.py:53: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    self.object_schema = object_schema_cls(context=schema_context, **schema_kwargs)

invenio_rdm_records/services/facets.py:75
    warn(

.venv/lib/python3.12/site-packages/webargs/compat.py:8
    MARSHMALLOW_VERSION_INFO = tuple(LooseVersion(ma.__version__).version)  # type: tuple

.venv/lib/python3.12/site-packages/webargs/compat.py:8
    MARSHMALLOW_VERSION_INFO = tuple(LooseVersion(ma.__version__).version)  # type: tuple

.venv/lib/python3.12/site-packages/webargs/__init__.py:13
    __version_info__ = tuple(LooseVersion(__version__).version)

.venv/lib/python3.12/site-packages/datacite/jsonutils.py:15
.venv/lib/python3.12/site-packages/datacite/jsonutils.py:15
    from jsonschema import RefResolver, validate

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/flask_resources/serializers/base.py:121: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    super().__init__(**kwargs)

tests/resources/test_resources_search.py:39
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/resources/test_resources_search.py:39: SyntaxWarning: invalid escape sequence '\d'
    res = client.get("/records", query_string={"q": "/\d{12}/"}, headers=headers)

tests/services/components/test_pids_component.py:28
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/services/components/test_pids_component.py:28: PytestCollectionWarning: cannot collect test class 'TestManagedPIDProvider' because it has a __init__ constructor (from: tests/services/components/test_pids_component.py)
    class TestManagedPIDProvider(PIDProvider):

tests/services/test_permissions_policy.py:31
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/services/test_permissions_policy.py:31: PytestCollectionWarning: cannot collect test class 'TestRDMPermissionPolicy' because it has a __init__ constructor (from: tests/services/test_permissions_policy.py)
    class TestRDMPermissionPolicy(RecordPermissionPolicy):

tests/tokens/test_resource_access.py:34
    expires=datetime.utcnow() + timedelta(hours=10),

    return util.wrap_callable(lambda ctx: fn(), fn)  # type: ignore

    self._confirmed = datetime.utcnow() if confirmed else None

    datetime.utcnow()

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/flask_security/datastore.py:235: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    return self.user_model.query.get(identifier)

    target.updated = datetime.utcnow()

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/schema.py:90: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    valid_data = self.schema(context=context, **schema_args).load(data)

    target.updated = datetime.utcnow()

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/marshmallow/fields.py:631: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    self._schema = schema_class(

    target.updated = datetime.utcnow()

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/schema.py:105: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    return self.schema(context=context, **schema_args).dump(data)

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_records/api.py:335: SAWarning: nested transaction already deassociated from connection
    with db.session.begin_nested():

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_db/uow.py:193: SAWarning: nested transaction already deassociated from connection
    self.session.commit()

    self.init_app(app)

    self._set_cache(app, config)

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/marshmallow_utils/schemas/identifier.py:41: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    super().__init__(**kwargs)

    now_ = datetime.utcnow()

tests/fixtures/test_cli.py::test_create_fake_demo_invitation_requests
    datetime.utcnow().replace(tzinfo=timezone.utc)

tests/fixtures/test_fixtures.py::test_load_users
    user.confirmed_at = _security.datetime_factory()

tests/fixtures/test_fixtures.py::test_load_communities
    featured_data = {"start_date": datetime.utcnow().isoformat()}

    e_responseDate.text = datetime_to_datestamp(datetime.utcnow())

    created = datetime.utcnow()

    return cls(int(id_s, 16), datetime.utcfromtimestamp(int(created_s, 16)))

    now = now or datetime.utcnow()

tests/records/dumpers/test_files_dumpers.py::test_files_dumper
tests/resources/test_draft_file_permissions.py::test_only_owners_can_import_files
tests/resources/test_files.py::test_published_record_files_allow_edit
tests/resources/test_files.py::test_published_record_files_deny_edit
tests/secret_links/test_sharing.py::test_invalid_level
tests/secret_links/test_sharing.py::test_permission_levels
tests/secret_links/test_sharing.py::test_permission_levels
tests/secret_links/test_sharing.py::test_permission_levels
tests/services/files/test_revert_of_deleted_files_in_published_record.py::test_revert_of_deleted_files_in_published_record
    "created": datetime.utcnow(),

tests/records/dumpers/test_files_dumpers.py::test_files_dumper
tests/resources/test_draft_file_permissions.py::test_only_owners_can_import_files
tests/resources/test_files.py::test_published_record_files_allow_edit
tests/resources/test_files.py::test_published_record_files_deny_edit
tests/secret_links/test_sharing.py::test_invalid_level
tests/secret_links/test_sharing.py::test_permission_levels
tests/secret_links/test_sharing.py::test_permission_levels
tests/secret_links/test_sharing.py::test_permission_levels
tests/services/files/test_revert_of_deleted_files_in_published_record.py::test_revert_of_deleted_files_in_published_record
    "updated": datetime.utcnow(),

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_records/api.py:443: SAWarning: nested transaction already deassociated from connection
    with db.session.begin_nested():

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/pytest_invenio/fixtures.py:564: SAWarning: nested transaction already deassociated from connection
    self._transaction.rollback(_to_root=False)

tests/records/dumpers/test_pids_dumper.py::test_esdumper_with_externalpidsext
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/records/dumpers/test_pids_dumper.py:37: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

    value = datetime.utcnow()

tests/records/systemfields/test_tombstone.py::test_tombstone_creation
    "removal_date": datetime.datetime.utcnow(),

tests/records/systemfields/test_tombstone.py::test_tombstone_invalid_removed_by
    for invalid_value in [[], datetime.datetime.utcnow()]:

tests/records/test_quotas.py::test_user_quota
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/invenio_rdm_records/services/services.py:772: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    user = User.query.get(id_)

tests/records/test_records_communities.py::test_community_integration
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/records/test_records_communities.py:43: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

tests/requests/test_user_moderation_actions.py::test_user_moderation_approve
tests/requests/test_user_moderation_actions.py::test_user_moderation_decline
    warn(

tests/requests/test_user_moderation_actions.py::test_user_moderation_approve
tests/requests/test_user_moderation_actions.py::test_user_moderation_decline
tests/requests/test_user_moderation_actions.py::test_user_moderation_decline
    self._created = datetime.utcnow()

tests/requests/test_user_moderation_actions.py::test_user_moderation_approve
    now = datetime.utcnow()

tests/requests/test_user_moderation_actions.py::test_user_moderation_decline
    now = datetime.utcnow()

    current_app.logger.warn(

tests/resources/serializers/test_dcat_serializer.py::test_dcat_serializer
    if subject_element:

tests/resources/serializers/test_signposting_serializer.py::test_signposting_serializer_full
tests/resources/serializers/test_signposting_serializer.py::test_signposting_serializer_minimal
tests/resources/test_resources.py::test_response_handlers
tests/resources/test_resources.py::test_response_handlers
tests/resources/test_signposting.py::test_linkset_endpoint
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/invenio_rdm_records/resources/serializers/signposting/schema.py:257: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    content_resource_schema = ContentResourceSchema(context={"record_dict": obj})

tests/resources/serializers/test_ui_serializer.py::test_ui_serializer
tests/resources/test_resources.py::test_response_handlers
tests/resources/test_resources.py::test_response_handlers
tests/resources/test_resources.py::test_response_handlers
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/flask_resources/parsers/schema.py:61: RemovedInMarshmallow4Warning: The `context` parameter is deprecated and will be removed in marshmallow 4.0. Use `contextvars.ContextVar` to pass context instead.
    self.context["object_schema_cls"](context=self.context).dump(obj)

tests/resources/test_access_requests.py::test_simple_guest_access_request_flow
    current_app.logger.warn(

tests/resources/test_access_requests.py::test_simple_guest_access_request_flow
    expires_at = datetime.utcnow() + shelf_life

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/invenio_rdm_records/records/systemfields/access/links.py:39: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    self._entity = SecretLink.query.get(self.link_id)

    _security.datetime_factory(),

tests/resources/test_files.py::test_published_record_files_allow_edit
tests/services/files/test_revert_of_deleted_files_in_published_record.py::test_revert_of_deleted_files_in_published_record
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_files_rest/models.py:750: SAWarning: Object of type <ObjectVersion> not in session, add operation along 'Bucket.objects' will not proceed (This warning originated from the Session 'autoflush' process, which was invoked automatically in response to a user-initiated operation. Consider using ``no_autoflush`` context manager if this warning happened while initializing objects.)
    return db.session.query(cls).filter_by(id=file_id).one_or_none()

    warnings.warn(

tests/resources/test_request_deletion.py::test_request_flow
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/resources/test_request_deletion.py:55: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

tests/resources/test_resources.py::test_link_creation
    in_10_days = datetime.utcnow() + timedelta(days=10)

tests/resources/test_resources.py::test_link_creation
tests/resources/test_resources.py::test_link_update
tests/resources/test_resources.py::test_link_update
tests/resources/test_resources.py::test_link_update
    if expires_at < datetime.utcnow():

tests/resources/test_resources.py::test_link_creation
tests/secret_links/test_secret_links.py::test_secret_link_not_expired
tests/secret_links/test_secret_links.py::test_secret_link_expired
tests/secret_links/test_secret_links.py::test_secret_link_validate_token
tests/secret_links/test_secret_links.py::test_secret_link_validate_token_expired
tests/secret_links/test_token_serializers.py::test_timed_serializer
tests/secret_links/test_token_serializers.py::test_timed_serializer_expired
    dt = (expires_at - datetime.utcnow()) if expires_at else None

tests/resources/test_resources.py::test_link_update
    in_10_days = datetime.utcnow() + timedelta(days=10)

tests/resources/test_resources.py::test_link_update
    _10_days_ago = datetime.utcnow() - timedelta(days=10)

tests/resources/test_resources.py::test_link_update
    elif expires_at and expires_at < datetime.utcnow():

tests/resources/test_resources_communities.py::test_remove_another_community
tests/resources/test_resources_communities.py::test_search_communities
tests/resources/test_resources_communities.py::test_republish_with_mulitple_communities
tests/resources/test_resources_communities.py::test_remove_record_last_community_with_multiple_communities
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/resources/test_resources_communities.py:31: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

tests/resources/test_serialized_links.py::test_draft_links

tests/secret_links/test_secret_links.py::test_secret_link_not_expired
    in_10_mins = datetime.utcnow() + timedelta(minutes=10)

tests/secret_links/test_secret_links.py::test_secret_link_not_expired
tests/secret_links/test_secret_links.py::test_secret_link_expired
tests/secret_links/test_secret_links.py::test_secret_link_validate_token
    return datetime.utcnow() > self.expires_at

tests/secret_links/test_secret_links.py::test_secret_link_expired
    _10_mins_ago = datetime.utcnow() - timedelta(minutes=10)

tests/secret_links/test_secret_links.py::test_secret_link_revoke
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/secret_links/test_secret_links.py:58: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    assert SecretLink.query.get(uuid) == link

tests/secret_links/test_secret_links.py::test_secret_link_revoke
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/secret_links/test_secret_links.py:62: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    assert SecretLink.query.get(uuid) is None

tests/secret_links/test_secret_links.py::test_secret_link_get_by_token
tests/secret_links/test_secret_links.py::test_secret_link_get_by_old_token
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/invenio_rdm_records/secret_links/models.py:101: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    link = cls.query.get(data["id"])

tests/secret_links/test_secret_links.py::test_secret_link_validate_token
    in_10_mins = datetime.utcnow() + timedelta(minutes=10)

tests/secret_links/test_secret_links.py::test_secret_link_validate_token
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/invenio_rdm_records/secret_links/models.py:152: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    link = cls.query.get(data["id"])

tests/secret_links/test_secret_links.py::test_secret_link_validate_token_expired
    _10_mins_ago = datetime.utcnow() - timedelta(minutes=10)

tests/secret_links/test_sharing.py::test_read_restricted_record_with_secret_link
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/secret_links/test_sharing.py:200: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

tests/secret_links/test_token_serializers.py::test_timed_serializer
    in_10_mins = datetime.utcnow() + timedelta(minutes=10)

tests/secret_links/test_token_serializers.py::test_timed_serializer_expired
    _10_mins_ago = datetime.utcnow() - timedelta(minutes=10)

    u.user.verified_at = datetime.utcnow()

tests/services/files/test_revert_of_deleted_files_in_published_record.py::test_revert_of_deleted_files_in_published_record
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_records/api.py:496: SAWarning: nested transaction already deassociated from connection
    with db.session.begin_nested():

tests/services/files/test_revert_of_deleted_files_in_published_record.py::test_revert_of_deleted_files_in_published_record
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_records/api.py:549: SAWarning: nested transaction already deassociated from connection
    with db.session.begin_nested():

tests/services/test_deletion_policy.py::test_grace_period_policy
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/services/test_deletion_policy.py:37: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

tests/services/test_deletion_policy.py::test_deletion_policy_fallback_to_request
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/services/test_deletion_policy.py:95: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

tests/services/test_rdm_service.py::test_publish_public_record_versions_no_or_external_doi_managed_doi
tests/services/test_rdm_service.py::test_publish_public_record_versions_managed_doi_external_doi
tests/services/test_rdm_service.py::test_publish_public_record_versions_managed_doi_no_doi
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_db/uow.py:212: SAWarning: nested transaction already deassociated from connection
    self.session.commit()

tests/services/test_rdm_service.py::test_embargo_lift_creates_doi
    mock_arrow.return_value = arrow.get(datetime.utcnow())

tests/services/test_rdm_service.py::test_embargo_lift_without_draft
tests/services/test_rdm_service.py::test_embargo_lift_with_draft
tests/services/test_rdm_service.py::test_embargo_lift_with_updated_draft
tests/services/test_service_tasks.py::test_embargo_lift_without_draft
tests/services/test_service_tasks.py::test_embargo_lift_with_draft
tests/services/test_service_tasks.py::test_embargo_lift_with_updated_draft
    mock_arrow.return_value = arrow.get(datetime.utcnow())

tests/services/test_record_deletion.py::test_record_deletion
    assert arrow.get(tombstone.removal_date).date() == datetime.utcnow().date()

tests/services/test_record_deletion_request.py::test_request_deletion_request_only
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/services/test_record_deletion_request.py:77: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

tests/services/test_record_deletion_request.py::test_request_deletion_duplicate_prevention
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/services/test_record_deletion_request.py:107: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

tests/services/test_record_deletion_request.py::test_request_deletion_invalid_reason
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/services/test_record_deletion_request.py:137: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

tests/services/test_service_community_records.py::test_remove_record_of_other_community
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/tests/services/test_service_community_records.py:95: SAWarning: nested transaction already deassociated from connection
    db.session.commit()

tests/tokens/test_resource_access.py::test_rat_validation_failed
    payload = {"iat": datetime.utcnow()} if payload is None else payload

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/invenio_rdm_records/tokens/resource_access.py:52: LegacyAPIWarning: The Query.get() method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as Session.get() (deprecated since: 2.0) (Background on SQLAlchemy 2.0 at: https://sqlalche.me/e/b8d9)
    access_token = Token.query.get(int(access_token_id))

tests/tokens/test_resource_access.py::test_rat_validation_failed
    payload={"iat": datetime.utcnow() - timedelta(hours=1), "sub": {}},

tests/tokens/test_resource_access.py::test_rec_files_permissions_with_rat
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_rec_metadata_permissions_with_rat
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_draft_files_permissions_with_rat
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_draft_metadata_permissions_with_rat
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_fully_restricted_rec_files_permissions_with_rat
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_fully_restricted_draft_files_permissions_with_rat
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_rec_files_permissions_with_rat_invalid_token_error
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_rec_files_permissions_with_rat_missing_token_id_error
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_rec_files_permissions_with_rat_invalid_token_id_error
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_rec_files_permissions_with_rat_expired_token_error
    payload={"iat": datetime.utcnow() - timedelta(hours=1), "sub": {}},

tests/tokens/test_resource_access.py::test_rec_files_permissions_with_rat_wrong_file
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_rec_files_permissions_with_rat_wrong_access
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_rec_files_permissions_with_rat_wrong_recid
    "iat": datetime.utcnow(),

tests/tokens/test_resource_access.py::test_rec_files_permissions_with_rat_wrong_signer
    "iat": datetime.utcnow(),

- generated xml file: /home/runner/work/invenio-testrig/invenio-testrig/artifacts/test-report-original.xml -
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.12-final-0 _______________

Name                                                                                            Stmts   Miss  Cover   Missing
invenio_rdm_records/__init__.py                                                                     3      0   100%
invenio_rdm_records/access_requests_ui/__init__.py                                                  0      0   100%
invenio_rdm_records/access_requests_ui/views.py                                                    29     17    41%   32-52, 58-62
invenio_rdm_records/administration/__init__.py                                                      0      0   100%
invenio_rdm_records/administration/views/__init__.py                                                0      0   100%
invenio_rdm_records/administration/views/oai.py                                                    52      0   100%
invenio_rdm_records/alembic/0cf260eb8e97_create_table_for_secret_links.py                          13      4    69%   23-32, 42-46
invenio_rdm_records/alembic/4a15e8671f4d_create_rdm_records_tables.py                              30     20    33%   26-269, 279-297
invenio_rdm_records/alembic/8ed1a438601c_migrate_secret_links.py                                    8      1    88%   22
invenio_rdm_records/alembic/9e0ac518b9df_create_records_communities_m2m_table.py                   11      2    82%   23, 54
invenio_rdm_records/alembic/88d1463de5c0_create_parent_record_table.py                             30     20    33%   25-101, 129-146
invenio_rdm_records/alembic/2186256e8d9b_add_deletion_status_to_rdmrecords.py                      31     22    29%   22-43, 49-74, 79-80
invenio_rdm_records/alembic/1746626978_drop_rdmrecordquota_user_id_unique_.py                       9      2    78%   21, 28
invenio_rdm_records/alembic/__init__.py                                                             0      0   100%
invenio_rdm_records/alembic/a2a6819f14f1_create_files_and_media_files_versioning_.py               26     16    38%   25-137, 148-175
invenio_rdm_records/alembic/a6bfa06b1a6d_add_origin_and_description_to_secret_links.py             12      4    67%   22-26, 34-35
invenio_rdm_records/alembic/a3957490361d_remove_pidrelations_tables.py                             14      6    57%   22-26, 32
invenio_rdm_records/alembic/b822ba22c688_create_rdm_records_branch.py                               8      2    75%   20, 25
invenio_rdm_records/alembic/cfcb8cb78708_create_access_request_tokens_table.py                     13      4    69%   23-37, 47-51
invenio_rdm_records/alembic/faf0cefa79a0_create_record_quota_tables.py                             13      4    69%   23-43, 65-66
invenio_rdm_records/alembic/ff9bec971d30_add_indexes.py                                            31     24    23%   21-87, 97-136
invenio_rdm_records/alembic/ff860d48fb4b_create_media_files_table.py                               28     18    36%   25-149, 164-184
invenio_rdm_records/alembic/ffd725001655_add_field_to_record_consent_to_share_.py                  10      2    80%   23, 35
invenio_rdm_records/checks/__init__.py                                                              0      0   100%
invenio_rdm_records/checks/requests.py                                                             72     51    29%   32-45, 53-73, 103-123, 131-152
invenio_rdm_records/cli.py                                                                        187     90    52%   65-66, 89-102, 125-132, 155-162, 185-192, 215-239, 262-275, 282-286, 301-305, 312-344, 372-373, 382-386, 409-411
invenio_rdm_records/config.py                                                                     161      0   100%
invenio_rdm_records/contrib/__init__.py                                                             0      0   100%
invenio_rdm_records/contrib/codemeta/__init__.py                                                    2      0   100%
invenio_rdm_records/contrib/codemeta/custom_fields.py                                              10      0   100%
invenio_rdm_records/contrib/codemeta/processors.py                                                 15     12    20%   17-34
invenio_rdm_records/contrib/imprint/__init__.py                                                     2      0   100%
invenio_rdm_records/contrib/imprint/custom_fields.py                                               15      2    87%   30, 48
invenio_rdm_records/contrib/imprint/processors.py                                                  56     41    27%   26-43, 58-95
invenio_rdm_records/contrib/journal/__init__.py                                                     3      0   100%
invenio_rdm_records/contrib/journal/custom_fields.py                                               15      2    87%   29, 47
invenio_rdm_records/contrib/journal/processors.py                                                 107     60    44%   25-48, 63-88, 116, 121, 139-156, 171-188
invenio_rdm_records/contrib/journal/sort.py                                                         2      0   100%
invenio_rdm_records/contrib/meeting/__init__.py                                                     3      0   100%
invenio_rdm_records/contrib/meeting/custom_fields.py                                               17      2    88%   38, 63
invenio_rdm_records/contrib/meeting/processors.py                                                  31     16    48%   24-37, 52-63
invenio_rdm_records/contrib/meeting/sort.py                                                         2      0   100%
invenio_rdm_records/contrib/thesis/__init__.py                                                      2      0   100%
invenio_rdm_records/contrib/thesis/custom_fields.py                                                14      2    86%   28, 41
invenio_rdm_records/ext.py                                                                        111      3    97%   134, 140, 146
invenio_rdm_records/fixtures/__init__.py                                                           25     12    52%   32, 36-59, 67-71
invenio_rdm_records/fixtures/communities.py                                                        12      0   100%
invenio_rdm_records/fixtures/data/vocabularies/languages.py                                        15      7    53%   34-41, 46-47, 51-52
invenio_rdm_records/fixtures/demo.py                                                              111     19    83%   46-49, 74-85, 99, 116, 151, 345-354
invenio_rdm_records/fixtures/fixture.py                                                            28      8    71%   34, 49-57, 62
invenio_rdm_records/fixtures/records.py                                                             5      0   100%
invenio_rdm_records/fixtures/tasks.py                                                             118     15    87%   58-59, 78, 85-90, 96-99, 165, 182-183, 217-218
invenio_rdm_records/fixtures/users.py                                                              44      3    93%   81-83
invenio_rdm_records/fixtures/vocabularies.py                                                      212     30    86%   60-71, 75-81, 89-91, 99-103, 192, 399-400
invenio_rdm_records/jobs/__init__.py                                                                0      0   100%
invenio_rdm_records/jobs/jobs.py                                                                    4      0   100%
invenio_rdm_records/notifications/__init__.py                                                       0      0   100%
invenio_rdm_records/notifications/builders.py                                                     151      4    97%   112, 144, 289, 324
invenio_rdm_records/oai.py                                                                         59      6    90%   114-118, 133-135
invenio_rdm_records/oaiserver/__init__.py                                                           0      0   100%
invenio_rdm_records/oaiserver/resources/__init__.py                                                 0      0   100%
invenio_rdm_records/oaiserver/resources/config.py                                                  19      0   100%
invenio_rdm_records/oaiserver/resources/resources.py                                               46      0   100%
invenio_rdm_records/oaiserver/services/__init__.py                                                  0      0   100%
invenio_rdm_records/oaiserver/services/config.py                                                   28      0   100%
invenio_rdm_records/oaiserver/services/errors.py                                                   17      1    94%   42
invenio_rdm_records/oaiserver/services/permissions.py                                               9      0   100%
invenio_rdm_records/oaiserver/services/results.py                                                  59      3    95%   37, 86, 90
invenio_rdm_records/oaiserver/services/schema.py                                                   18      0   100%
invenio_rdm_records/oaiserver/services/services.py                                                115      7    94%   43-45, 51-53, 166
invenio_rdm_records/oaiserver/services/uow.py                                                      14      0   100%
invenio_rdm_records/proxies.py                                                                     14      0   100%
invenio_rdm_records/records/__init__.py                                                             2      0   100%
invenio_rdm_records/records/api.py                                                                137      3    98%   357-361
invenio_rdm_records/records/dumpers/__init__.py                                                     8      0   100%
invenio_rdm_records/records/dumpers/access.py                                                      22      2    91%   50-51
invenio_rdm_records/records/dumpers/combined_subjects.py                                           21      0   100%
invenio_rdm_records/records/dumpers/edtf.py                                                        50      0   100%
invenio_rdm_records/records/dumpers/locations.py                                                   24      0   100%
invenio_rdm_records/records/dumpers/pids.py                                                        17      0   100%
invenio_rdm_records/records/dumpers/statistics.py                                                  21      2    90%   48-49
invenio_rdm_records/records/dumpers/subject_hierarchy.py                                           31     16    48%   71-88, 93-97
invenio_rdm_records/records/jsonschemas/__init__.py                                                 0      0   100%
invenio_rdm_records/records/mappings/__init__.py                                                    0      0   100%
invenio_rdm_records/records/mappings/os-v1/__init__.py                                              0      0   100%
invenio_rdm_records/records/mappings/os-v2/__init__.py                                              0      0   100%
invenio_rdm_records/records/mappings/v7/__init__.py                                                 0      0   100%
invenio_rdm_records/records/models.py                                                              84      1    99%   144
invenio_rdm_records/records/processors/base.py                                                      8      3    62%   16, 20, 25
invenio_rdm_records/records/processors/tiles.py                                                    74     53    28%   27, 47, 52, 57-59, 63-82, 92-142, 152-183
invenio_rdm_records/records/stats/__init__.py                                                       2      0   100%
invenio_rdm_records/records/stats/api.py                                                           25      3    88%   25, 32, 48
invenio_rdm_records/records/stats/templates/__init__.py                                             0      0   100%
invenio_rdm_records/records/stats/templates/aggregations/__init__.py                                0      0   100%
invenio_rdm_records/records/stats/templates/aggregations/aggr_file_download/__init__.py             0      0   100%
invenio_rdm_records/records/stats/templates/aggregations/aggr_file_download/os-v1/__init__.py       0      0   100%
invenio_rdm_records/records/stats/templates/aggregations/aggr_file_download/os-v2/__init__.py       0      0   100%
invenio_rdm_records/records/stats/templates/aggregations/aggr_file_download/v7/__init__.py          0      0   100%
invenio_rdm_records/records/stats/templates/aggregations/aggr_record_view/__init__.py               0      0   100%
invenio_rdm_records/records/stats/templates/aggregations/aggr_record_view/os-v1/__init__.py         0      0   100%
invenio_rdm_records/records/stats/templates/aggregations/aggr_record_view/os-v2/__init__.py         0      0   100%
invenio_rdm_records/records/stats/templates/aggregations/aggr_record_view/v7/__init__.py            0      0   100%
invenio_rdm_records/records/stats/templates/events/__init__.py                                      0      0   100%
invenio_rdm_records/records/stats/templates/events/file_download/__init__.py                        0      0   100%
invenio_rdm_records/records/stats/templates/events/file_download/os-v1/__init__.py                  0      0   100%
invenio_rdm_records/records/stats/templates/events/file_download/os-v2/__init__.py                  0      0   100%
invenio_rdm_records/records/stats/templates/events/file_download/v7/__init__.py                     0      0   100%
invenio_rdm_records/records/stats/templates/events/record_view/__init__.py                          0      0   100%
invenio_rdm_records/records/stats/templates/events/record_view/os-v1/__init__.py                    0      0   100%
invenio_rdm_records/records/stats/templates/events/record_view/os-v2/__init__.py                    0      0   100%
invenio_rdm_records/records/stats/templates/events/record_view/v7/__init__.py                       0      0   100%
invenio_rdm_records/records/systemfields/__init__.py                                                8      0   100%
invenio_rdm_records/records/systemfields/access/__init__.py                                         8      0   100%
invenio_rdm_records/records/systemfields/access/access_settings.py                                 10      1    90%   33
invenio_rdm_records/records/systemfields/access/embargo.py                                         61      9    85%   21, 76-81, 88, 98, 108, 119
invenio_rdm_records/records/systemfields/access/field/__init__.py                                   3      0   100%
invenio_rdm_records/records/systemfields/access/field/parent.py                                   112     20    82%   71, 91, 106-111, 151-152, 157-158, 162-163, 176, 211-218, 231
invenio_rdm_records/records/systemfields/access/field/record.py                                   103      5    95%   127-128, 146, 152-154
invenio_rdm_records/records/systemfields/access/grants.py                                         124     14    89%   48-50, 58, 80, 100, 125, 196, 233, 238, 248, 252, 281-282
invenio_rdm_records/records/systemfields/access/links.py                                           61     13    79%   30, 42, 48, 53, 59, 63, 67, 78, 94-95, 99-102
invenio_rdm_records/records/systemfields/access/owners.py                                          50     10    80%   33, 41, 65, 78, 82-85, 89, 93, 97
invenio_rdm_records/records/systemfields/access/protection.py                                      44      5    89%   63-64, 74, 82, 88
invenio_rdm_records/records/systemfields/deletion_status.py                                        61      4    93%   58, 62, 71, 79
invenio_rdm_records/records/systemfields/draft_status.py                                           28      3    89%   80-89
invenio_rdm_records/records/systemfields/has_draftcheck.py                                         21      0   100%
invenio_rdm_records/records/systemfields/is_verified.py                                            12      0   100%
invenio_rdm_records/records/systemfields/statistics.py                                             27      2    93%   36-37
invenio_rdm_records/records/systemfields/tombstone.py                                             126      8    94%   45, 135, 166, 175, 181, 223, 229-230
invenio_rdm_records/requests/__init__.py                                                            5      0   100%
invenio_rdm_records/requests/access/__init__.py                                                     4      0   100%
invenio_rdm_records/requests/access/models.py                                                      49      3    94%   82, 87, 122
invenio_rdm_records/requests/access/permissions.py                                                  4      0   100%
invenio_rdm_records/requests/access/requests.py                                                   115     18    84%   63-71, 79-85, 93-102, 110-115, 166, 316-323
invenio_rdm_records/requests/access/tasks.py                                                        8      2    75%   21-24
invenio_rdm_records/requests/base.py                                                                3      0   100%
invenio_rdm_records/requests/community_inclusion.py                                                51      2    96%   72, 132
invenio_rdm_records/requests/community_submission.py                                               70      2    97%   75, 217
invenio_rdm_records/requests/decorators.py                                                         20      0   100%
invenio_rdm_records/requests/entity_resolvers.py                                                   91      6    93%   65, 165, 169-170, 178, 210
invenio_rdm_records/requests/record_deletion.py                                                    73      5    93%   71, 119-125, 178
invenio_rdm_records/requests/user_moderation/__init__.py                                            2      0   100%
invenio_rdm_records/requests/user_moderation/actions.py                                            28      6    79%   42-43, 67-74
invenio_rdm_records/requests/user_moderation/tasks.py                                              33     13    61%   29, 37, 43-54, 64-66, 72-76
invenio_rdm_records/requests/user_moderation/utils.py                                              20      4    80%   44-47
invenio_rdm_records/resources/__init__.py                                                           4      0   100%
invenio_rdm_records/resources/args.py                                                               8      0   100%
invenio_rdm_records/resources/config.py                                                           131      0   100%
invenio_rdm_records/resources/deserializers/__init__.py                                             2      0   100%
invenio_rdm_records/resources/deserializers/errors.py                                               1      0   100%
invenio_rdm_records/resources/deserializers/rocrate/__init__.py                                    38      0   100%
invenio_rdm_records/resources/deserializers/rocrate/schema.py                                      72      1    99%   138
invenio_rdm_records/resources/errors.py                                                            22      2    91%   48, 53
invenio_rdm_records/resources/iiif.py                                                             165     36    78%   146, 155-157, 201, 210-213, 284, 298, 308, 328, 342-344, 353, 357-372, 387-401
invenio_rdm_records/resources/resources.py                                                        333     31    91%   51, 109-113, 124-131, 150-155, 170, 179-185, 192-198, 246-252, 261-266, 361-366, 495-503, 555, 616-622, 647-655, 663-671, 676-681, 689-694
invenio_rdm_records/resources/serializers/__init__.py                                              16      0   100%
invenio_rdm_records/resources/serializers/bibtex/__init__.py                                        9      0   100%
invenio_rdm_records/resources/serializers/bibtex/schema.py                                        163     11    93%   93, 97-98, 104, 297-301, 319, 334
invenio_rdm_records/resources/serializers/bibtex/schema_formats.py                                 27      0   100%
invenio_rdm_records/resources/serializers/cff/__init__.py                                           8      0   100%
invenio_rdm_records/resources/serializers/cff/schema.py                                           147     18    88%   29, 51-58, 106, 120-126, 220, 242
invenio_rdm_records/resources/serializers/codemeta/__init__.py                                      7      1    86%   22
invenio_rdm_records/resources/serializers/codemeta/schema.py                                       34     22    35%   32-53, 57-67
invenio_rdm_records/resources/serializers/csl/__init__.py                                          53      0   100%
invenio_rdm_records/resources/serializers/csl/schema.py                                            75      5    93%   87-88, 103, 117, 126
invenio_rdm_records/resources/serializers/csv/__init__.py                                           4      0   100%
invenio_rdm_records/resources/serializers/datacite/__init__.py                                     19      0   100%
invenio_rdm_records/resources/serializers/datacite/schema.py                                      587     38    94%   119-120, 134, 165, 274-279, 291, 412-427, 436, 459-463, 547-548, 580, 624-632, 757-762, 774, 1020-1021, 1053, 1099-1100
invenio_rdm_records/resources/serializers/datapackage/__init__.py                                   6      0   100%
invenio_rdm_records/resources/serializers/datapackage/schema.py                                    65      0   100%
invenio_rdm_records/resources/serializers/dcat/__init__.py                                        105     13    88%   106-117, 134, 145, 155, 191-199
invenio_rdm_records/resources/serializers/dcat/schema.py                                           45      3    93%   76-77, 93
invenio_rdm_records/resources/serializers/dublincore/__init__.py                                   12      0   100%
invenio_rdm_records/resources/serializers/dublincore/schema.py                                    115      2    98%   71, 96
invenio_rdm_records/resources/serializers/errors.py                                                 2      0   100%
invenio_rdm_records/resources/serializers/geojson/__init__.py                                       6      0   100%
invenio_rdm_records/resources/serializers/geojson/schema.py                                        12      0   100%
invenio_rdm_records/resources/serializers/iiif/__init__.py                                         15      0   100%
invenio_rdm_records/resources/serializers/iiif/schema.py                                           76      0   100%
invenio_rdm_records/resources/serializers/marcxml/__init__.py                                      13      0   100%
invenio_rdm_records/resources/serializers/marcxml/schema.py                                       291     12    96%   163-170, 186-190, 277, 292, 372
invenio_rdm_records/resources/serializers/schemaorg/__init__.py                                     7      0   100%
invenio_rdm_records/resources/serializers/schemaorg/schema.py                                     269     42    84%   39-55, 77, 80, 121, 144, 250-251, 280, 297, 336, 367, 382, 446-447, 468-478, 485-497, 527
invenio_rdm_records/resources/serializers/schemas.py                                               51      6    88%   27-28, 68-72
invenio_rdm_records/resources/serializers/signposting/__init__.py                                  19      0   100%
invenio_rdm_records/resources/serializers/signposting/schema.py                                    94      1    99%   45
invenio_rdm_records/resources/serializers/ui/__init__.py                                            6      0   100%
invenio_rdm_records/resources/serializers/ui/fields.py                                             48      3    94%   73-88
invenio_rdm_records/resources/serializers/ui/schema.py                                            250     79    68%   46, 118, 221-254, 258-278, 282-297, 312-314, 317-318, 321-322, 327, 352-353, 434-446, 455-461
invenio_rdm_records/resources/serializers/utils.py                                                 29      2    93%   58, 67
invenio_rdm_records/resources/stats/__init__.py                                                     2      0   100%
invenio_rdm_records/resources/stats/event_builders.py                                              34     26    24%   33-54, 63-87, 96-104, 109-112, 120-122
invenio_rdm_records/secret_links/__init__.py                                                        3      0   100%
invenio_rdm_records/secret_links/errors.py                                                          5      1    80%   22
invenio_rdm_records/secret_links/models.py                                                         84      3    96%   86, 117, 121
invenio_rdm_records/secret_links/permissions.py                                                     4      0   100%
invenio_rdm_records/secret_links/serializers.py                                                    41      1    98%   75
invenio_rdm_records/secret_links/signals.py                                                         6      0   100%
invenio_rdm_records/services/__init__.py                                                            8      0   100%
invenio_rdm_records/services/access/__init__.py                                                     2      0   100%
invenio_rdm_records/services/access/service.py                                                    358     63    82%   99, 137, 182, 203, 217-218, 301, 345, 379, 383-386, 420, 431, 460-478, 497-546, 569, 582-605, 625, 631, 663, 674, 763, 767, 780, 837-852, 958-959
invenio_rdm_records/services/communities/__init__.py                                                2      0   100%
invenio_rdm_records/services/communities/components.py                                             24      0   100%
invenio_rdm_records/services/communities/moderation.py                                             40      5    88%   23, 27, 31, 48, 54
invenio_rdm_records/services/communities/service.py                                               178      7    96%   72, 89, 307-308, 314, 378, 479
invenio_rdm_records/services/community_inclusion/__init__.py                                        2      0   100%
invenio_rdm_records/services/community_inclusion/service.py                                        28      2    93%   45, 59
invenio_rdm_records/services/community_records/__init__.py                                          2      0   100%
invenio_rdm_records/services/community_records/service.py                                          51      4    92%   83-84, 141-142
invenio_rdm_records/services/components/__init__.py                                                14      0   100%
invenio_rdm_records/services/components/access.py                                                  36      0   100%
invenio_rdm_records/services/components/custom_fields.py                                            4      0   100%
invenio_rdm_records/services/components/files.py                                                   10      0   100%
invenio_rdm_records/services/components/internal_notes.py                                          34      1    97%   66
invenio_rdm_records/services/components/metadata.py                                                18      0   100%
invenio_rdm_records/services/components/pids.py                                                   138      0   100%
invenio_rdm_records/services/components/record_deletion.py                                         30      1    97%   53
invenio_rdm_records/services/components/record_files.py                                             8      0   100%
invenio_rdm_records/services/components/review.py                                                  23      0   100%
invenio_rdm_records/services/components/signal.py                                                   6      0   100%
invenio_rdm_records/services/components/verified.py                                                48      2    96%   41, 47
invenio_rdm_records/services/config.py                                                            254      3    99%   295, 315-316
invenio_rdm_records/services/customizations.py                                                     31      0   100%
invenio_rdm_records/services/decorators.py                                                         13      1    92%   27
invenio_rdm_records/services/deletion_policy.py                                                    76     10    87%   28, 32, 129, 152-159
invenio_rdm_records/services/dummy.py                                                              10      3    70%   16, 32, 36
invenio_rdm_records/services/errors.py                                                             68      6    91%   53, 179, 191, 196-202
invenio_rdm_records/services/facets.py                                                             21      1    95%   98
invenio_rdm_records/services/files/__init__.py                                                      2      0   100%
invenio_rdm_records/services/files/service.py                                                      14      0   100%
invenio_rdm_records/services/generators.py                                                        215     17    92%   62, 75-80, 96, 112, 140, 173, 177, 248, 261, 289, 302, 328, 417
invenio_rdm_records/services/github/__init__.py                                                     0      0   100%
invenio_rdm_records/services/github/metadata.py                                                    83     56    33%   22, 27-29, 41-46, 55-59, 66-68, 84-91, 103-125, 130-143, 148, 152, 156-168, 172-183
invenio_rdm_records/services/github/release.py                                                    116     85    27%   28-30, 41-73, 77-80, 85-92, 96-102, 107-119, 142-208, 217-224, 228, 236-238, 243-244, 249-250
invenio_rdm_records/services/github/utils.py                                                        4      2    50%   17-22
invenio_rdm_records/services/iiif/__init__.py                                                       2      0   100%
invenio_rdm_records/services/iiif/converter.py                                                     63     45    29%   15, 19-21, 31, 36, 44, 61-73, 79-103, 107-119
invenio_rdm_records/services/iiif/service.py                                                       74     26    65%   23-25, 30, 34-36, 91-116, 128
invenio_rdm_records/services/iiif/storage.py                                                       69     40    42%   33-38, 42, 46, 50, 69-75, 79-92, 99, 104-118, 122, 135, 139-152
invenio_rdm_records/services/iiif/tasks.py                                                         31     23    26%   21-34, 44-60
invenio_rdm_records/services/permissions.py                                                        97      0   100%
invenio_rdm_records/services/pids/__init__.py                                                       3      0   100%
invenio_rdm_records/services/pids/errors.py                                                         8      1    88%   31
invenio_rdm_records/services/pids/manager.py                                                      142      8    94%   36-37, 83, 168, 203, 229, 276-277
invenio_rdm_records/services/pids/providers/__init__.py                                             5      0   100%
invenio_rdm_records/services/pids/providers/base.py                                                80      8    90%   41, 46, 85, 102-106, 119
invenio_rdm_records/services/pids/providers/datacite.py                                           145     22    85%   57, 70, 167, 173, 180-186, 212-218, 221, 229-231, 245-251, 296-297
invenio_rdm_records/services/pids/providers/external.py                                            46      2    96%   36, 69
invenio_rdm_records/services/pids/providers/oai.py                                                 15      0   100%
invenio_rdm_records/services/pids/service.py                                                      103     15    85%   84-85, 88, 92-93, 125-131, 143-150, 272
invenio_rdm_records/services/pids/tasks.py                                                          6      0   100%
invenio_rdm_records/services/queryparser.py                                                         5      3    40%   14-16
invenio_rdm_records/services/requests/__init__.py                                                   2      0   100%
invenio_rdm_records/services/requests/service.py                                                   14      7    50%   25, 38-49
invenio_rdm_records/services/result_items.py                                                      100     16    84%   23-25, 49, 68, 89, 146, 154-156, 164, 193, 214-217
invenio_rdm_records/services/results.py                                                            57     20    65%   33, 37, 41, 45, 58, 62, 66-75, 79, 123-124, 128-137, 141
invenio_rdm_records/services/review/__init__.py                                                     2      0   100%
invenio_rdm_records/services/review/links.py                                                        5      0   100%
invenio_rdm_records/services/review/service.py                                                     95      3    97%   65, 136, 162
invenio_rdm_records/services/schemas/__init__.py                                                    4      0   100%
invenio_rdm_records/services/schemas/access.py                                                     40      1    98%   77
invenio_rdm_records/services/schemas/community_records.py                                          20      2    90%   46, 50
invenio_rdm_records/services/schemas/files.py                                                      52      0   100%
invenio_rdm_records/services/schemas/metadata.py                                                  178      8    96%   142, 209-213, 250, 254
invenio_rdm_records/services/schemas/parent/__init__.py                                            37      2    95%   26-27
invenio_rdm_records/services/schemas/parent/access.py                                              43      0   100%
invenio_rdm_records/services/schemas/parent/communities.py                                          9      0   100%
invenio_rdm_records/services/schemas/pids.py                                                        6      0   100%
invenio_rdm_records/services/schemas/quota.py                                                       6      0   100%
invenio_rdm_records/services/schemas/record.py                                                     68      2    97%   44, 114
invenio_rdm_records/services/schemas/record_communities.py                                         23      0   100%
invenio_rdm_records/services/schemas/stats.py                                                      10      0   100%
invenio_rdm_records/services/schemas/tombstone.py                                                  21      0   100%
invenio_rdm_records/services/schemas/utils.py                                                      17     13    24%   22-38
invenio_rdm_records/services/schemas/versions.py                                                    4      0   100%
invenio_rdm_records/services/search_params.py                                                      45      5    89%   108-112
invenio_rdm_records/services/services.py                                                          289     53    82%   137, 206, 231, 239, 245, 315-342, 354-359, 384, 392, 462-466, 552, 589-590, 595, 642, 657-658, 690, 711-715, 750, 785, 794, 802-807, 814-828
invenio_rdm_records/services/signals/__init__.py                                                    2      0   100%
invenio_rdm_records/services/signals/signals.py                                                     4      0   100%
invenio_rdm_records/services/sort.py                                                                8      0   100%
invenio_rdm_records/services/stats/__init__.py                                                      2      0   100%
invenio_rdm_records/services/stats/permissions.py                                                  16      8    50%   21-23, 37, 41, 53-56
invenio_rdm_records/services/tasks.py                                                              54     23    57%   54-56, 63-93
invenio_rdm_records/tokens/__init__.py                                                              3      0   100%
invenio_rdm_records/tokens/errors.py                                                               18      0   100%
invenio_rdm_records/tokens/permissions.py                                                           5      0   100%
invenio_rdm_records/tokens/resource_access.py                                                      40      4    90%   44-45, 78, 89
invenio_rdm_records/tokens/scopes.py                                                                4      0   100%
invenio_rdm_records/utils.py                                                                       90     19    79%   34-54, 76, 114-119, 140-143, 146, 152-153
invenio_rdm_records/views.py                                                                       50      4    92%   76-77, 112-118
invenio_rdm_records/webpack.py                                                                      2      0   100%
TOTAL                                                                                           12232   1813    85%
======== 2052 passed, 17 skipped, 65874 warnings in 1380.24s (0:23:00) =========
 Container docker_services_cli-rabbitmq-1  Stopping
 Container docker_services_cli-redis-1  Stopping
 Container docker_services_cli-postgresql-1  Stopping
 Container docker_services_cli-opensearch-1  Stopping
 Container docker_services_cli-redis-1  Stopped
 Container docker_services_cli-redis-1  Removing
 Container docker_services_cli-redis-1  Removed
 Container docker_services_cli-postgresql-1  Stopped
 Container docker_services_cli-postgresql-1  Removing
 Container docker_services_cli-postgresql-1  Removed
 Container docker_services_cli-opensearch-1  Stopped
 Container docker_services_cli-opensearch-1  Removing
 Container docker_services_cli-opensearch-1  Removed
 Container docker_services_cli-rabbitmq-1  Stopped
 Container docker_services_cli-rabbitmq-1  Removing
 Container docker_services_cli-rabbitmq-1  Removed
 Network docker_services_cli_default  Removing
 Network docker_services_cli_default  Removed
