<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="7" skipped="0" tests="933" time="230.279" timestamp="2025-11-18T12:42:49.318402+00:00" hostname="runnervmg1sw1"><testcase classname="tests.conftest" name="PYDOCSTYLE" time="0.030" /><testcase classname="tests.conftest" name="ISORT" time="0.182" /><testcase classname="tests.conftest" name="black" time="0.405" /><testcase classname="tests.contrib.affiliations.conftest" name="PYDOCSTYLE" time="0.008" /><testcase classname="tests.contrib.affiliations.conftest" name="ISORT" time="0.016" /><testcase classname="tests.contrib.affiliations.conftest" name="black" time="0.179" /><testcase classname="tests.contrib.affiliations.test_affiliations_api" name="ISORT" time="0.023" /><testcase classname="tests.contrib.affiliations.test_affiliations_api" name="black" time="0.188" /><testcase classname="tests.contrib.affiliations.test_affiliations_api" name="test_affiliation_schema_validation" time="3.599" /><testcase classname="tests.contrib.affiliations.test_affiliations_api" name="test_affiliation_indexing" time="0.089" /><testcase classname="tests.contrib.affiliations.test_affiliations_api" name="test_affiliation_pid" time="0.459" /><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="ISORT" time="0.070" /><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="black" time="0.244" /><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_ror_transformer" time="2.346" /><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_affiliations_service_writer_create" time="1.723" /><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_affiliations_service_writer_duplicate" time="1.602" /><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_affiliations_service_writer_update_existing" time="1.553"><failure message="jsonschema.exceptions.ValidationError: Additional properties are not allowed ('pid' was unexpected)&#10;&#10;Failed validating 'additionalProperties' in schema:&#10;    {'$schema': 'http://json-schema.org/draft-07/schema#',&#10;     '$id': 'local://affiliations/affiliation-v1.0.0.json',&#10;     'type': 'object',&#10;     'additionalProperties': False,&#10;     'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'},&#10;                    'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'},&#10;                    'country': {'type': 'string',&#10;                                'description': &quot;Represents a affiliation's &quot;&#10;                                               'country as a country '&#10;                                               'code.'},&#10;                    'country_name': {'type': 'string',&#10;                                     'description': 'Represents a '&#10;                                                    &quot;affiliation's country &quot;&#10;                                                    'as a full name.'},&#10;                    'location_name': {'type': 'string',&#10;                                      'description': 'Represents a '&#10;                                                     &quot;affiliation's &quot;&#10;                                                     'location name '&#10;                                                     '(usually a city).'},&#10;                    'acronym': {'type': 'string'},&#10;                    'identifiers': {'description': 'Alternate identifiers '&#10;                                                   'for the record.',&#10;                                    'type': 'array',&#10;                                    'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'},&#10;                                    'uniqueItems': True},&#10;                    'status': {'type': 'string',&#10;                               'description': 'Status of the affiliation '&#10;                                              'organization.'},&#10;                    'aliases': {'description': 'Alternate names for the '&#10;                                               'affiliation.',&#10;                                'type': 'array',&#10;                                'items': {'type': 'string'},&#10;                                'uniqueItems': True},&#10;                    'types': {'description': 'Types of affiliation '&#10;                                             'organization.',&#10;                              'type': 'array',&#10;                              'items': {'type': 'string'},&#10;                              'uniqueItems': True},&#10;                    'name': {'type': 'string'},&#10;                    'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}&#10;&#10;On instance:&#10;    {'name': 'Updated Name',&#10;     'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},&#10;     'types': ['facility', 'funder'],&#10;     'status': 'active',&#10;     '$schema': 'local://affiliations/affiliation-v1.0.0.json',&#10;     'acronym': 'CERN',&#10;     'country': 'CH',&#10;     'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],&#10;     'country_name': 'Switzerland',&#10;     'location_name': 'Geneva',&#10;     'pid': '01ggx4157'}">app = &lt;Flask 'invenio'&gt;
search_clear = &lt;OpenSearch([{'host': 'localhost', 'port': 9200}])&gt;
affiliation_full_data = {'acronym': 'CERN', 'country': 'CH', 'country_name': 'Switzerland', 'id': '01ggx4157', ...}
service = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;

    def test_affiliations_service_writer_update_existing(
        app, search_clear, affiliation_full_data, service
    ):
        """Test updating an existing affiliation using AffiliationsServiceWriter."""
        # create vocabulary
        writer = AffiliationsServiceWriter(update=True)
        orig_affiliation_rec = writer.write(stream_entry=StreamEntry(affiliation_full_data))
        Affiliation.index.refresh()  # refresh index to make changes live
        # update vocabulary
        updated_affiliation = deepcopy(affiliation_full_data)
        updated_affiliation["name"] = "Updated Name"
    
        # check changes vocabulary
&gt;       _ = writer.write(stream_entry=StreamEntry(updated_affiliation))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

affiliation_full_data = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
app        = &lt;Flask 'invenio'&gt;
orig_affiliation_rec = &lt;invenio_vocabularies.datastreams.datastreams.StreamEntry object at 0x7f47ec134ad0&gt;
search_clear = &lt;OpenSearch([{'host': 'localhost', 'port': 9200}])&gt;
service    = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
updated_affiliation = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
writer     = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec1a93d0&gt;

tests/contrib/affiliations/test_affiliations_datastreams.py:145: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
invenio_vocabularies/datastreams/writers.py:115: in write
    return self._do_update(entry)
           ^^^^^^^^^^^^^^^^^^^^^^
        args       = ()
        entry      = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        kwargs     = {}
        self       = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec1a93d0&gt;
        stream_entry = &lt;invenio_vocabularies.datastreams.datastreams.StreamEntry object at 0x7f47ec2e1610&gt;
invenio_vocabularies/datastreams/writers.py:97: in _do_update
    self._service.update(self._identity, vocab_id, updated), op_type="update"
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        current    = &lt;invenio_records_resources.services.records.results.RecordItem object at 0x7f47ec10a7e0&gt;
        entry      = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        self       = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec1a93d0&gt;
        updated    = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'created': '2025-11-18T12:43:05.555924+00:00',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'links': {'self': 'https://127.0.0.1:5000/api/affiliations/01ggx4157'},
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'revision_id': 2,
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder'],
 'updated': '2025-11-18T12:43:05.562639+00:00'}
        vocab_id   = '01ggx4157'
.venv/lib/python3.12/site-packages/invenio_db/uow.py:251: in inner
    res = f(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (&lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;,
 '01ggx4157',
 {'acronym': 'CERN',
  'country': 'CH',
  'country_name': 'Switzerland',
  'created': '2025-11-18T12:43:05.555924+00:00',
  'id': '01ggx4157',
  'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
  'links': {'self': 'https://127.0.0.1:5000/api/affiliations/01ggx4157'},
  'location_name': 'Geneva',
  'name': 'Updated Name',
  'revision_id': 2,
  'status': 'active',
  'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
  'types': ['facility', 'funder'],
  'updated': '2025-11-18T12:43:05.562639+00:00'})
        f          = &lt;function RecordService.update at 0x7f47ef60f6a0&gt;
        kwargs     = {'uow': &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec1a9580&gt;}
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec1a9580&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/service.py:495: in update
    uow.register(RecordCommitOp(record, self.indexer))
        _          = []
        data       = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        expand     = False
        id_        = '01ggx4157'
        identity   = &lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;
        record     = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        revision_id = None
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec1a9580&gt;
.venv/lib/python3.12/site-packages/invenio_db/uow.py:224: in register
    op.on_register(self)
        op         = &lt;invenio_records_resources.services.uow.RecordCommitOp object at 0x7f47ec0217c0&gt;
        self       = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec1a9580&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/uow.py:136: in on_register
    self._record.commit()
        self       = &lt;invenio_records_resources.services.uow.RecordCommitOp object at 0x7f47ec0217c0&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec1a9580&gt;
.venv/lib/python3.12/site-packages/invenio_records/api.py:454: in commit
    json = self._validate(format_checker=format_checker, validator=validator)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        e          = &lt;invenio_records.systemfields.base.SystemFieldsExt object at 0x7f47ee56c470&gt;
        format_checker = None
        kwargs     = {}
        self       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        validator  = None
.venv/lib/python3.12/site-packages/invenio_records/api.py:194: in _validate
    _records_state.validate(
        format_checker = None
        json       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        self       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        use_model  = False
        validator  = None
.venv/lib/python3.12/site-packages/invenio_records/ext.py:67: in validate
    return validate(data, schema, cls=validator_cls, resolver=resolver, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        kwargs     = {'format_checker': None}
        refresolver_cls_kwargs = {'store': {'local://affiliations/affiliation-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://affiliations/affiliation-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'country': {'type': 'string', 'description': "Represents a affiliation's country as a country code."}, 'country_name': {'type': 'string', 'description': "Represents a affiliation's country as a full name."}, 'location_name': {'type': 'string', 'description': "Represents a affiliation's location name (usually a city)."}, 'acronym': {'type': 'string'}, 'identifiers': {'description': 'Alternate identifiers for the record.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'status': {'type': 'string', 'description': 'Status of the affiliation organization.'}, 'aliases': {'description': 'Alternate names for the affiliation.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'types': {'description': 'Types of affiliation organization.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'name': {'type': 'string'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}, 'local://awards/award-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://awards/award-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'identifiers': {'description': 'Alternate identifiers for the award.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'number': {'type': 'string'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'funder': {'description': "Award's funder.", 'type': 'object', 'additionalProperties': False, 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}}}, 'acronym': {'type': 'string'}, 'program': {'type': 'string'}, 'start_date': {'type': 'string'}, 'end_date': {'type': 'string'}, 'description': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/description'}, 'subjects': {'description': "Award's subjects.", 'type': 'array', 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'subject': {'description': 'Human readable label.', 'type': 'string'}}}, 'organizations': {'description': "Award's organizations.", 'type': 'array', 'items': {'type': 'object', 'additionalProperties': False, 'properties': {'scheme': {'description': 'Identifier of the organization scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'id': {'description': 'Identifier of the organization for the given scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'organization': {'description': 'Human readable label.', 'type': 'string'}}}}}}, 'local://funders/funder-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://funders/funder-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'country': {'type': 'string', 'description': "Represents a funder's origin country as a country code."}, 'country_name': {'type': 'string', 'description': "Represents a funder's origin country as a full name."}, 'location_name': {'type': 'string', 'description': "Represents a funder's location name (usually a city)."}, 'identifiers': {'description': 'Alternate identifiers for the record.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'name': {'type': 'string', 'description': 'Funders name.'}, 'acronym': {'type': 'string', 'description': 'Acronym for funders name.'}, 'status': {'type': 'string', 'description': 'Status of the funder.'}, 'aliases': {'description': 'Alternate names for the funder.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'types': {'description': 'Types of funders.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}, 'local://vocabularies/definitions-v1.0.0.json': {'title': {'type': 'object', 'description': 'Title of vocabulary item. Keys are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'description': {'type': 'object', 'description': 'Description of vocabulary item. Keys are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'icon': {'type': 'string'}, 'tags': {'type': 'array', 'description': 'Tags for a vocabulary item.', 'items': {'type': 'string'}}}, 'local://vocabularies/vocabulary-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://vocabularies/vocabulary-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'description': {'type': 'object', 'description': 'Description of vocabulary item. Key are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'icon': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/icon'}, 'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'pid': {'$ref': 'local://definitions-v1.0.0.json#/internal-pid'}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'type': 'string'}}}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'type': {'type': 'object', 'additionalProperties': False, 'properties': {'id': {'type': 'string'}, 'pid_type': {'type': 'string'}}}}}, 'local://names/name-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://names/name-v1.0.0.json', 'description': 'Names vocabulary.', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'scheme': {'description': 'Identifier of the name scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}, 'given_name': {'type': 'string'}, 'family_name': {'type': 'string'}, 'identifiers': {'description': 'Identifiers for the person.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'}, {'type': 'boolean'}]}}}, 'affiliations': {'description': 'Affiliations of the person.', 'type': 'array', 'items': {'type': 'object', 'additionalProperties': False, 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}}}, 'uniqueItems': True}}}, 'local://subjects/subject-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://subjects/subject-v1.0.0.json', 'description': 'Subjects from specific vocabularies.', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'id': {'description': 'URI or classification code as identifier - globally unique among all subject schemes.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'pid': {'$ref': 'local://definitions-v1.0.0.json#/internal-pid'}, 'scheme': {'description': 'Identifier of the subject scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'subject': {'description': 'Human readable label.', 'type': 'string'}, 'title': {'description': 'Human readable label in different languages.', '$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'}, {'type': 'array', 'items': {'type': 'string'}}]}}, 'additionalProperties': False}, 'identifiers': {'description': 'Alternate identifiers for the subject.', 'type': 'array', 'items': {'$ref': 'local://definitions-v2.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'synonyms': {'description': 'Synonyms of the subject label.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}}}, 'local://definitions-v2.0.0.json': {'$schema': {'type': 'string'}, 'entity_reference': {'description': 'Reference to an entity, with the type as key and ID as value', 'type': ['object', 'null'], 'additionalProperties': False, 'patternProperties': {'^[a-z_]+$': {'type': 'string'}}}, 'identifier': {'description': 'An identifier.', 'type': 'string'}, 'identifiers_with_scheme': {'description': 'Identifiers object with identifier value and scheme in separate keys.', 'type': 'object', 'additionalProperties': False, 'properties': {'identifier': {'$ref': '#/identifier'}, 'scheme': {'$ref': '#/scheme'}}}, 'files': {'type': 'object', 'description': 'A file storage for a record.', 'properties': {'enabled': {'description': 'Flag to determine if files are enabled.', 'type': 'boolean'}, 'default_preview': {'description': 'File to preview by default.', 'type': 'string'}, 'order': {'description': 'Order of files.', 'type': 'array', 'items': {'type': 'string'}}, 'count': {'description': 'Number of files.', 'type': 'number'}, 'mimetypes': {'description': 'MIME Types of files.', 'type': 'array', 'items': {'type': 'string'}}, 'totalbytes': {'description': 'Total size of all files.', 'type': 'number'}, 'types': {'description': 'File extensions.', 'type': 'array', 'items': {'type': 'string'}}, 'entries': {'description': 'List of files.', 'type': 'object', 'patternProperties': {'.+': {'$ref': 'local://definitions-v2.0.0.json#/file'}}, 'additionalProperties': False}}}, 'files-simple': {'type': 'object', 'description': 'A file storage for a record.', 'properties': {'enabled': {}, 'default_preview': {}, 'order': {}}}, 'file': {'type': 'object', 'additionalProperties': False, 'description': 'A file object.', 'properties': {'uuid': {'description': 'File record ID.', 'type': 'string'}, 'version_id': {'description': 'File record version ID.', 'type': 'number'}, 'object_version_id': {'description': 'Object version identifier.', 'type': 'string'}, 'file_id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'metadata': {'description': 'File metadata.', 'type': 'object', 'additionalProperties': True}, 'mimetype': {'description': 'File MIMEType.', 'type': 'string'}, 'checksum': {'description': 'Checksum of the file.', 'type': 'string'}, 'ext': {'description': 'Checksum of the file.', 'type': 'string'}, 'size': {'description': 'Size of the file in bytes.', 'type': 'number'}, 'key': {'description': 'Key (filename) of the file.', 'type': 'string'}, 'access': {'description': 'Access properties of the file.', 'type': 'object', 'additionalProperties': False, 'properties': {'hidden': {'description': 'Control whether to hide the file in the UI.', 'type': 'boolean'}}}}}, 'internal-pid': {'type': 'object', 'description': 'An internal persistent identifier object.', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'description': 'Primary key of the PID object.', 'type': 'integer'}, 'status': {'description': 'The status of the PID (from Invenio-PIDStore).', 'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}, 'pid_type': {'description': 'The type of the persistent identifier.', 'type': 'string'}, 'obj_type': {'description': 'The type of the associated object.', 'type': 'string'}}}, 'scheme': {'description': 'A scheme.', 'type': 'string'}}, 'local://definitions-v1.0.0.json': {'$schema': {'type': 'string'}, 'entity_reference': {'description': 'Reference to an entity, with the type as key and ID as value', 'type': ['object', 'null'], 'additionalProperties': False, 'patternProperties': {'^[a-z_]+$': {'type': 'string'}}}, 'identifier': {'description': 'An identifier.', 'type': 'string'}, 'identifiers_with_scheme': {'description': 'Identifiers object with identifier value and scheme in separate keys.', 'type': 'object', 'additionalProperties': False, 'properties': {'identifier': {'$ref': '#/identifier'}, 'scheme': {'$ref': '#/scheme'}}}, 'file': {'type': 'object', 'additionalProperties': False, 'description': 'A file object.', 'properties': {'version_id': {'description': 'Object version ID.', 'type': 'string'}, 'bucket_id': {'description': 'Object verison bucket ID.', 'type': 'string'}, 'mimetype': {'description': 'File MIMEType.', 'type': 'string'}, 'uri': {'description': 'File URI.', 'type': 'string'}, 'storage_class': {'description': 'File storage class.', 'type': 'string'}, 'checksum': {'description': 'Checksum of the file.', 'type': 'string'}, 'size': {'description': 'Size of the file in bytes.', 'type': 'number'}, 'key': {'description': 'Key (filename) of the file.', 'type': 'string'}, 'file_id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}}}, 'internal-pid': {'type': 'object', 'description': 'An internal persistent identifier object.', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'description': 'Primary key of the PID object.', 'type': 'integer'}, 'status': {'description': 'The status of the PID (from Invenio-PIDStore).', 'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}, 'pid_type': {'description': 'The type of the persistent identifier.', 'type': 'string'}, 'obj_type': {'description': 'The type of the associated object.', 'type': 'string'}}}, 'scheme': {'description': 'A scheme.', 'type': 'string'}}, 'local://records/record-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', 'id': 'local://test/records/record-v1.0.0.json', 'title': 'Test Record Schema v1.0.0', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'description': 'JSONSchema declaration.', 'type': 'string'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'id': {'description': 'Persistent record identifier (alphanumeric).', 'type': 'string'}, 'pid': {'type': 'object', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'type': 'integer'}, 'status': {'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}}}, 'metadata': {'type': 'object', 'additionalProperties': False, 'properties': {'title': {'type': 'string'}, 'languages': {'type': 'array', 'items': {'type': 'object', 'properties': {'id': {'type': 'string'}}}}}}}}},
 'urljoin_cache': &lt;functools._lru_cache_wrapper object at 0x7f47ec02e350&gt;}
        resolver   = &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47ec021a90&gt;
        schema     = {'$ref': 'local://affiliations/affiliation-v1.0.0.json'}
        self       = &lt;invenio_records.ext._RecordsState object at 0x7f47ed9983b0&gt;
        validator_cls = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

instance = {'$schema': 'local://affiliations/affiliation-v1.0.0.json', 'acronym': 'CERN', 'country': 'CH', 'country_name': 'Switzerland', ...}
schema = {'$ref': 'local://affiliations/affiliation-v1.0.0.json'}
cls = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;, args = ()
kwargs = {'format_checker': None, 'resolver': &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47ec021a90&gt;}
validator = Draft202012Validator(schema={'$ref': 'local://affi...n-v1.0.0.json'}, format_checker=None)
error = &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;

    def validate(instance, schema, cls=None, *args, **kwargs):  # noqa: D417
        """
        Validate an instance under the given schema.
    
            &gt;&gt;&gt; validate([2, 3, 4], {"maxItems": 2})
            Traceback (most recent call last):
                ...
            ValidationError: [2, 3, 4] is too long
    
        :func:`~jsonschema.validators.validate` will first verify that the
        provided schema is itself valid, since not doing so can lead to less
        obvious error messages and fail in less obvious or consistent ways.
    
        If you know you have a valid schema already, especially
        if you intend to validate multiple instances with
        the same schema, you likely would prefer using the
        `jsonschema.protocols.Validator.validate` method directly on a
        specific validator (e.g. ``Draft202012Validator.validate``).
    
    
        Arguments:
    
            instance:
    
                The instance to validate
    
            schema:
    
                The schema to validate with
    
            cls (jsonschema.protocols.Validator):
    
                The class that will be used to validate the instance.
    
        If the ``cls`` argument is not provided, two things will happen
        in accordance with the specification. First, if the schema has a
        :kw:`$schema` keyword containing a known meta-schema [#]_ then the
        proper validator will be used. The specification recommends that
        all schemas contain :kw:`$schema` properties for this reason. If no
        :kw:`$schema` property is found, the default validator class is the
        latest released draft.
    
        Any other provided positional and keyword arguments will be passed
        on when instantiating the ``cls``.
    
        Raises:
    
            `jsonschema.exceptions.ValidationError`:
    
                if the instance is invalid
    
            `jsonschema.exceptions.SchemaError`:
    
                if the schema itself is invalid
    
        .. rubric:: Footnotes
        .. [#] known by a validator registered with
            `jsonschema.validators.validates`
    
        """
        if cls is None:
            cls = validator_for(schema)
    
        cls.check_schema(schema)
        validator = cls(schema, *args, **kwargs)
        error = exceptions.best_match(validator.iter_errors(instance))
        if error is not None:
&gt;           raise error
E           jsonschema.exceptions.ValidationError: Additional properties are not allowed ('pid' was unexpected)
E           
E           Failed validating 'additionalProperties' in schema:
E               {'$schema': 'http://json-schema.org/draft-07/schema#',
E                '$id': 'local://affiliations/affiliation-v1.0.0.json',
E                'type': 'object',
E                'additionalProperties': False,
E                'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'},
E                               'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'},
E                               'country': {'type': 'string',
E                                           'description': "Represents a affiliation's "
E                                                          'country as a country '
E                                                          'code.'},
E                               'country_name': {'type': 'string',
E                                                'description': 'Represents a '
E                                                               "affiliation's country "
E                                                               'as a full name.'},
E                               'location_name': {'type': 'string',
E                                                 'description': 'Represents a '
E                                                                "affiliation's "
E                                                                'location name '
E                                                                '(usually a city).'},
E                               'acronym': {'type': 'string'},
E                               'identifiers': {'description': 'Alternate identifiers '
E                                                              'for the record.',
E                                               'type': 'array',
E                                               'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'},
E                                               'uniqueItems': True},
E                               'status': {'type': 'string',
E                                          'description': 'Status of the affiliation '
E                                                         'organization.'},
E                               'aliases': {'description': 'Alternate names for the '
E                                                          'affiliation.',
E                                           'type': 'array',
E                                           'items': {'type': 'string'},
E                                           'uniqueItems': True},
E                               'types': {'description': 'Types of affiliation '
E                                                        'organization.',
E                                         'type': 'array',
E                                         'items': {'type': 'string'},
E                                         'uniqueItems': True},
E                               'name': {'type': 'string'},
E                               'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}
E           
E           On instance:
E               {'name': 'Updated Name',
E                'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
E                'types': ['facility', 'funder'],
E                'status': 'active',
E                '$schema': 'local://affiliations/affiliation-v1.0.0.json',
E                'acronym': 'CERN',
E                'country': 'CH',
E                'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
E                'country_name': 'Switzerland',
E                'location_name': 'Geneva',
E                'pid': '01ggx4157'}

args       = ()
cls        = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;
error      = &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;
instance   = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Updated Name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
kwargs     = {'format_checker': None,
 'resolver': &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47ec021a90&gt;}
schema     = {'$ref': 'local://affiliations/affiliation-v1.0.0.json'}
validator  = Draft202012Validator(schema={'$ref': 'local://affi...n-v1.0.0.json'}, format_checker=None)

.venv/lib/python3.12/site-packages/jsonschema/validators.py:1332: ValidationError</failure></testcase><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_affiliations_service_writer_update_non_existing" time="1.409"><failure message="jsonschema.exceptions.ValidationError: Additional properties are not allowed ('pid' was unexpected)&#10;&#10;Failed validating 'additionalProperties' in schema:&#10;    {'$schema': 'http://json-schema.org/draft-07/schema#',&#10;     '$id': 'local://affiliations/affiliation-v1.0.0.json',&#10;     'type': 'object',&#10;     'additionalProperties': False,&#10;     'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'},&#10;                    'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'},&#10;                    'country': {'type': 'string',&#10;                                'description': &quot;Represents a affiliation's &quot;&#10;                                               'country as a country '&#10;                                               'code.'},&#10;                    'country_name': {'type': 'string',&#10;                                     'description': 'Represents a '&#10;                                                    &quot;affiliation's country &quot;&#10;                                                    'as a full name.'},&#10;                    'location_name': {'type': 'string',&#10;                                      'description': 'Represents a '&#10;                                                     &quot;affiliation's &quot;&#10;                                                     'location name '&#10;                                                     '(usually a city).'},&#10;                    'acronym': {'type': 'string'},&#10;                    'identifiers': {'description': 'Alternate identifiers '&#10;                                                   'for the record.',&#10;                                    'type': 'array',&#10;                                    'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'},&#10;                                    'uniqueItems': True},&#10;                    'status': {'type': 'string',&#10;                               'description': 'Status of the affiliation '&#10;                                              'organization.'},&#10;                    'aliases': {'description': 'Alternate names for the '&#10;                                               'affiliation.',&#10;                                'type': 'array',&#10;                                'items': {'type': 'string'},&#10;                                'uniqueItems': True},&#10;                    'types': {'description': 'Types of affiliation '&#10;                                             'organization.',&#10;                              'type': 'array',&#10;                              'items': {'type': 'string'},&#10;                              'uniqueItems': True},&#10;                    'name': {'type': 'string'},&#10;                    'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}&#10;&#10;On instance:&#10;    {'name': 'New name',&#10;     'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},&#10;     'types': ['facility', 'funder'],&#10;     'status': 'active',&#10;     '$schema': 'local://affiliations/affiliation-v1.0.0.json',&#10;     'acronym': 'CERN',&#10;     'country': 'CH',&#10;     'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],&#10;     'country_name': 'Switzerland',&#10;     'location_name': 'Geneva',&#10;     'pid': '01ggx4157'}">app = &lt;Flask 'invenio'&gt;
search_clear = &lt;OpenSearch([{'host': 'localhost', 'port': 9200}])&gt;
affiliation_full_data = {'acronym': 'CERN', 'country': 'CH', 'country_name': 'Switzerland', 'id': '01ggx4157', ...}
service = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;

    def test_affiliations_service_writer_update_non_existing(
        app, search_clear, affiliation_full_data, service
    ):
        """Test creating a new affiliation when updating a non-existing entry."""
        # vocabulary item not created, call update directly
        updated_affiliation = deepcopy(affiliation_full_data)
        updated_affiliation["name"] = "New name"
        # check changes vocabulary
        writer = AffiliationsServiceWriter(update=True)
&gt;       affiliation_rec = writer.write(stream_entry=StreamEntry(updated_affiliation))
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

affiliation_full_data = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
app        = &lt;Flask 'invenio'&gt;
search_clear = &lt;OpenSearch([{'host': 'localhost', 'port': 9200}])&gt;
service    = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
updated_affiliation = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'New name',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
writer     = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec1aa9c0&gt;

tests/contrib/affiliations/test_affiliations_datastreams.py:167: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
invenio_vocabularies/datastreams/writers.py:115: in write
    return self._do_update(entry)
           ^^^^^^^^^^^^^^^^^^^^^^
        args       = ()
        entry      = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'New name',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        kwargs     = {}
        self       = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec1aa9c0&gt;
        stream_entry = &lt;invenio_vocabularies.datastreams.datastreams.StreamEntry object at 0x7f47ec1a8830&gt;
invenio_vocabularies/datastreams/writers.py:97: in _do_update
    self._service.update(self._identity, vocab_id, updated), op_type="update"
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        current    = &lt;invenio_records_resources.services.records.results.RecordItem object at 0x7f47ec1aa2a0&gt;
        entry      = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'New name',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        self       = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec1aa9c0&gt;
        updated    = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'created': '2025-11-18T12:43:05.555924+00:00',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'links': {'self': 'https://127.0.0.1:5000/api/affiliations/01ggx4157'},
 'location_name': 'Geneva',
 'name': 'New name',
 'revision_id': 2,
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder'],
 'updated': '2025-11-18T12:43:05.562639+00:00'}
        vocab_id   = '01ggx4157'
.venv/lib/python3.12/site-packages/invenio_db/uow.py:251: in inner
    res = f(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (&lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;,
 '01ggx4157',
 {'acronym': 'CERN',
  'country': 'CH',
  'country_name': 'Switzerland',
  'created': '2025-11-18T12:43:05.555924+00:00',
  'id': '01ggx4157',
  'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
  'links': {'self': 'https://127.0.0.1:5000/api/affiliations/01ggx4157'},
  'location_name': 'Geneva',
  'name': 'New name',
  'revision_id': 2,
  'status': 'active',
  'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
  'types': ['facility', 'funder'],
  'updated': '2025-11-18T12:43:05.562639+00:00'})
        f          = &lt;function RecordService.update at 0x7f47ef60f6a0&gt;
        kwargs     = {'uow': &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec020350&gt;}
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec020350&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/service.py:495: in update
    uow.register(RecordCommitOp(record, self.indexer))
        _          = []
        data       = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'New name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        expand     = False
        id_        = '01ggx4157'
        identity   = &lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;
        record     = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'New name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        revision_id = None
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec020350&gt;
.venv/lib/python3.12/site-packages/invenio_db/uow.py:224: in register
    op.on_register(self)
        op         = &lt;invenio_records_resources.services.uow.RecordCommitOp object at 0x7f47ec023ef0&gt;
        self       = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec020350&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/uow.py:136: in on_register
    self._record.commit()
        self       = &lt;invenio_records_resources.services.uow.RecordCommitOp object at 0x7f47ec023ef0&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec020350&gt;
.venv/lib/python3.12/site-packages/invenio_records/api.py:454: in commit
    json = self._validate(format_checker=format_checker, validator=validator)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        e          = &lt;invenio_records.systemfields.base.SystemFieldsExt object at 0x7f47ee56c470&gt;
        format_checker = None
        kwargs     = {}
        self       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'New name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        validator  = None
.venv/lib/python3.12/site-packages/invenio_records/api.py:194: in _validate
    _records_state.validate(
        format_checker = None
        json       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'New name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        self       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'New name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        use_model  = False
        validator  = None
.venv/lib/python3.12/site-packages/invenio_records/ext.py:67: in validate
    return validate(data, schema, cls=validator_cls, resolver=resolver, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'New name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        kwargs     = {'format_checker': None}
        refresolver_cls_kwargs = {'store': {'local://affiliations/affiliation-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://affiliations/affiliation-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'country': {'type': 'string', 'description': "Represents a affiliation's country as a country code."}, 'country_name': {'type': 'string', 'description': "Represents a affiliation's country as a full name."}, 'location_name': {'type': 'string', 'description': "Represents a affiliation's location name (usually a city)."}, 'acronym': {'type': 'string'}, 'identifiers': {'description': 'Alternate identifiers for the record.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'status': {'type': 'string', 'description': 'Status of the affiliation organization.'}, 'aliases': {'description': 'Alternate names for the affiliation.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'types': {'description': 'Types of affiliation organization.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'name': {'type': 'string'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}, 'local://awards/award-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://awards/award-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'identifiers': {'description': 'Alternate identifiers for the award.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'number': {'type': 'string'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'funder': {'description': "Award's funder.", 'type': 'object', 'additionalProperties': False, 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}}}, 'acronym': {'type': 'string'}, 'program': {'type': 'string'}, 'start_date': {'type': 'string'}, 'end_date': {'type': 'string'}, 'description': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/description'}, 'subjects': {'description': "Award's subjects.", 'type': 'array', 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'subject': {'description': 'Human readable label.', 'type': 'string'}}}, 'organizations': {'description': "Award's organizations.", 'type': 'array', 'items': {'type': 'object', 'additionalProperties': False, 'properties': {'scheme': {'description': 'Identifier of the organization scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'id': {'description': 'Identifier of the organization for the given scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'organization': {'description': 'Human readable label.', 'type': 'string'}}}}}}, 'local://funders/funder-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://funders/funder-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'country': {'type': 'string', 'description': "Represents a funder's origin country as a country code."}, 'country_name': {'type': 'string', 'description': "Represents a funder's origin country as a full name."}, 'location_name': {'type': 'string', 'description': "Represents a funder's location name (usually a city)."}, 'identifiers': {'description': 'Alternate identifiers for the record.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'name': {'type': 'string', 'description': 'Funders name.'}, 'acronym': {'type': 'string', 'description': 'Acronym for funders name.'}, 'status': {'type': 'string', 'description': 'Status of the funder.'}, 'aliases': {'description': 'Alternate names for the funder.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'types': {'description': 'Types of funders.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}, 'local://vocabularies/definitions-v1.0.0.json': {'title': {'type': 'object', 'description': 'Title of vocabulary item. Keys are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'description': {'type': 'object', 'description': 'Description of vocabulary item. Keys are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'icon': {'type': 'string'}, 'tags': {'type': 'array', 'description': 'Tags for a vocabulary item.', 'items': {'type': 'string'}}}, 'local://vocabularies/vocabulary-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://vocabularies/vocabulary-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'description': {'type': 'object', 'description': 'Description of vocabulary item. Key are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'icon': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/icon'}, 'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'pid': {'$ref': 'local://definitions-v1.0.0.json#/internal-pid'}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'type': 'string'}}}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'type': {'type': 'object', 'additionalProperties': False, 'properties': {'id': {'type': 'string'}, 'pid_type': {'type': 'string'}}}}}, 'local://names/name-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://names/name-v1.0.0.json', 'description': 'Names vocabulary.', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'scheme': {'description': 'Identifier of the name scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}, 'given_name': {'type': 'string'}, 'family_name': {'type': 'string'}, 'identifiers': {'description': 'Identifiers for the person.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'}, {'type': 'boolean'}]}}}, 'affiliations': {'description': 'Affiliations of the person.', 'type': 'array', 'items': {'type': 'object', 'additionalProperties': False, 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}}}, 'uniqueItems': True}}}, 'local://subjects/subject-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://subjects/subject-v1.0.0.json', 'description': 'Subjects from specific vocabularies.', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'id': {'description': 'URI or classification code as identifier - globally unique among all subject schemes.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'pid': {'$ref': 'local://definitions-v1.0.0.json#/internal-pid'}, 'scheme': {'description': 'Identifier of the subject scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'subject': {'description': 'Human readable label.', 'type': 'string'}, 'title': {'description': 'Human readable label in different languages.', '$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'}, {'type': 'array', 'items': {'type': 'string'}}]}}, 'additionalProperties': False}, 'identifiers': {'description': 'Alternate identifiers for the subject.', 'type': 'array', 'items': {'$ref': 'local://definitions-v2.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'synonyms': {'description': 'Synonyms of the subject label.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}}}, 'local://definitions-v2.0.0.json': {'$schema': {'type': 'string'}, 'entity_reference': {'description': 'Reference to an entity, with the type as key and ID as value', 'type': ['object', 'null'], 'additionalProperties': False, 'patternProperties': {'^[a-z_]+$': {'type': 'string'}}}, 'identifier': {'description': 'An identifier.', 'type': 'string'}, 'identifiers_with_scheme': {'description': 'Identifiers object with identifier value and scheme in separate keys.', 'type': 'object', 'additionalProperties': False, 'properties': {'identifier': {'$ref': '#/identifier'}, 'scheme': {'$ref': '#/scheme'}}}, 'files': {'type': 'object', 'description': 'A file storage for a record.', 'properties': {'enabled': {'description': 'Flag to determine if files are enabled.', 'type': 'boolean'}, 'default_preview': {'description': 'File to preview by default.', 'type': 'string'}, 'order': {'description': 'Order of files.', 'type': 'array', 'items': {'type': 'string'}}, 'count': {'description': 'Number of files.', 'type': 'number'}, 'mimetypes': {'description': 'MIME Types of files.', 'type': 'array', 'items': {'type': 'string'}}, 'totalbytes': {'description': 'Total size of all files.', 'type': 'number'}, 'types': {'description': 'File extensions.', 'type': 'array', 'items': {'type': 'string'}}, 'entries': {'description': 'List of files.', 'type': 'object', 'patternProperties': {'.+': {'$ref': 'local://definitions-v2.0.0.json#/file'}}, 'additionalProperties': False}}}, 'files-simple': {'type': 'object', 'description': 'A file storage for a record.', 'properties': {'enabled': {}, 'default_preview': {}, 'order': {}}}, 'file': {'type': 'object', 'additionalProperties': False, 'description': 'A file object.', 'properties': {'uuid': {'description': 'File record ID.', 'type': 'string'}, 'version_id': {'description': 'File record version ID.', 'type': 'number'}, 'object_version_id': {'description': 'Object version identifier.', 'type': 'string'}, 'file_id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'metadata': {'description': 'File metadata.', 'type': 'object', 'additionalProperties': True}, 'mimetype': {'description': 'File MIMEType.', 'type': 'string'}, 'checksum': {'description': 'Checksum of the file.', 'type': 'string'}, 'ext': {'description': 'Checksum of the file.', 'type': 'string'}, 'size': {'description': 'Size of the file in bytes.', 'type': 'number'}, 'key': {'description': 'Key (filename) of the file.', 'type': 'string'}, 'access': {'description': 'Access properties of the file.', 'type': 'object', 'additionalProperties': False, 'properties': {'hidden': {'description': 'Control whether to hide the file in the UI.', 'type': 'boolean'}}}}}, 'internal-pid': {'type': 'object', 'description': 'An internal persistent identifier object.', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'description': 'Primary key of the PID object.', 'type': 'integer'}, 'status': {'description': 'The status of the PID (from Invenio-PIDStore).', 'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}, 'pid_type': {'description': 'The type of the persistent identifier.', 'type': 'string'}, 'obj_type': {'description': 'The type of the associated object.', 'type': 'string'}}}, 'scheme': {'description': 'A scheme.', 'type': 'string'}}, 'local://definitions-v1.0.0.json': {'$schema': {'type': 'string'}, 'entity_reference': {'description': 'Reference to an entity, with the type as key and ID as value', 'type': ['object', 'null'], 'additionalProperties': False, 'patternProperties': {'^[a-z_]+$': {'type': 'string'}}}, 'identifier': {'description': 'An identifier.', 'type': 'string'}, 'identifiers_with_scheme': {'description': 'Identifiers object with identifier value and scheme in separate keys.', 'type': 'object', 'additionalProperties': False, 'properties': {'identifier': {'$ref': '#/identifier'}, 'scheme': {'$ref': '#/scheme'}}}, 'file': {'type': 'object', 'additionalProperties': False, 'description': 'A file object.', 'properties': {'version_id': {'description': 'Object version ID.', 'type': 'string'}, 'bucket_id': {'description': 'Object verison bucket ID.', 'type': 'string'}, 'mimetype': {'description': 'File MIMEType.', 'type': 'string'}, 'uri': {'description': 'File URI.', 'type': 'string'}, 'storage_class': {'description': 'File storage class.', 'type': 'string'}, 'checksum': {'description': 'Checksum of the file.', 'type': 'string'}, 'size': {'description': 'Size of the file in bytes.', 'type': 'number'}, 'key': {'description': 'Key (filename) of the file.', 'type': 'string'}, 'file_id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}}}, 'internal-pid': {'type': 'object', 'description': 'An internal persistent identifier object.', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'description': 'Primary key of the PID object.', 'type': 'integer'}, 'status': {'description': 'The status of the PID (from Invenio-PIDStore).', 'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}, 'pid_type': {'description': 'The type of the persistent identifier.', 'type': 'string'}, 'obj_type': {'description': 'The type of the associated object.', 'type': 'string'}}}, 'scheme': {'description': 'A scheme.', 'type': 'string'}}, 'local://records/record-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', 'id': 'local://test/records/record-v1.0.0.json', 'title': 'Test Record Schema v1.0.0', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'description': 'JSONSchema declaration.', 'type': 'string'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'id': {'description': 'Persistent record identifier (alphanumeric).', 'type': 'string'}, 'pid': {'type': 'object', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'type': 'integer'}, 'status': {'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}}}, 'metadata': {'type': 'object', 'additionalProperties': False, 'properties': {'title': {'type': 'string'}, 'languages': {'type': 'array', 'items': {'type': 'object', 'properties': {'id': {'type': 'string'}}}}}}}}},
 'urljoin_cache': &lt;functools._lru_cache_wrapper object at 0x7f47ec0e8040&gt;}
        resolver   = &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47ec0234d0&gt;
        schema     = {'$ref': 'local://affiliations/affiliation-v1.0.0.json'}
        self       = &lt;invenio_records.ext._RecordsState object at 0x7f47ed9983b0&gt;
        validator_cls = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

instance = {'$schema': 'local://affiliations/affiliation-v1.0.0.json', 'acronym': 'CERN', 'country': 'CH', 'country_name': 'Switzerland', ...}
schema = {'$ref': 'local://affiliations/affiliation-v1.0.0.json'}
cls = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;, args = ()
kwargs = {'format_checker': None, 'resolver': &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47ec0234d0&gt;}
validator = Draft202012Validator(schema={'$ref': 'local://affi...n-v1.0.0.json'}, format_checker=None)
error = &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;

    def validate(instance, schema, cls=None, *args, **kwargs):  # noqa: D417
        """
        Validate an instance under the given schema.
    
            &gt;&gt;&gt; validate([2, 3, 4], {"maxItems": 2})
            Traceback (most recent call last):
                ...
            ValidationError: [2, 3, 4] is too long
    
        :func:`~jsonschema.validators.validate` will first verify that the
        provided schema is itself valid, since not doing so can lead to less
        obvious error messages and fail in less obvious or consistent ways.
    
        If you know you have a valid schema already, especially
        if you intend to validate multiple instances with
        the same schema, you likely would prefer using the
        `jsonschema.protocols.Validator.validate` method directly on a
        specific validator (e.g. ``Draft202012Validator.validate``).
    
    
        Arguments:
    
            instance:
    
                The instance to validate
    
            schema:
    
                The schema to validate with
    
            cls (jsonschema.protocols.Validator):
    
                The class that will be used to validate the instance.
    
        If the ``cls`` argument is not provided, two things will happen
        in accordance with the specification. First, if the schema has a
        :kw:`$schema` keyword containing a known meta-schema [#]_ then the
        proper validator will be used. The specification recommends that
        all schemas contain :kw:`$schema` properties for this reason. If no
        :kw:`$schema` property is found, the default validator class is the
        latest released draft.
    
        Any other provided positional and keyword arguments will be passed
        on when instantiating the ``cls``.
    
        Raises:
    
            `jsonschema.exceptions.ValidationError`:
    
                if the instance is invalid
    
            `jsonschema.exceptions.SchemaError`:
    
                if the schema itself is invalid
    
        .. rubric:: Footnotes
        .. [#] known by a validator registered with
            `jsonschema.validators.validates`
    
        """
        if cls is None:
            cls = validator_for(schema)
    
        cls.check_schema(schema)
        validator = cls(schema, *args, **kwargs)
        error = exceptions.best_match(validator.iter_errors(instance))
        if error is not None:
&gt;           raise error
E           jsonschema.exceptions.ValidationError: Additional properties are not allowed ('pid' was unexpected)
E           
E           Failed validating 'additionalProperties' in schema:
E               {'$schema': 'http://json-schema.org/draft-07/schema#',
E                '$id': 'local://affiliations/affiliation-v1.0.0.json',
E                'type': 'object',
E                'additionalProperties': False,
E                'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'},
E                               'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'},
E                               'country': {'type': 'string',
E                                           'description': "Represents a affiliation's "
E                                                          'country as a country '
E                                                          'code.'},
E                               'country_name': {'type': 'string',
E                                                'description': 'Represents a '
E                                                               "affiliation's country "
E                                                               'as a full name.'},
E                               'location_name': {'type': 'string',
E                                                 'description': 'Represents a '
E                                                                "affiliation's "
E                                                                'location name '
E                                                                '(usually a city).'},
E                               'acronym': {'type': 'string'},
E                               'identifiers': {'description': 'Alternate identifiers '
E                                                              'for the record.',
E                                               'type': 'array',
E                                               'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'},
E                                               'uniqueItems': True},
E                               'status': {'type': 'string',
E                                          'description': 'Status of the affiliation '
E                                                         'organization.'},
E                               'aliases': {'description': 'Alternate names for the '
E                                                          'affiliation.',
E                                           'type': 'array',
E                                           'items': {'type': 'string'},
E                                           'uniqueItems': True},
E                               'types': {'description': 'Types of affiliation '
E                                                        'organization.',
E                                         'type': 'array',
E                                         'items': {'type': 'string'},
E                                         'uniqueItems': True},
E                               'name': {'type': 'string'},
E                               'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}
E           
E           On instance:
E               {'name': 'New name',
E                'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
E                'types': ['facility', 'funder'],
E                'status': 'active',
E                '$schema': 'local://affiliations/affiliation-v1.0.0.json',
E                'acronym': 'CERN',
E                'country': 'CH',
E                'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
E                'country_name': 'Switzerland',
E                'location_name': 'Geneva',
E                'pid': '01ggx4157'}

args       = ()
cls        = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;
error      = &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;
instance   = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'New name',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
kwargs     = {'format_checker': None,
 'resolver': &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47ec0234d0&gt;}
schema     = {'$ref': 'local://affiliations/affiliation-v1.0.0.json'}
validator  = Draft202012Validator(schema={'$ref': 'local://affi...n-v1.0.0.json'}, format_checker=None)

.venv/lib/python3.12/site-packages/jsonschema/validators.py:1332: ValidationError</failure></testcase><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_openaire_organization_transformer" time="0.002" /><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_openaire_affiliations_service_writer" time="1.329"><failure message="invenio_vocabularies.datastreams.errors.WriterError: [&quot;Vocabulary entry already exists: {'acronym': 'CERN', 'id': '01ggx4157', 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}], 'name': 'Test affiliation', 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'}, 'country': 'CH', 'country_name': 'Switzerland', 'location_name': 'Geneva', 'status': 'active', 'types': ['facility', 'funder']}&quot;]">self = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec0cbd10&gt;
stream_entry = &lt;invenio_vocabularies.datastreams.datastreams.StreamEntry object at 0x7f47ec0caba0&gt;
args = (), kwargs = {}
entry = {'acronym': 'CERN', 'country': 'CH', 'country_name': 'Switzerland', 'id': '01ggx4157', ...}

    def write(self, stream_entry, *args, **kwargs):
        """Writes the input entry using a given service."""
        entry = stream_entry.entry
        current_app.logger.debug(f"Writing entry: {entry}")
    
        try:
            if self._insert:
                try:
                    current_app.logger.debug("Inserting entry.")
                    return StreamEntry(
&gt;                       self._service.create(self._identity, entry), op_type="create"
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                    )

args       = ()
entry      = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
kwargs     = {}
self       = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec0cbd10&gt;
stream_entry = &lt;invenio_vocabularies.datastreams.datastreams.StreamEntry object at 0x7f47ec0caba0&gt;

invenio_vocabularies/datastreams/writers.py:110: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.12/site-packages/invenio_db/uow.py:251: in inner
    res = f(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (&lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;,
 {'acronym': 'CERN',
  'country': 'CH',
  'country_name': 'Switzerland',
  'id': '01ggx4157',
  'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
  'location_name': 'Geneva',
  'name': 'Test affiliation',
  'status': 'active',
  'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
  'types': ['facility', 'funder']})
        f          = &lt;function RecordService.create at 0x7f47ef60f100&gt;
        kwargs     = {'uow': &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec0cb020&gt;}
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec0cb020&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/service.py:329: in create
    return self._create(self.record_cls, identity, data, uow=uow, expand=expand)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        expand     = False
        identity   = &lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec0cb020&gt;
.venv/lib/python3.12/site-packages/invenio_db/uow.py:255: in inner
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (&lt;class 'invenio_records.extensions.Affiliation'&gt;,
 &lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;,
 {'acronym': 'CERN',
  'country': 'CH',
  'country_name': 'Switzerland',
  'id': '01ggx4157',
  'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
  'location_name': 'Geneva',
  'name': 'Test affiliation',
  'status': 'active',
  'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
  'types': ['facility', 'funder']})
        f          = &lt;function RecordService._create at 0x7f47ef60f1a0&gt;
        kwargs     = {'expand': False, 'uow': &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec0cb020&gt;}
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/service.py:356: in _create
    self.run_components(
        data       = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        errors     = []
        expand     = False
        identity   = &lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;
        raise_errors = True
        record     = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        record_cls = &lt;class 'invenio_records.extensions.Affiliation'&gt;
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec0cb020&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/base/service.py:72: in run_components
    getattr(component, action)(*args, **kwargs)
        action     = 'create'
        args       = (&lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;,)
        component  = &lt;invenio_vocabularies.services.components.PIDComponent object at 0x7f47ec1aa090&gt;
        kwargs     = {'data': {'acronym': 'CERN',
          'country': 'CH',
          'country_name': 'Switzerland',
          'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
          'location_name': 'Geneva',
          'name': 'Test affiliation',
          'pid': '01ggx4157',
          'status': 'active',
          'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
          'types': ['facility', 'funder']},
 'errors': [],
 'record': {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
            'acronym': 'CERN',
            'country': 'CH',
            'country_name': 'Switzerland',
            'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
            'location_name': 'Geneva',
            'name': 'Test affiliation',
            'status': 'active',
            'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
            'types': ['facility', 'funder']}}
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47ec0cb020&gt;
invenio_vocabularies/services/components.py:49: in create
    self.service.record_cls.pid.create(record)
        data       = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        identity   = &lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;
        kwargs     = {'errors': []}
        record     = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        self       = &lt;invenio_vocabularies.services.components.PIDComponent object at 0x7f47ec1aa090&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/records/systemfields/pid.py:233: in create
    self.field._provider.create(pid_value, record, self.field.model_field_name)
        pid_value  = '01ggx4157'
        record     = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        self       = &lt;invenio_records_resources.records.systemfields.pid.ModelPIDFieldContext object at 0x7f47ec1aa2d0&gt;
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

cls = &lt;class 'invenio_records_resources.records.providers.ModelPIDProvider'&gt;
pid_value = '01ggx4157'
record = {'$schema': 'local://affiliations/affiliation-v1.0.0.json', 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de t...': 'CH', 'country_name': 'Switzerland', 'location_name': 'Geneva', 'status': 'active', 'types': ['facility', 'funder']}
model_field_name = 'pid', kwargs = {}, filters = {'pid': '01ggx4157'}
obj = &lt;AffiliationMetadata e6a13f76-09a6-4e7d-99a9-7684006d14f1&gt;

    @classmethod
    def create(cls, pid_value, record, model_field_name, **kwargs):
        """Sets the pid in the record model.
    
        Checks for duplicates.
        """
        filters = {model_field_name: pid_value}
        obj = record.model_cls.query.filter_by(**filters).one_or_none()
        if obj:
&gt;           raise PIDAlreadyExists(
                pid_value=pid_value,
                pid_type=record.__class__.__name__,  # FIXME: is informative
            )
E           invenio_pidstore.errors.PIDAlreadyExists

cls        = &lt;class 'invenio_records_resources.records.providers.ModelPIDProvider'&gt;
filters    = {'pid': '01ggx4157'}
kwargs     = {}
model_field_name = 'pid'
obj        = &lt;AffiliationMetadata e6a13f76-09a6-4e7d-99a9-7684006d14f1&gt;
pid_value  = '01ggx4157'
record     = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}

.venv/lib/python3.12/site-packages/invenio_records_resources/records/providers.py:31: PIDAlreadyExists

During handling of the above exception, another exception occurred:

app = &lt;Flask 'invenio'&gt;
search_clear = &lt;OpenSearch([{'host': 'localhost', 'port': 9200}])&gt;
affiliation_full_data = {'acronym': 'CERN', 'country': 'CH', 'country_name': 'Switzerland', 'id': '01ggx4157', ...}
openaire_affiliation_full_data = {'id': '01ggx4157', 'identifiers': [{'identifier': '999988133', 'scheme': 'pic'}]}
service = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;

    def test_openaire_affiliations_service_writer(
        app,
        search_clear,
        affiliation_full_data,
        openaire_affiliation_full_data,
        service,
    ):
        """Test writing and updating an OpenAIRE affiliation entry."""
        # create vocabulary with original service writer
        orig_writer = AffiliationsServiceWriter()
    
&gt;       orig_affiliation_rec = orig_writer.write(StreamEntry(affiliation_full_data))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

affiliation_full_data = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
app        = &lt;Flask 'invenio'&gt;
openaire_affiliation_full_data = {'id': '01ggx4157',
 'identifiers': [{'identifier': '999988133', 'scheme': 'pic'}]}
orig_writer = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec0cbd10&gt;
search_clear = &lt;OpenSearch([{'host': 'localhost', 'port': 9200}])&gt;
service    = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47ed365970&gt;

tests/contrib/affiliations/test_affiliations_datastreams.py:238: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec0cbd10&gt;
stream_entry = &lt;invenio_vocabularies.datastreams.datastreams.StreamEntry object at 0x7f47ec0caba0&gt;
args = (), kwargs = {}
entry = {'acronym': 'CERN', 'country': 'CH', 'country_name': 'Switzerland', 'id': '01ggx4157', ...}

    def write(self, stream_entry, *args, **kwargs):
        """Writes the input entry using a given service."""
        entry = stream_entry.entry
        current_app.logger.debug(f"Writing entry: {entry}")
    
        try:
            if self._insert:
                try:
                    current_app.logger.debug("Inserting entry.")
                    return StreamEntry(
                        self._service.create(self._identity, entry), op_type="create"
                    )
                except PIDAlreadyExists:
                    if not self._update:
&gt;                       raise WriterError([f"Vocabulary entry already exists: {entry}"])
E                       invenio_vocabularies.datastreams.errors.WriterError: ["Vocabulary entry already exists: {'acronym': 'CERN', 'id': '01ggx4157', 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}], 'name': 'Test affiliation', 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'}, 'country': 'CH', 'country_name': 'Switzerland', 'location_name': 'Geneva', 'status': 'active', 'types': ['facility', 'funder']}"]

args       = ()
entry      = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
kwargs     = {}
self       = &lt;invenio_vocabularies.contrib.affiliations.datastreams.AffiliationsServiceWriter object at 0x7f47ec0cbd10&gt;
stream_entry = &lt;invenio_vocabularies.datastreams.datastreams.StreamEntry object at 0x7f47ec0caba0&gt;

invenio_vocabularies/datastreams/writers.py:114: WriterError</failure></testcase><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_openaire_affiliations_transformer_non_openorgs" time="0.003" /><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_openaire_affiliations_transformer_no_id" time="0.003" /><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_openaire_affiliations_transformer_no_alternative_identifiers" time="0.003" /><testcase classname="tests.contrib.affiliations.test_affiliations_datastreams" name="test_edmo_organization_http_reader" time="0.362" /><testcase classname="tests.contrib.affiliations.test_affiliations_jsonschema" name="ISORT" time="0.021" /><testcase classname="tests.contrib.affiliations.test_affiliations_jsonschema" name="black" time="0.178" /><testcase classname="tests.contrib.affiliations.test_affiliations_jsonschema" name="test_valid_full" time="0.825" /><testcase classname="tests.contrib.affiliations.test_affiliations_jsonschema" name="test_valid_empty" time="0.003" /><testcase classname="tests.contrib.affiliations.test_affiliations_jsonschema" name="test_fails_acronym" time="0.003" /><testcase classname="tests.contrib.affiliations.test_affiliations_jsonschema" name="test_fails_name" time="0.004" /><testcase classname="tests.contrib.affiliations.test_affiliations_resource" name="ISORT" time="0.039" /><testcase classname="tests.contrib.affiliations.test_affiliations_resource" name="black" time="0.214" /><testcase classname="tests.contrib.affiliations.test_affiliations_resource" name="test_affiliations_invalid" time="2.161" /><testcase classname="tests.contrib.affiliations.test_affiliations_resource" name="test_affiliations_forbidden" time="1.350" /><testcase classname="tests.contrib.affiliations.test_affiliations_resource" name="test_affiliations_get" time="1.389" /><testcase classname="tests.contrib.affiliations.test_affiliations_resource" name="test_affiliations_search" time="1.445" /><testcase classname="tests.contrib.affiliations.test_affiliations_resource" name="test_affiliations_prefix_search" time="1.526" /><testcase classname="tests.contrib.affiliations.test_affiliations_resource" name="test_affiliations_suggest_sort" time="2.910" /><testcase classname="tests.contrib.affiliations.test_affiliations_schema" name="ISORT" time="0.023" /><testcase classname="tests.contrib.affiliations.test_affiliations_schema" name="black" time="0.172" /><testcase classname="tests.contrib.affiliations.test_affiliations_schema" name="test_valid_full" time="1.828" /><testcase classname="tests.contrib.affiliations.test_affiliations_schema" name="test_valid_minimal" time="0.003" /><testcase classname="tests.contrib.affiliations.test_affiliations_schema" name="test_invalid_no_name" time="0.003" /><testcase classname="tests.contrib.affiliations.test_affiliations_schema" name="test_valid_id" time="0.001" /><testcase classname="tests.contrib.affiliations.test_affiliations_schema" name="test_valid_name" time="0.001" /><testcase classname="tests.contrib.affiliations.test_affiliations_schema" name="test_valid_both_id_name" time="0.001" /><testcase classname="tests.contrib.affiliations.test_affiliations_schema" name="test_invalid_empty" time="0.319" /><testcase classname="tests.contrib.affiliations.test_affiliations_service" name="ISORT" time="0.021" /><testcase classname="tests.contrib.affiliations.test_affiliations_service" name="black" time="0.180" /><testcase classname="tests.contrib.affiliations.test_affiliations_service" name="test_simple_flow" time="2.042"><failure message="jsonschema.exceptions.ValidationError: Additional properties are not allowed ('pid' was unexpected)&#10;&#10;Failed validating 'additionalProperties' in schema:&#10;    {'$schema': 'http://json-schema.org/draft-07/schema#',&#10;     '$id': 'local://affiliations/affiliation-v1.0.0.json',&#10;     'type': 'object',&#10;     'additionalProperties': False,&#10;     'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'},&#10;                    'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'},&#10;                    'country': {'type': 'string',&#10;                                'description': &quot;Represents a affiliation's &quot;&#10;                                               'country as a country '&#10;                                               'code.'},&#10;                    'country_name': {'type': 'string',&#10;                                     'description': 'Represents a '&#10;                                                    &quot;affiliation's country &quot;&#10;                                                    'as a full name.'},&#10;                    'location_name': {'type': 'string',&#10;                                      'description': 'Represents a '&#10;                                                     &quot;affiliation's &quot;&#10;                                                     'location name '&#10;                                                     '(usually a city).'},&#10;                    'acronym': {'type': 'string'},&#10;                    'identifiers': {'description': 'Alternate identifiers '&#10;                                                   'for the record.',&#10;                                    'type': 'array',&#10;                                    'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'},&#10;                                    'uniqueItems': True},&#10;                    'status': {'type': 'string',&#10;                               'description': 'Status of the affiliation '&#10;                                              'organization.'},&#10;                    'aliases': {'description': 'Alternate names for the '&#10;                                               'affiliation.',&#10;                                'type': 'array',&#10;                                'items': {'type': 'string'},&#10;                                'uniqueItems': True},&#10;                    'types': {'description': 'Types of affiliation '&#10;                                             'organization.',&#10;                              'type': 'array',&#10;                              'items': {'type': 'string'},&#10;                              'uniqueItems': True},&#10;                    'name': {'type': 'string'},&#10;                    'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}&#10;&#10;On instance:&#10;    {'name': 'Test affiliation',&#10;     'title': {'en': 'New title', 'es': 'Afiliacion de test'},&#10;     'types': ['facility', 'funder'],&#10;     'status': 'active',&#10;     '$schema': 'local://affiliations/affiliation-v1.0.0.json',&#10;     'acronym': 'CERN',&#10;     'country': 'CH',&#10;     'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],&#10;     'country_name': 'Switzerland',&#10;     'location_name': 'Geneva',&#10;     'pid': '01ggx4157'}">app = &lt;Flask 'invenio'&gt;
db = &lt;SQLAlchemy postgresql+psycopg2://invenio:***@localhost:5432/invenio&gt;
service = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47eb8af110&gt;
identity = &lt;Identity id="1" auth_type="None" provides={Need(method='system_role', value='system_process'), Need(method='system_role', value='any_user'), Need(method='id', value=1)}&gt;
affiliation_full_data = {'acronym': 'CERN', 'country': 'CH', 'country_name': 'Switzerland', 'id': '01ggx4157', ...}

    def test_simple_flow(app, db, service, identity, affiliation_full_data):
        """Test a simple vocabulary service flow."""
        # Service
        assert service.id == "affiliations"
        assert service.config.indexer_queue_name == "affiliations"
    
        # Create it
        item = service.create(identity, affiliation_full_data)
        id_ = item.id
    
        assert item.id == affiliation_full_data["id"]
        for k, v in affiliation_full_data.items():
            assert item.data[k] == v
    
        # Read it
        read_item = service.read(identity, "01ggx4157")
        assert item.id == read_item.id
        assert item.data == read_item.data
    
        # Refresh index to make changes live.
        Affiliation.index.refresh()
    
        # Search it
        res = service.search(identity, q=f"id:{id_}", size=25, page=1)
        assert res.total == 1
        assert list(res.hits)[0] == read_item.data
    
        # Update it
        data = read_item.data
        data["title"]["en"] = "New title"
&gt;       update_item = service.update(identity, id_, data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

affiliation_full_data = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'status': 'active',
 'title': {'en': 'Test affiliation', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
app        = &lt;Flask 'invenio'&gt;
data       = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'created': '2025-11-18T12:43:27.266988+00:00',
 'id': '01ggx4157',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'links': {'self': 'https://127.0.0.1:5000/api/affiliations/01ggx4157'},
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'revision_id': 2,
 'status': 'active',
 'title': {'en': 'New title', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder'],
 'updated': '2025-11-18T12:43:27.275578+00:00'}
db         = &lt;SQLAlchemy postgresql+psycopg2://invenio:***@localhost:5432/invenio&gt;
id_        = '01ggx4157'
identity   = &lt;Identity id="1" auth_type="None" provides={Need(method='system_role', value='system_process'), Need(method='system_role', value='any_user'), Need(method='id', value=1)}&gt;
item       = &lt;invenio_records_resources.services.records.results.RecordItem object at 0x7f47ec6c5460&gt;
k          = 'types'
read_item  = &lt;invenio_records_resources.services.records.results.RecordItem object at 0x7f47eb63eed0&gt;
res        = &lt;invenio_records_resources.services.records.results.RecordList object at 0x7f47eb5001d0&gt;
service    = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47eb8af110&gt;
v          = ['facility', 'funder']

tests/contrib/affiliations/test_affiliations_service.py:51: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.12/site-packages/invenio_db/uow.py:251: in inner
    res = f(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (&lt;Identity id="1" auth_type="None" provides={Need(method='system_role', value='system_process'), Need(method='system_role', value='any_user'), Need(method='id', value=1)}&gt;,
 '01ggx4157',
 {'acronym': 'CERN',
  'country': 'CH',
  'country_name': 'Switzerland',
  'created': '2025-11-18T12:43:27.266988+00:00',
  'id': '01ggx4157',
  'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
  'links': {'self': 'https://127.0.0.1:5000/api/affiliations/01ggx4157'},
  'location_name': 'Geneva',
  'name': 'Test affiliation',
  'revision_id': 2,
  'status': 'active',
  'title': {'en': 'New title', 'es': 'Afiliacion de test'},
  'types': ['facility', 'funder'],
  'updated': '2025-11-18T12:43:27.275578+00:00'})
        f          = &lt;function RecordService.update at 0x7f47ef60f6a0&gt;
        kwargs     = {'uow': &lt;invenio_db.uow.UnitOfWork object at 0x7f47eb5004a0&gt;}
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47eb8af110&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47eb5004a0&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/service.py:495: in update
    uow.register(RecordCommitOp(record, self.indexer))
        _          = []
        data       = {'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'New title', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        expand     = False
        id_        = '01ggx4157'
        identity   = &lt;Identity id="1" auth_type="None" provides={Need(method='system_role', value='system_process'), Need(method='system_role', value='any_user'), Need(method='id', value=1)}&gt;
        record     = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'New title', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        revision_id = None
        self       = &lt;invenio_records_resources.factories.factory.AffiliationService object at 0x7f47eb8af110&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47eb5004a0&gt;
.venv/lib/python3.12/site-packages/invenio_db/uow.py:224: in register
    op.on_register(self)
        op         = &lt;invenio_records_resources.services.uow.RecordCommitOp object at 0x7f47eb9d8740&gt;
        self       = &lt;invenio_db.uow.UnitOfWork object at 0x7f47eb5004a0&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/uow.py:136: in on_register
    self._record.commit()
        self       = &lt;invenio_records_resources.services.uow.RecordCommitOp object at 0x7f47eb9d8740&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47eb5004a0&gt;
.venv/lib/python3.12/site-packages/invenio_records/api.py:454: in commit
    json = self._validate(format_checker=format_checker, validator=validator)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        e          = &lt;invenio_records.systemfields.base.SystemFieldsExt object at 0x7f47ee56c470&gt;
        format_checker = None
        kwargs     = {}
        self       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'New title', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        validator  = None
.venv/lib/python3.12/site-packages/invenio_records/api.py:194: in _validate
    _records_state.validate(
        format_checker = None
        json       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'New title', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        self       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'New title', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        use_model  = False
        validator  = None
.venv/lib/python3.12/site-packages/invenio_records/ext.py:67: in validate
    return validate(data, schema, cls=validator_cls, resolver=resolver, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'New title', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
        kwargs     = {'format_checker': None}
        refresolver_cls_kwargs = {'store': {'local://affiliations/affiliation-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://affiliations/affiliation-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'country': {'type': 'string', 'description': "Represents a affiliation's country as a country code."}, 'country_name': {'type': 'string', 'description': "Represents a affiliation's country as a full name."}, 'location_name': {'type': 'string', 'description': "Represents a affiliation's location name (usually a city)."}, 'acronym': {'type': 'string'}, 'identifiers': {'description': 'Alternate identifiers for the record.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'status': {'type': 'string', 'description': 'Status of the affiliation organization.'}, 'aliases': {'description': 'Alternate names for the affiliation.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'types': {'description': 'Types of affiliation organization.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'name': {'type': 'string'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}, 'local://awards/award-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://awards/award-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'identifiers': {'description': 'Alternate identifiers for the award.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'number': {'type': 'string'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'funder': {'description': "Award's funder.", 'type': 'object', 'additionalProperties': False, 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}}}, 'acronym': {'type': 'string'}, 'program': {'type': 'string'}, 'start_date': {'type': 'string'}, 'end_date': {'type': 'string'}, 'description': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/description'}, 'subjects': {'description': "Award's subjects.", 'type': 'array', 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'subject': {'description': 'Human readable label.', 'type': 'string'}}}, 'organizations': {'description': "Award's organizations.", 'type': 'array', 'items': {'type': 'object', 'additionalProperties': False, 'properties': {'scheme': {'description': 'Identifier of the organization scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'id': {'description': 'Identifier of the organization for the given scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'organization': {'description': 'Human readable label.', 'type': 'string'}}}}}}, 'local://funders/funder-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://funders/funder-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'country': {'type': 'string', 'description': "Represents a funder's origin country as a country code."}, 'country_name': {'type': 'string', 'description': "Represents a funder's origin country as a full name."}, 'location_name': {'type': 'string', 'description': "Represents a funder's location name (usually a city)."}, 'identifiers': {'description': 'Alternate identifiers for the record.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'name': {'type': 'string', 'description': 'Funders name.'}, 'acronym': {'type': 'string', 'description': 'Acronym for funders name.'}, 'status': {'type': 'string', 'description': 'Status of the funder.'}, 'aliases': {'description': 'Alternate names for the funder.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'types': {'description': 'Types of funders.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}, 'local://vocabularies/definitions-v1.0.0.json': {'title': {'type': 'object', 'description': 'Title of vocabulary item. Keys are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'description': {'type': 'object', 'description': 'Description of vocabulary item. Keys are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'icon': {'type': 'string'}, 'tags': {'type': 'array', 'description': 'Tags for a vocabulary item.', 'items': {'type': 'string'}}}, 'local://vocabularies/vocabulary-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://vocabularies/vocabulary-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'description': {'type': 'object', 'description': 'Description of vocabulary item. Key are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'icon': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/icon'}, 'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'pid': {'$ref': 'local://definitions-v1.0.0.json#/internal-pid'}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'type': 'string'}}}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'type': {'type': 'object', 'additionalProperties': False, 'properties': {'id': {'type': 'string'}, 'pid_type': {'type': 'string'}}}}}, 'local://names/name-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://names/name-v1.0.0.json', 'description': 'Names vocabulary.', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'scheme': {'description': 'Identifier of the name scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}, 'given_name': {'type': 'string'}, 'family_name': {'type': 'string'}, 'identifiers': {'description': 'Identifiers for the person.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'}, {'type': 'boolean'}]}}}, 'affiliations': {'description': 'Affiliations of the person.', 'type': 'array', 'items': {'type': 'object', 'additionalProperties': False, 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}}}, 'uniqueItems': True}}}, 'local://subjects/subject-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://subjects/subject-v1.0.0.json', 'description': 'Subjects from specific vocabularies.', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'id': {'description': 'URI or classification code as identifier - globally unique among all subject schemes.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'pid': {'$ref': 'local://definitions-v1.0.0.json#/internal-pid'}, 'scheme': {'description': 'Identifier of the subject scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'subject': {'description': 'Human readable label.', 'type': 'string'}, 'title': {'description': 'Human readable label in different languages.', '$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'}, {'type': 'array', 'items': {'type': 'string'}}]}}, 'additionalProperties': False}, 'identifiers': {'description': 'Alternate identifiers for the subject.', 'type': 'array', 'items': {'$ref': 'local://definitions-v2.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'synonyms': {'description': 'Synonyms of the subject label.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}}}, 'local://definitions-v2.0.0.json': {'$schema': {'type': 'string'}, 'entity_reference': {'description': 'Reference to an entity, with the type as key and ID as value', 'type': ['object', 'null'], 'additionalProperties': False, 'patternProperties': {'^[a-z_]+$': {'type': 'string'}}}, 'identifier': {'description': 'An identifier.', 'type': 'string'}, 'identifiers_with_scheme': {'description': 'Identifiers object with identifier value and scheme in separate keys.', 'type': 'object', 'additionalProperties': False, 'properties': {'identifier': {'$ref': '#/identifier'}, 'scheme': {'$ref': '#/scheme'}}}, 'files': {'type': 'object', 'description': 'A file storage for a record.', 'properties': {'enabled': {'description': 'Flag to determine if files are enabled.', 'type': 'boolean'}, 'default_preview': {'description': 'File to preview by default.', 'type': 'string'}, 'order': {'description': 'Order of files.', 'type': 'array', 'items': {'type': 'string'}}, 'count': {'description': 'Number of files.', 'type': 'number'}, 'mimetypes': {'description': 'MIME Types of files.', 'type': 'array', 'items': {'type': 'string'}}, 'totalbytes': {'description': 'Total size of all files.', 'type': 'number'}, 'types': {'description': 'File extensions.', 'type': 'array', 'items': {'type': 'string'}}, 'entries': {'description': 'List of files.', 'type': 'object', 'patternProperties': {'.+': {'$ref': 'local://definitions-v2.0.0.json#/file'}}, 'additionalProperties': False}}}, 'files-simple': {'type': 'object', 'description': 'A file storage for a record.', 'properties': {'enabled': {}, 'default_preview': {}, 'order': {}}}, 'file': {'type': 'object', 'additionalProperties': False, 'description': 'A file object.', 'properties': {'uuid': {'description': 'File record ID.', 'type': 'string'}, 'version_id': {'description': 'File record version ID.', 'type': 'number'}, 'object_version_id': {'description': 'Object version identifier.', 'type': 'string'}, 'file_id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'metadata': {'description': 'File metadata.', 'type': 'object', 'additionalProperties': True}, 'mimetype': {'description': 'File MIMEType.', 'type': 'string'}, 'checksum': {'description': 'Checksum of the file.', 'type': 'string'}, 'ext': {'description': 'Checksum of the file.', 'type': 'string'}, 'size': {'description': 'Size of the file in bytes.', 'type': 'number'}, 'key': {'description': 'Key (filename) of the file.', 'type': 'string'}, 'access': {'description': 'Access properties of the file.', 'type': 'object', 'additionalProperties': False, 'properties': {'hidden': {'description': 'Control whether to hide the file in the UI.', 'type': 'boolean'}}}}}, 'internal-pid': {'type': 'object', 'description': 'An internal persistent identifier object.', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'description': 'Primary key of the PID object.', 'type': 'integer'}, 'status': {'description': 'The status of the PID (from Invenio-PIDStore).', 'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}, 'pid_type': {'description': 'The type of the persistent identifier.', 'type': 'string'}, 'obj_type': {'description': 'The type of the associated object.', 'type': 'string'}}}, 'scheme': {'description': 'A scheme.', 'type': 'string'}}, 'local://definitions-v1.0.0.json': {'$schema': {'type': 'string'}, 'entity_reference': {'description': 'Reference to an entity, with the type as key and ID as value', 'type': ['object', 'null'], 'additionalProperties': False, 'patternProperties': {'^[a-z_]+$': {'type': 'string'}}}, 'identifier': {'description': 'An identifier.', 'type': 'string'}, 'identifiers_with_scheme': {'description': 'Identifiers object with identifier value and scheme in separate keys.', 'type': 'object', 'additionalProperties': False, 'properties': {'identifier': {'$ref': '#/identifier'}, 'scheme': {'$ref': '#/scheme'}}}, 'file': {'type': 'object', 'additionalProperties': False, 'description': 'A file object.', 'properties': {'version_id': {'description': 'Object version ID.', 'type': 'string'}, 'bucket_id': {'description': 'Object verison bucket ID.', 'type': 'string'}, 'mimetype': {'description': 'File MIMEType.', 'type': 'string'}, 'uri': {'description': 'File URI.', 'type': 'string'}, 'storage_class': {'description': 'File storage class.', 'type': 'string'}, 'checksum': {'description': 'Checksum of the file.', 'type': 'string'}, 'size': {'description': 'Size of the file in bytes.', 'type': 'number'}, 'key': {'description': 'Key (filename) of the file.', 'type': 'string'}, 'file_id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}}}, 'internal-pid': {'type': 'object', 'description': 'An internal persistent identifier object.', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'description': 'Primary key of the PID object.', 'type': 'integer'}, 'status': {'description': 'The status of the PID (from Invenio-PIDStore).', 'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}, 'pid_type': {'description': 'The type of the persistent identifier.', 'type': 'string'}, 'obj_type': {'description': 'The type of the associated object.', 'type': 'string'}}}, 'scheme': {'description': 'A scheme.', 'type': 'string'}}, 'local://records/record-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', 'id': 'local://test/records/record-v1.0.0.json', 'title': 'Test Record Schema v1.0.0', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'description': 'JSONSchema declaration.', 'type': 'string'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'id': {'description': 'Persistent record identifier (alphanumeric).', 'type': 'string'}, 'pid': {'type': 'object', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'type': 'integer'}, 'status': {'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}}}, 'metadata': {'type': 'object', 'additionalProperties': False, 'properties': {'title': {'type': 'string'}, 'languages': {'type': 'array', 'items': {'type': 'object', 'properties': {'id': {'type': 'string'}}}}}}}}},
 'urljoin_cache': &lt;functools._lru_cache_wrapper object at 0x7f47ec252560&gt;}
        resolver   = &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47eb500f80&gt;
        schema     = {'$ref': 'local://affiliations/affiliation-v1.0.0.json'}
        self       = &lt;invenio_records.ext._RecordsState object at 0x7f47eb9da660&gt;
        validator_cls = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

instance = {'$schema': 'local://affiliations/affiliation-v1.0.0.json', 'acronym': 'CERN', 'country': 'CH', 'country_name': 'Switzerland', ...}
schema = {'$ref': 'local://affiliations/affiliation-v1.0.0.json'}
cls = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;, args = ()
kwargs = {'format_checker': None, 'resolver': &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47eb500f80&gt;}
validator = Draft202012Validator(schema={'$ref': 'local://affi...n-v1.0.0.json'}, format_checker=None)
error = &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;

    def validate(instance, schema, cls=None, *args, **kwargs):  # noqa: D417
        """
        Validate an instance under the given schema.
    
            &gt;&gt;&gt; validate([2, 3, 4], {"maxItems": 2})
            Traceback (most recent call last):
                ...
            ValidationError: [2, 3, 4] is too long
    
        :func:`~jsonschema.validators.validate` will first verify that the
        provided schema is itself valid, since not doing so can lead to less
        obvious error messages and fail in less obvious or consistent ways.
    
        If you know you have a valid schema already, especially
        if you intend to validate multiple instances with
        the same schema, you likely would prefer using the
        `jsonschema.protocols.Validator.validate` method directly on a
        specific validator (e.g. ``Draft202012Validator.validate``).
    
    
        Arguments:
    
            instance:
    
                The instance to validate
    
            schema:
    
                The schema to validate with
    
            cls (jsonschema.protocols.Validator):
    
                The class that will be used to validate the instance.
    
        If the ``cls`` argument is not provided, two things will happen
        in accordance with the specification. First, if the schema has a
        :kw:`$schema` keyword containing a known meta-schema [#]_ then the
        proper validator will be used. The specification recommends that
        all schemas contain :kw:`$schema` properties for this reason. If no
        :kw:`$schema` property is found, the default validator class is the
        latest released draft.
    
        Any other provided positional and keyword arguments will be passed
        on when instantiating the ``cls``.
    
        Raises:
    
            `jsonschema.exceptions.ValidationError`:
    
                if the instance is invalid
    
            `jsonschema.exceptions.SchemaError`:
    
                if the schema itself is invalid
    
        .. rubric:: Footnotes
        .. [#] known by a validator registered with
            `jsonschema.validators.validates`
    
        """
        if cls is None:
            cls = validator_for(schema)
    
        cls.check_schema(schema)
        validator = cls(schema, *args, **kwargs)
        error = exceptions.best_match(validator.iter_errors(instance))
        if error is not None:
&gt;           raise error
E           jsonschema.exceptions.ValidationError: Additional properties are not allowed ('pid' was unexpected)
E           
E           Failed validating 'additionalProperties' in schema:
E               {'$schema': 'http://json-schema.org/draft-07/schema#',
E                '$id': 'local://affiliations/affiliation-v1.0.0.json',
E                'type': 'object',
E                'additionalProperties': False,
E                'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'},
E                               'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'},
E                               'country': {'type': 'string',
E                                           'description': "Represents a affiliation's "
E                                                          'country as a country '
E                                                          'code.'},
E                               'country_name': {'type': 'string',
E                                                'description': 'Represents a '
E                                                               "affiliation's country "
E                                                               'as a full name.'},
E                               'location_name': {'type': 'string',
E                                                 'description': 'Represents a '
E                                                                "affiliation's "
E                                                                'location name '
E                                                                '(usually a city).'},
E                               'acronym': {'type': 'string'},
E                               'identifiers': {'description': 'Alternate identifiers '
E                                                              'for the record.',
E                                               'type': 'array',
E                                               'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'},
E                                               'uniqueItems': True},
E                               'status': {'type': 'string',
E                                          'description': 'Status of the affiliation '
E                                                         'organization.'},
E                               'aliases': {'description': 'Alternate names for the '
E                                                          'affiliation.',
E                                           'type': 'array',
E                                           'items': {'type': 'string'},
E                                           'uniqueItems': True},
E                               'types': {'description': 'Types of affiliation '
E                                                        'organization.',
E                                         'type': 'array',
E                                         'items': {'type': 'string'},
E                                         'uniqueItems': True},
E                               'name': {'type': 'string'},
E                               'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}
E           
E           On instance:
E               {'name': 'Test affiliation',
E                'title': {'en': 'New title', 'es': 'Afiliacion de test'},
E                'types': ['facility', 'funder'],
E                'status': 'active',
E                '$schema': 'local://affiliations/affiliation-v1.0.0.json',
E                'acronym': 'CERN',
E                'country': 'CH',
E                'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
E                'country_name': 'Switzerland',
E                'location_name': 'Geneva',
E                'pid': '01ggx4157'}

args       = ()
cls        = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;
error      = &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;
instance   = {'$schema': 'local://affiliations/affiliation-v1.0.0.json',
 'acronym': 'CERN',
 'country': 'CH',
 'country_name': 'Switzerland',
 'identifiers': [{'identifier': '03yrm5c26', 'scheme': 'ror'}],
 'location_name': 'Geneva',
 'name': 'Test affiliation',
 'pid': '01ggx4157',
 'status': 'active',
 'title': {'en': 'New title', 'es': 'Afiliacion de test'},
 'types': ['facility', 'funder']}
kwargs     = {'format_checker': None,
 'resolver': &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47eb500f80&gt;}
schema     = {'$ref': 'local://affiliations/affiliation-v1.0.0.json'}
validator  = Draft202012Validator(schema={'$ref': 'local://affi...n-v1.0.0.json'}, format_checker=None)

.venv/lib/python3.12/site-packages/jsonschema/validators.py:1332: ValidationError</failure></testcase><testcase classname="tests.contrib.affiliations.test_affiliations_service" name="test_pid_already_registered" time="1.230" /><testcase classname="tests.contrib.affiliations.test_affiliations_service" name="test_extra_fields" time="0.016" /><testcase classname="tests.contrib.affiliations.test_affiliations_service" name="test_indexed_at_query" time="0.393" /><testcase classname="tests.contrib.awards.conftest" name="PYDOCSTYLE" time="0.012" /><testcase classname="tests.contrib.awards.conftest" name="ISORT" time="0.030" /><testcase classname="tests.contrib.awards.conftest" name="black" time="0.188" /><testcase classname="tests.contrib.awards.test_awards_api" name="ISORT" time="0.023" /><testcase classname="tests.contrib.awards.test_awards_api" name="black" time="0.177" /><testcase classname="tests.contrib.awards.test_awards_api" name="test_award_schema_validation" time="1.983" /><testcase classname="tests.contrib.awards.test_awards_api" name="test_award_indexing" time="0.107" /><testcase classname="tests.contrib.awards.test_awards_api" name="test_award_pid" time="0.402" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="ISORT" time="0.056" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="black" time="0.218" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="test_awards_transformer" time="1.846" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="test_awards_service_writer_create" time="1.261" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="test_awards_funder_id_not_exist" time="1.278" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="test_awards_funder_id_not_exist_no_funders" time="1.184" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="test_awards_transformer_ec_functionality" time="1.135" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="test_awards_service_writer_duplicate" time="1.221" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="test_awards_service_writer_update_existing" time="1.246" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="test_awards_service_writer_update_non_existing" time="1.172" /><testcase classname="tests.contrib.awards.test_awards_datastreams" name="test_awards_cordis_transformer" time="0.311" /><testcase classname="tests.contrib.awards.test_awards_jsonschema" name="ISORT" time="0.016" /><testcase classname="tests.contrib.awards.test_awards_jsonschema" name="black" time="0.173" /><testcase classname="tests.contrib.awards.test_awards_jsonschema" name="test_valid_full" time="0.819" /><testcase classname="tests.contrib.awards.test_awards_jsonschema" name="test_valid_empty" time="0.003" /><testcase classname="tests.contrib.awards.test_awards_jsonschema" name="test_fails_number" time="0.004" /><testcase classname="tests.contrib.awards.test_awards_resource" name="ISORT" time="0.038" /><testcase classname="tests.contrib.awards.test_awards_resource" name="black" time="0.205" /><testcase classname="tests.contrib.awards.test_awards_resource" name="test_awards_invalid" time="1.866" /><testcase classname="tests.contrib.awards.test_awards_resource" name="test_awards_forbidden" time="0.226" /><testcase classname="tests.contrib.awards.test_awards_resource" name="test_awards_get" time="0.138" /><testcase classname="tests.contrib.awards.test_awards_resource" name="test_awards_search" time="0.189" /><testcase classname="tests.contrib.awards.test_awards_resource" name="test_awards_suggest_sort" time="0.458" /><testcase classname="tests.contrib.awards.test_awards_resource" name="test_awards_faceted_suggest" time="0.255" /><testcase classname="tests.contrib.awards.test_awards_resource" name="test_awards_delete" time="0.241" /><testcase classname="tests.contrib.awards.test_awards_resource" name="test_awards_update" time="0.187" /><testcase classname="tests.contrib.awards.test_awards_resource" name="test_awards_create" time="0.459" /><testcase classname="tests.contrib.awards.test_awards_schema" name="ISORT" time="0.030" /><testcase classname="tests.contrib.awards.test_awards_schema" name="black" time="0.195" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_valid_full" time="1.807" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_valid_minimal" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_invalid_no_number" time="0.003" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_invalid_empty_number" time="0.004" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_invalid_empty_pid" time="0.004" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_award_funder_name" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_award_funder_id" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_valid_id" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_valid_number_title" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_invalid_empty" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_invalid_number_type" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_valid_award_funding" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_invalid_award_funding" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_valid_funder_funding" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_invalid_funder_funding" time="0.001" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_valid_award_funder_funding" time="0.002" /><testcase classname="tests.contrib.awards.test_awards_schema" name="test_invalid_empty_funding" time="0.292" /><testcase classname="tests.contrib.awards.test_awards_service" name="ISORT" time="0.029" /><testcase classname="tests.contrib.awards.test_awards_service" name="black" time="0.195" /><testcase classname="tests.contrib.awards.test_awards_service" name="test_simple_flow" time="2.047" /><testcase classname="tests.contrib.awards.test_awards_service" name="test_create_invalid_funder" time="0.072" /><testcase classname="tests.contrib.awards.test_awards_service" name="test_pid_already_registered" time="0.117" /><testcase classname="tests.contrib.awards.test_awards_service" name="test_extra_fields" time="0.066" /><testcase classname="tests.contrib.awards.test_awards_service" name="test_award_dereferenced" time="1.200" /><testcase classname="tests.contrib.awards.test_awards_service" name="test_indexed_at_query" time="0.446" /><testcase classname="tests.contrib.common.openaire.test_openaire_datastreams" name="ISORT" time="0.028" /><testcase classname="tests.contrib.common.openaire.test_openaire_datastreams" name="black" time="0.186" /><testcase classname="tests.contrib.common.openaire.test_openaire_datastreams" name="test_openaire_http_reader" time="0.002" /><testcase classname="tests.contrib.common.openaire.test_openaire_datastreams" name="test_openaire_http_reader_wrong_number_tar_items_error" time="0.001" /><testcase classname="tests.contrib.common.openaire.test_openaire_datastreams" name="test_openaire_http_reader_unsupported_origin_option" time="0.001" /><testcase classname="tests.contrib.common.openaire.test_openaire_datastreams" name="test_openaire_http_reader_item_not_implemented" time="0.001" /><testcase classname="tests.contrib.common.openaire.test_openaire_datastreams" name="test_openaire_http_reader_iter_not_implemented" time="0.001" /><testcase classname="tests.contrib.common.ror.test_ror_datastreams" name="ISORT" time="0.044" /><testcase classname="tests.contrib.common.ror.test_ror_datastreams" name="black" time="0.205" /><testcase classname="tests.contrib.common.ror.test_ror_datastreams" name="test_ror_http_reader" time="0.004" /><testcase classname="tests.contrib.common.ror.test_ror_datastreams" name="test_ror_http_reader_since_before_publish" time="0.004" /><testcase classname="tests.contrib.common.ror.test_ror_datastreams" name="test_ror_http_reader_since_after_publish" time="0.004" /><testcase classname="tests.contrib.common.ror.test_ror_datastreams" name="test_ror_http_reader_wrong_number_zip_items_error" time="0.001" /><testcase classname="tests.contrib.common.ror.test_ror_datastreams" name="test_ror_http_reader_no_json_ld" time="0.001" /><testcase classname="tests.contrib.common.ror.test_ror_datastreams" name="test_ror_http_reader_item_not_implemented" time="0.001" /><testcase classname="tests.contrib.common.ror.test_ror_datastreams" name="test_ror_http_reader_iter_not_implemented" time="0.001" /><testcase classname="tests.contrib.common.ror.test_ror_datastreams" name="test_ror_transformer" time="2.227" /><testcase classname="tests.contrib.funders.conftest" name="PYDOCSTYLE" time="0.008" /><testcase classname="tests.contrib.funders.conftest" name="ISORT" time="0.019" /><testcase classname="tests.contrib.funders.conftest" name="black" time="0.183" /><testcase classname="tests.contrib.funders.test_funders_api" name="ISORT" time="0.019" /><testcase classname="tests.contrib.funders.test_funders_api" name="black" time="0.178" /><testcase classname="tests.contrib.funders.test_funders_api" name="test_funder_schema_validation" time="1.845" /><testcase classname="tests.contrib.funders.test_funders_api" name="test_funder_indexing" time="0.048" /><testcase classname="tests.contrib.funders.test_funders_api" name="test_funder_pid" time="0.309" /><testcase classname="tests.contrib.funders.test_funders_datastreams" name="ISORT" time="0.029" /><testcase classname="tests.contrib.funders.test_funders_datastreams" name="black" time="0.191" /><testcase classname="tests.contrib.funders.test_funders_datastreams" name="test_ror_transformer" time="1.814" /><testcase classname="tests.contrib.funders.test_funders_datastreams" name="test_funders_service_writer_create" time="1.085" /><testcase classname="tests.contrib.funders.test_funders_datastreams" name="test_funders_service_writer_duplicate" time="1.143" /><testcase classname="tests.contrib.funders.test_funders_datastreams" name="test_funders_service_writer_update_existing" time="1.221" /><testcase classname="tests.contrib.funders.test_funders_datastreams" name="test_funders_service_writer_update_non_existing" time="1.389" /><testcase classname="tests.contrib.funders.test_funders_jsonschema" name="ISORT" time="0.017" /><testcase classname="tests.contrib.funders.test_funders_jsonschema" name="black" time="0.172" /><testcase classname="tests.contrib.funders.test_funders_jsonschema" name="test_valid_full" time="0.812" /><testcase classname="tests.contrib.funders.test_funders_jsonschema" name="test_valid_empty" time="0.003" /><testcase classname="tests.contrib.funders.test_funders_jsonschema" name="test_fails_name" time="0.003" /><testcase classname="tests.contrib.funders.test_funders_jsonschema" name="test_fails_country" time="0.004" /><testcase classname="tests.contrib.funders.test_funders_resource" name="ISORT" time="0.035" /><testcase classname="tests.contrib.funders.test_funders_resource" name="black" time="0.207" /><testcase classname="tests.contrib.funders.test_funders_resource" name="test_funders_invalid" time="1.844" /><testcase classname="tests.contrib.funders.test_funders_resource" name="test_funders_forbidden" time="0.144" /><testcase classname="tests.contrib.funders.test_funders_resource" name="test_funders_get" time="0.080" /><testcase classname="tests.contrib.funders.test_funders_resource" name="test_funders_search" time="0.076" /><testcase classname="tests.contrib.funders.test_funders_resource" name="test_funders_prefix_search" time="0.212" /><testcase classname="tests.contrib.funders.test_funders_resource" name="test_funders_suggest_sort" time="0.365" /><testcase classname="tests.contrib.funders.test_funders_resource" name="test_funders_delete" time="0.156" /><testcase classname="tests.contrib.funders.test_funders_resource" name="test_funders_update" time="0.164" /><testcase classname="tests.contrib.funders.test_funders_resource" name="test_funders_create" time="0.372" /><testcase classname="tests.contrib.funders.test_funders_schema" name="ISORT" time="0.023" /><testcase classname="tests.contrib.funders.test_funders_schema" name="black" time="0.184" /><testcase classname="tests.contrib.funders.test_funders_schema" name="test_valid_full" time="1.764" /><testcase classname="tests.contrib.funders.test_funders_schema" name="test_valid_minimal" time="0.003" /><testcase classname="tests.contrib.funders.test_funders_schema" name="test_invalid_no_name" time="0.002" /><testcase classname="tests.contrib.funders.test_funders_schema" name="test_invalid_empty" time="0.005" /><testcase classname="tests.contrib.funders.test_funders_schema" name="test_invalid_empty_funder" time="0.002" /><testcase classname="tests.contrib.funders.test_funders_schema" name="test_invalid_country" time="0.002" /><testcase classname="tests.contrib.funders.test_funders_schema" name="test_valid_id" time="0.001" /><testcase classname="tests.contrib.funders.test_funders_schema" name="test_valid_name" time="0.001" /><testcase classname="tests.contrib.funders.test_funders_schema" name="test_valid_both_id_name" time="0.001" /><testcase classname="tests.contrib.funders.test_funders_schema" name="test_invalid_empty_relation" time="0.306" /><testcase classname="tests.contrib.funders.test_funders_service" name="ISORT" time="0.023" /><testcase classname="tests.contrib.funders.test_funders_service" name="black" time="0.185" /><testcase classname="tests.contrib.funders.test_funders_service" name="test_simple_flow" time="2.196" /><testcase classname="tests.contrib.funders.test_funders_service" name="test_pid_already_registered" time="0.074" /><testcase classname="tests.contrib.funders.test_funders_service" name="test_extra_fields" time="0.015" /><testcase classname="tests.contrib.funders.test_funders_service" name="test_indexed_at_query" time="0.383" /><testcase classname="tests.contrib.names.conftest" name="PYDOCSTYLE" time="0.009" /><testcase classname="tests.contrib.names.conftest" name="ISORT" time="0.020" /><testcase classname="tests.contrib.names.conftest" name="black" time="0.186" /><testcase classname="tests.contrib.names.test_name_permissions" name="ISORT" time="0.020" /><testcase classname="tests.contrib.names.test_name_permissions" name="black" time="0.182" /><testcase classname="tests.contrib.names.test_name_permissions" name="test_non_searchable_tag" time="2.379" /><testcase classname="tests.contrib.names.test_names_api" name="ISORT" time="0.022" /><testcase classname="tests.contrib.names.test_names_api" name="black" time="0.186" /><testcase classname="tests.contrib.names.test_names_api" name="test_name_schema_validation" time="1.892" /><testcase classname="tests.contrib.names.test_names_api" name="test_name_indexing" time="0.084" /><testcase classname="tests.contrib.names.test_names_api" name="test_name_pid" time="0.378" /><testcase classname="tests.contrib.names.test_names_datastreams" name="ISORT" time="0.070" /><testcase classname="tests.contrib.names.test_names_datastreams" name="black" time="0.240" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_xml_transform" time="0.002" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer" time="1.794" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_org_ids_mapping_from_file" time="0.004" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_name_filtering[Lars Holm, Nielsen-True]" time="0.003" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_name_filtering[Lars Nielsen:)-False]" time="0.005" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_name_filtering[Lars Nielsen-H-True]" time="0.003" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_name_filtering[Lars Nielsen \U0001f44d-False]" time="0.003" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_name_filtering[Lars Nielsen (CERN)-True]" time="0.003" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_different_names_no_regex[Lars Holm, Nielsen]" time="0.003" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_different_names_no_regex[Lars Nielsen:)]" time="0.003" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_different_names_no_regex[Lars Nielsen-H]" time="0.003" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_different_names_no_regex[Lars Nielsen \U0001f44d]" time="0.003" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_transformer_different_names_no_regex[Lars Nielsen (CERN)]" time="0.003" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_orcid_http_reader" time="0.001" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_names_service_writer_create" time="1.090" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_names_service_writer_duplicate" time="1.087" /><testcase classname="tests.contrib.names.test_names_datastreams" name="test_names_service_writer_update_existing" time="1.206"><failure message="jsonschema.exceptions.ValidationError: Additional properties are not allowed ('pid' was unexpected)&#10;&#10;Failed validating 'additionalProperties' in schema:&#10;    {'$schema': 'http://json-schema.org/draft-07/schema#',&#10;     '$id': 'local://names/name-v1.0.0.json',&#10;     'description': 'Names vocabulary.',&#10;     'type': 'object',&#10;     'additionalProperties': False,&#10;     'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'},&#10;                    'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'},&#10;                    'scheme': {'description': 'Identifier of the name '&#10;                                              'scheme.',&#10;                               '$ref': 'local://definitions-v1.0.0.json#/identifier'},&#10;                    'name': {'type': 'string'},&#10;                    'given_name': {'type': 'string'},&#10;                    'family_name': {'type': 'string'},&#10;                    'identifiers': {'description': 'Identifiers for the '&#10;                                                   'person.',&#10;                                    'type': 'array',&#10;                                    'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'},&#10;                                    'uniqueItems': True},&#10;                    'props': {'type': 'object',&#10;                              'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'},&#10;                                                                       {'type': 'boolean'}]}}},&#10;                    'affiliations': {'description': 'Affiliations of the '&#10;                                                    'person.',&#10;                                     'type': 'array',&#10;                                     'items': {'type': 'object',&#10;                                               'additionalProperties': False,&#10;                                               'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'},&#10;                                                              'name': {'type': 'string'}}},&#10;                                     'uniqueItems': True}}}&#10;&#10;On instance:&#10;    {'name': 'Panero, Pablo',&#10;     '$schema': 'local://names/name-v1.0.0.json',&#10;     'given_name': 'Pablo',&#10;     'family_name': 'Panero',&#10;     'identifiers': [{'identifier': '0000-0001-8135-3489',&#10;                      'scheme': 'orcid'}],&#10;     'affiliations': [{'name': 'CERN'}],&#10;     'pid': '0000-0001-8135-3489'}">app = &lt;Flask 'invenio'&gt;
db = &lt;SQLAlchemy postgresql+psycopg2://invenio:***@localhost:5432/invenio&gt;
search_clear = &lt;OpenSearch([{'host': 'localhost', 'port': 9200}])&gt;
name_full_data = {'affiliations': [{'name': 'CERN'}], 'family_name': 'Nielsen', 'given_name': 'Lars Holm', 'id': '0000-0001-8135-3489', ...}

    def test_names_service_writer_update_existing(app, db, search_clear, name_full_data):
        # create vocabulary
        writer = NamesServiceWriter(update=True)
        name = writer.write(stream_entry=StreamEntry(name_full_data))
        Name.index.refresh()  # refresh index to make changes live
        # update vocabulary
        updated_name = deepcopy(name_full_data)
        updated_name["given_name"] = "Pablo"
        updated_name["family_name"] = "Panero"
        updated_name["name"] = "Panero, Pablo"
        # check changes vocabulary
&gt;       _ = writer.write(stream_entry=StreamEntry(updated_name))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

app        = &lt;Flask 'invenio'&gt;
db         = &lt;SQLAlchemy postgresql+psycopg2://invenio:***@localhost:5432/invenio&gt;
name       = &lt;invenio_vocabularies.datastreams.datastreams.StreamEntry object at 0x7f47e9f72fc0&gt;
name_full_data = {'affiliations': [{'name': 'CERN'}],
 'family_name': 'Nielsen',
 'given_name': 'Lars Holm',
 'id': '0000-0001-8135-3489',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Nielsen, Lars Holm'}
search_clear = &lt;OpenSearch([{'host': 'localhost', 'port': 9200}])&gt;
updated_name = {'affiliations': [{'name': 'CERN'}],
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'id': '0000-0001-8135-3489',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Panero, Pablo'}
writer     = &lt;invenio_vocabularies.contrib.names.datastreams.NamesServiceWriter object at 0x7f47e9cd8080&gt;

tests/contrib/names/test_names_datastreams.py:419: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
invenio_vocabularies/datastreams/writers.py:115: in write
    return self._do_update(entry)
           ^^^^^^^^^^^^^^^^^^^^^^
        args       = ()
        entry      = {'affiliations': [{'name': 'CERN'}],
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'id': '0000-0001-8135-3489',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Panero, Pablo'}
        kwargs     = {}
        self       = &lt;invenio_vocabularies.contrib.names.datastreams.NamesServiceWriter object at 0x7f47e9cd8080&gt;
        stream_entry = &lt;invenio_vocabularies.datastreams.datastreams.StreamEntry object at 0x7f47eea68320&gt;
invenio_vocabularies/datastreams/writers.py:97: in _do_update
    self._service.update(self._identity, vocab_id, updated), op_type="update"
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        current    = &lt;invenio_records_resources.services.records.results.RecordItem object at 0x7f47e9cdbad0&gt;
        entry      = {'affiliations': [{'name': 'CERN'}],
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'id': '0000-0001-8135-3489',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Panero, Pablo'}
        self       = &lt;invenio_vocabularies.contrib.names.datastreams.NamesServiceWriter object at 0x7f47e9cd8080&gt;
        updated    = {'affiliations': [{'name': 'CERN'}],
 'created': '2025-11-18T12:44:26.649194+00:00',
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'id': '0000-0001-8135-3489',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'internal_id': None,
 'links': {'self': 'https://127.0.0.1:5000/api/names/0000-0001-8135-3489'},
 'name': 'Panero, Pablo',
 'revision_id': 3,
 'updated': '2025-11-18T12:44:26.657900+00:00'}
        vocab_id   = '0000-0001-8135-3489'
.venv/lib/python3.12/site-packages/invenio_db/uow.py:251: in inner
    res = f(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (&lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;,
 '0000-0001-8135-3489',
 {'affiliations': [{'name': 'CERN'}],
  'created': '2025-11-18T12:44:26.649194+00:00',
  'family_name': 'Panero',
  'given_name': 'Pablo',
  'id': '0000-0001-8135-3489',
  'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
  'internal_id': None,
  'links': {'self': 'https://127.0.0.1:5000/api/names/0000-0001-8135-3489'},
  'name': 'Panero, Pablo',
  'revision_id': 3,
  'updated': '2025-11-18T12:44:26.657900+00:00'})
        f          = &lt;function RecordService.update at 0x7f47ef60f6a0&gt;
        kwargs     = {'uow': &lt;invenio_db.uow.UnitOfWork object at 0x7f47e9d30920&gt;}
        self       = &lt;invenio_vocabularies.contrib.names.services.NamesService object at 0x7f47e9db43e0&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47e9d30920&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/service.py:495: in update
    uow.register(RecordCommitOp(record, self.indexer))
        _          = []
        data       = {'affiliations': [{'name': 'CERN'}],
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Panero, Pablo',
 'pid': '0000-0001-8135-3489'}
        expand     = False
        id_        = '0000-0001-8135-3489'
        identity   = &lt;Identity id="system" auth_type="None" provides={Need(method='system_role', value='system_process')}&gt;
        record     = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'name': 'CERN'}],
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Panero, Pablo',
 'pid': '0000-0001-8135-3489'}
        revision_id = None
        self       = &lt;invenio_vocabularies.contrib.names.services.NamesService object at 0x7f47e9db43e0&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47e9d30920&gt;
.venv/lib/python3.12/site-packages/invenio_db/uow.py:224: in register
    op.on_register(self)
        op         = &lt;invenio_records_resources.services.uow.RecordCommitOp object at 0x7f47e9d30ec0&gt;
        self       = &lt;invenio_db.uow.UnitOfWork object at 0x7f47e9d30920&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/uow.py:136: in on_register
    self._record.commit()
        self       = &lt;invenio_records_resources.services.uow.RecordCommitOp object at 0x7f47e9d30ec0&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47e9d30920&gt;
.venv/lib/python3.12/site-packages/invenio_records/api.py:454: in commit
    json = self._validate(format_checker=format_checker, validator=validator)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        e          = &lt;invenio_records.systemfields.base.SystemFieldsExt object at 0x7f47ee5c7380&gt;
        format_checker = None
        kwargs     = {}
        self       = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'name': 'CERN'}],
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Panero, Pablo',
 'pid': '0000-0001-8135-3489'}
        validator  = None
.venv/lib/python3.12/site-packages/invenio_records/api.py:194: in _validate
    _records_state.validate(
        format_checker = None
        json       = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'name': 'CERN'}],
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Panero, Pablo',
 'pid': '0000-0001-8135-3489'}
        self       = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'name': 'CERN'}],
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Panero, Pablo',
 'pid': '0000-0001-8135-3489'}
        use_model  = False
        validator  = None
.venv/lib/python3.12/site-packages/invenio_records/ext.py:67: in validate
    return validate(data, schema, cls=validator_cls, resolver=resolver, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'name': 'CERN'}],
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Panero, Pablo',
 'pid': '0000-0001-8135-3489'}
        kwargs     = {'format_checker': None}
        refresolver_cls_kwargs = {'store': {'local://affiliations/affiliation-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://affiliations/affiliation-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'country': {'type': 'string', 'description': "Represents a affiliation's country as a country code."}, 'country_name': {'type': 'string', 'description': "Represents a affiliation's country as a full name."}, 'location_name': {'type': 'string', 'description': "Represents a affiliation's location name (usually a city)."}, 'acronym': {'type': 'string'}, 'identifiers': {'description': 'Alternate identifiers for the record.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'status': {'type': 'string', 'description': 'Status of the affiliation organization.'}, 'aliases': {'description': 'Alternate names for the affiliation.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'types': {'description': 'Types of affiliation organization.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'name': {'type': 'string'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}, 'local://awards/award-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://awards/award-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'identifiers': {'description': 'Alternate identifiers for the award.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'number': {'type': 'string'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'funder': {'description': "Award's funder.", 'type': 'object', 'additionalProperties': False, 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}}}, 'acronym': {'type': 'string'}, 'program': {'type': 'string'}, 'start_date': {'type': 'string'}, 'end_date': {'type': 'string'}, 'description': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/description'}, 'subjects': {'description': "Award's subjects.", 'type': 'array', 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'subject': {'description': 'Human readable label.', 'type': 'string'}}}, 'organizations': {'description': "Award's organizations.", 'type': 'array', 'items': {'type': 'object', 'additionalProperties': False, 'properties': {'scheme': {'description': 'Identifier of the organization scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'id': {'description': 'Identifier of the organization for the given scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'organization': {'description': 'Human readable label.', 'type': 'string'}}}}}}, 'local://funders/funder-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://funders/funder-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'country': {'type': 'string', 'description': "Represents a funder's origin country as a country code."}, 'country_name': {'type': 'string', 'description': "Represents a funder's origin country as a full name."}, 'location_name': {'type': 'string', 'description': "Represents a funder's location name (usually a city)."}, 'identifiers': {'description': 'Alternate identifiers for the record.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'name': {'type': 'string', 'description': 'Funders name.'}, 'acronym': {'type': 'string', 'description': 'Acronym for funders name.'}, 'status': {'type': 'string', 'description': 'Status of the funder.'}, 'aliases': {'description': 'Alternate names for the funder.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'types': {'description': 'Types of funders.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}, 'local://vocabularies/definitions-v1.0.0.json': {'title': {'type': 'object', 'description': 'Title of vocabulary item. Keys are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'description': {'type': 'object', 'description': 'Description of vocabulary item. Keys are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'icon': {'type': 'string'}, 'tags': {'type': 'array', 'description': 'Tags for a vocabulary item.', 'items': {'type': 'string'}}}, 'local://vocabularies/vocabulary-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://vocabularies/vocabulary-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'description': {'type': 'object', 'description': 'Description of vocabulary item. Key are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'icon': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/icon'}, 'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'pid': {'$ref': 'local://definitions-v1.0.0.json#/internal-pid'}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'type': 'string'}}}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'type': {'type': 'object', 'additionalProperties': False, 'properties': {'id': {'type': 'string'}, 'pid_type': {'type': 'string'}}}}}, 'local://names/name-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://names/name-v1.0.0.json', 'description': 'Names vocabulary.', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'scheme': {'description': 'Identifier of the name scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}, 'given_name': {'type': 'string'}, 'family_name': {'type': 'string'}, 'identifiers': {'description': 'Identifiers for the person.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'}, {'type': 'boolean'}]}}}, 'affiliations': {'description': 'Affiliations of the person.', 'type': 'array', 'items': {'type': 'object', 'additionalProperties': False, 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}}}, 'uniqueItems': True}}}, 'local://subjects/subject-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://subjects/subject-v1.0.0.json', 'description': 'Subjects from specific vocabularies.', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'id': {'description': 'URI or classification code as identifier - globally unique among all subject schemes.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'pid': {'$ref': 'local://definitions-v1.0.0.json#/internal-pid'}, 'scheme': {'description': 'Identifier of the subject scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'subject': {'description': 'Human readable label.', 'type': 'string'}, 'title': {'description': 'Human readable label in different languages.', '$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'}, {'type': 'array', 'items': {'type': 'string'}}]}}, 'additionalProperties': False}, 'identifiers': {'description': 'Alternate identifiers for the subject.', 'type': 'array', 'items': {'$ref': 'local://definitions-v2.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'synonyms': {'description': 'Synonyms of the subject label.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}}}, 'local://definitions-v2.0.0.json': {'$schema': {'type': 'string'}, 'entity_reference': {'description': 'Reference to an entity, with the type as key and ID as value', 'type': ['object', 'null'], 'additionalProperties': False, 'patternProperties': {'^[a-z_]+$': {'type': 'string'}}}, 'identifier': {'description': 'An identifier.', 'type': 'string'}, 'identifiers_with_scheme': {'description': 'Identifiers object with identifier value and scheme in separate keys.', 'type': 'object', 'additionalProperties': False, 'properties': {'identifier': {'$ref': '#/identifier'}, 'scheme': {'$ref': '#/scheme'}}}, 'files': {'type': 'object', 'description': 'A file storage for a record.', 'properties': {'enabled': {'description': 'Flag to determine if files are enabled.', 'type': 'boolean'}, 'default_preview': {'description': 'File to preview by default.', 'type': 'string'}, 'order': {'description': 'Order of files.', 'type': 'array', 'items': {'type': 'string'}}, 'count': {'description': 'Number of files.', 'type': 'number'}, 'mimetypes': {'description': 'MIME Types of files.', 'type': 'array', 'items': {'type': 'string'}}, 'totalbytes': {'description': 'Total size of all files.', 'type': 'number'}, 'types': {'description': 'File extensions.', 'type': 'array', 'items': {'type': 'string'}}, 'entries': {'description': 'List of files.', 'type': 'object', 'patternProperties': {'.+': {'$ref': 'local://definitions-v2.0.0.json#/file'}}, 'additionalProperties': False}}}, 'files-simple': {'type': 'object', 'description': 'A file storage for a record.', 'properties': {'enabled': {}, 'default_preview': {}, 'order': {}}}, 'file': {'type': 'object', 'additionalProperties': False, 'description': 'A file object.', 'properties': {'uuid': {'description': 'File record ID.', 'type': 'string'}, 'version_id': {'description': 'File record version ID.', 'type': 'number'}, 'object_version_id': {'description': 'Object version identifier.', 'type': 'string'}, 'file_id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'metadata': {'description': 'File metadata.', 'type': 'object', 'additionalProperties': True}, 'mimetype': {'description': 'File MIMEType.', 'type': 'string'}, 'checksum': {'description': 'Checksum of the file.', 'type': 'string'}, 'ext': {'description': 'Checksum of the file.', 'type': 'string'}, 'size': {'description': 'Size of the file in bytes.', 'type': 'number'}, 'key': {'description': 'Key (filename) of the file.', 'type': 'string'}, 'access': {'description': 'Access properties of the file.', 'type': 'object', 'additionalProperties': False, 'properties': {'hidden': {'description': 'Control whether to hide the file in the UI.', 'type': 'boolean'}}}}}, 'internal-pid': {'type': 'object', 'description': 'An internal persistent identifier object.', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'description': 'Primary key of the PID object.', 'type': 'integer'}, 'status': {'description': 'The status of the PID (from Invenio-PIDStore).', 'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}, 'pid_type': {'description': 'The type of the persistent identifier.', 'type': 'string'}, 'obj_type': {'description': 'The type of the associated object.', 'type': 'string'}}}, 'scheme': {'description': 'A scheme.', 'type': 'string'}}, 'local://definitions-v1.0.0.json': {'$schema': {'type': 'string'}, 'entity_reference': {'description': 'Reference to an entity, with the type as key and ID as value', 'type': ['object', 'null'], 'additionalProperties': False, 'patternProperties': {'^[a-z_]+$': {'type': 'string'}}}, 'identifier': {'description': 'An identifier.', 'type': 'string'}, 'identifiers_with_scheme': {'description': 'Identifiers object with identifier value and scheme in separate keys.', 'type': 'object', 'additionalProperties': False, 'properties': {'identifier': {'$ref': '#/identifier'}, 'scheme': {'$ref': '#/scheme'}}}, 'file': {'type': 'object', 'additionalProperties': False, 'description': 'A file object.', 'properties': {'version_id': {'description': 'Object version ID.', 'type': 'string'}, 'bucket_id': {'description': 'Object verison bucket ID.', 'type': 'string'}, 'mimetype': {'description': 'File MIMEType.', 'type': 'string'}, 'uri': {'description': 'File URI.', 'type': 'string'}, 'storage_class': {'description': 'File storage class.', 'type': 'string'}, 'checksum': {'description': 'Checksum of the file.', 'type': 'string'}, 'size': {'description': 'Size of the file in bytes.', 'type': 'number'}, 'key': {'description': 'Key (filename) of the file.', 'type': 'string'}, 'file_id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}}}, 'internal-pid': {'type': 'object', 'description': 'An internal persistent identifier object.', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'description': 'Primary key of the PID object.', 'type': 'integer'}, 'status': {'description': 'The status of the PID (from Invenio-PIDStore).', 'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}, 'pid_type': {'description': 'The type of the persistent identifier.', 'type': 'string'}, 'obj_type': {'description': 'The type of the associated object.', 'type': 'string'}}}, 'scheme': {'description': 'A scheme.', 'type': 'string'}}, 'local://records/record-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', 'id': 'local://test/records/record-v1.0.0.json', 'title': 'Test Record Schema v1.0.0', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'description': 'JSONSchema declaration.', 'type': 'string'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'id': {'description': 'Persistent record identifier (alphanumeric).', 'type': 'string'}, 'pid': {'type': 'object', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'type': 'integer'}, 'status': {'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}}}, 'metadata': {'type': 'object', 'additionalProperties': False, 'properties': {'title': {'type': 'string'}, 'languages': {'type': 'array', 'items': {'type': 'object', 'properties': {'id': {'type': 'string'}}}}}}}}},
 'urljoin_cache': &lt;functools._lru_cache_wrapper object at 0x7f47eb0ad900&gt;}
        resolver   = &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47e9d317c0&gt;
        schema     = {'$ref': 'local://names/name-v1.0.0.json'}
        self       = &lt;invenio_records.ext._RecordsState object at 0x7f47e9f70da0&gt;
        validator_cls = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

instance = {'$schema': 'local://names/name-v1.0.0.json', 'affiliations': [{'name': 'CERN'}], 'family_name': 'Panero', 'given_name': 'Pablo', ...}
schema = {'$ref': 'local://names/name-v1.0.0.json'}
cls = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;, args = ()
kwargs = {'format_checker': None, 'resolver': &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47e9d317c0&gt;}
validator = Draft202012Validator(schema={'$ref': 'local://name...e-v1.0.0.json'}, format_checker=None)
error = &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;

    def validate(instance, schema, cls=None, *args, **kwargs):  # noqa: D417
        """
        Validate an instance under the given schema.
    
            &gt;&gt;&gt; validate([2, 3, 4], {"maxItems": 2})
            Traceback (most recent call last):
                ...
            ValidationError: [2, 3, 4] is too long
    
        :func:`~jsonschema.validators.validate` will first verify that the
        provided schema is itself valid, since not doing so can lead to less
        obvious error messages and fail in less obvious or consistent ways.
    
        If you know you have a valid schema already, especially
        if you intend to validate multiple instances with
        the same schema, you likely would prefer using the
        `jsonschema.protocols.Validator.validate` method directly on a
        specific validator (e.g. ``Draft202012Validator.validate``).
    
    
        Arguments:
    
            instance:
    
                The instance to validate
    
            schema:
    
                The schema to validate with
    
            cls (jsonschema.protocols.Validator):
    
                The class that will be used to validate the instance.
    
        If the ``cls`` argument is not provided, two things will happen
        in accordance with the specification. First, if the schema has a
        :kw:`$schema` keyword containing a known meta-schema [#]_ then the
        proper validator will be used. The specification recommends that
        all schemas contain :kw:`$schema` properties for this reason. If no
        :kw:`$schema` property is found, the default validator class is the
        latest released draft.
    
        Any other provided positional and keyword arguments will be passed
        on when instantiating the ``cls``.
    
        Raises:
    
            `jsonschema.exceptions.ValidationError`:
    
                if the instance is invalid
    
            `jsonschema.exceptions.SchemaError`:
    
                if the schema itself is invalid
    
        .. rubric:: Footnotes
        .. [#] known by a validator registered with
            `jsonschema.validators.validates`
    
        """
        if cls is None:
            cls = validator_for(schema)
    
        cls.check_schema(schema)
        validator = cls(schema, *args, **kwargs)
        error = exceptions.best_match(validator.iter_errors(instance))
        if error is not None:
&gt;           raise error
E           jsonschema.exceptions.ValidationError: Additional properties are not allowed ('pid' was unexpected)
E           
E           Failed validating 'additionalProperties' in schema:
E               {'$schema': 'http://json-schema.org/draft-07/schema#',
E                '$id': 'local://names/name-v1.0.0.json',
E                'description': 'Names vocabulary.',
E                'type': 'object',
E                'additionalProperties': False,
E                'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'},
E                               'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'},
E                               'scheme': {'description': 'Identifier of the name '
E                                                         'scheme.',
E                                          '$ref': 'local://definitions-v1.0.0.json#/identifier'},
E                               'name': {'type': 'string'},
E                               'given_name': {'type': 'string'},
E                               'family_name': {'type': 'string'},
E                               'identifiers': {'description': 'Identifiers for the '
E                                                              'person.',
E                                               'type': 'array',
E                                               'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'},
E                                               'uniqueItems': True},
E                               'props': {'type': 'object',
E                                         'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'},
E                                                                                  {'type': 'boolean'}]}}},
E                               'affiliations': {'description': 'Affiliations of the '
E                                                               'person.',
E                                                'type': 'array',
E                                                'items': {'type': 'object',
E                                                          'additionalProperties': False,
E                                                          'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'},
E                                                                         'name': {'type': 'string'}}},
E                                                'uniqueItems': True}}}
E           
E           On instance:
E               {'name': 'Panero, Pablo',
E                '$schema': 'local://names/name-v1.0.0.json',
E                'given_name': 'Pablo',
E                'family_name': 'Panero',
E                'identifiers': [{'identifier': '0000-0001-8135-3489',
E                                 'scheme': 'orcid'}],
E                'affiliations': [{'name': 'CERN'}],
E                'pid': '0000-0001-8135-3489'}

args       = ()
cls        = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;
error      = &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;
instance   = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'name': 'CERN'}],
 'family_name': 'Panero',
 'given_name': 'Pablo',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'}],
 'name': 'Panero, Pablo',
 'pid': '0000-0001-8135-3489'}
kwargs     = {'format_checker': None,
 'resolver': &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47e9d317c0&gt;}
schema     = {'$ref': 'local://names/name-v1.0.0.json'}
validator  = Draft202012Validator(schema={'$ref': 'local://name...e-v1.0.0.json'}, format_checker=None)

.venv/lib/python3.12/site-packages/jsonschema/validators.py:1332: ValidationError</failure></testcase><testcase classname="tests.contrib.names.test_names_datastreams" name="test_names_service_writer_update_non_existing" time="1.494" /><testcase classname="tests.contrib.names.test_names_jsonschema" name="ISORT" time="0.018" /><testcase classname="tests.contrib.names.test_names_jsonschema" name="black" time="0.181" /><testcase classname="tests.contrib.names.test_names_jsonschema" name="test_valid_full" time="0.826" /><testcase classname="tests.contrib.names.test_names_jsonschema" name="test_valid_empty" time="0.003" /><testcase classname="tests.contrib.names.test_names_jsonschema" name="test_fails_name_identifiers" time="0.005" /><testcase classname="tests.contrib.names.test_names_jsonschema" name="test_fails_name_affiliations" time="0.005" /><testcase classname="tests.contrib.names.test_names_resource" name="ISORT" time="0.035" /><testcase classname="tests.contrib.names.test_names_resource" name="black" time="0.206" /><testcase classname="tests.contrib.names.test_names_resource" name="test_non_authenticated" time="2.990" /><testcase classname="tests.contrib.names.test_names_resource" name="test_names_invalid" time="0.073" /><testcase classname="tests.contrib.names.test_names_resource" name="test_names_forbidden" time="1.224" /><testcase classname="tests.contrib.names.test_names_resource" name="test_names_get" time="1.276" /><testcase classname="tests.contrib.names.test_names_resource" name="test_names_search" time="1.226" /><testcase classname="tests.contrib.names.test_names_resource" name="test_names_resolve" time="1.225" /><testcase classname="tests.contrib.names.test_names_resource" name="test_names_suggest_sort" time="1.707" /><testcase classname="tests.contrib.names.test_names_schema" name="ISORT" time="0.019" /><testcase classname="tests.contrib.names.test_names_schema" name="black" time="0.182" /><testcase classname="tests.contrib.names.test_names_schema" name="test_valid_full" time="1.839" /><testcase classname="tests.contrib.names.test_names_schema" name="test_valid_minimal" time="0.003" /><testcase classname="tests.contrib.names.test_names_schema" name="test_invalid_no_names" time="0.006" /><testcase classname="tests.contrib.names.test_names_schema" name="test_duplicated_affiliations" time="0.303" /><testcase classname="tests.contrib.names.test_names_service" name="ISORT" time="0.029" /><testcase classname="tests.contrib.names.test_names_service" name="black" time="0.201" /><testcase classname="tests.contrib.names.test_names_service" name="test_simple_flow" time="1.992"><failure message="jsonschema.exceptions.ValidationError: Additional properties are not allowed ('pid' was unexpected)&#10;&#10;Failed validating 'additionalProperties' in schema:&#10;    {'$schema': 'http://json-schema.org/draft-07/schema#',&#10;     '$id': 'local://names/name-v1.0.0.json',&#10;     'description': 'Names vocabulary.',&#10;     'type': 'object',&#10;     'additionalProperties': False,&#10;     'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'},&#10;                    'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'},&#10;                    'scheme': {'description': 'Identifier of the name '&#10;                                              'scheme.',&#10;                               '$ref': 'local://definitions-v1.0.0.json#/identifier'},&#10;                    'name': {'type': 'string'},&#10;                    'given_name': {'type': 'string'},&#10;                    'family_name': {'type': 'string'},&#10;                    'identifiers': {'description': 'Identifiers for the '&#10;                                                   'person.',&#10;                                    'type': 'array',&#10;                                    'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'},&#10;                                    'uniqueItems': True},&#10;                    'props': {'type': 'object',&#10;                              'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'},&#10;                                                                       {'type': 'boolean'}]}}},&#10;                    'affiliations': {'description': 'Affiliations of the '&#10;                                                    'person.',&#10;                                     'type': 'array',&#10;                                     'items': {'type': 'object',&#10;                                               'additionalProperties': False,&#10;                                               'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'},&#10;                                                              'name': {'type': 'string'}}},&#10;                                     'uniqueItems': True}}}&#10;&#10;On instance:&#10;    {'name': 'Doe, Jane',&#10;     '$schema': 'local://names/name-v1.0.0.json',&#10;     'given_name': 'Jane',&#10;     'family_name': 'Doe',&#10;     'identifiers': [{'identifier': '0000-0001-8135-3489',&#10;                      'scheme': 'orcid'},&#10;                     {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],&#10;     'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}],&#10;     'pid': '0000-0001-8135-3489'}">app = &lt;Flask 'invenio'&gt;
service = &lt;invenio_vocabularies.contrib.names.services.NamesService object at 0x7f47e9850f80&gt;
identity = &lt;Identity id="1" auth_type="None" provides={Need(method='system_role', value='system_process'), Need(method='system_role', value='any_user'), Need(method='id', value=1)}&gt;
name_full_data = {'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}], 'family_name': 'Doe', 'given_name': 'John', 'id': '0000-0001-8135-3489', ...}
example_affiliation = &lt;invenio_records_resources.services.records.results.RecordItem object at 0x7f47e95fdf10&gt;

    def test_simple_flow(app, service, identity, name_full_data, example_affiliation):
        """Test a simple vocabulary service flow."""
        # Service
        assert service.id == "names"
        assert service.config.indexer_queue_name == "names"
    
        # Create it
        item = service.create(identity, name_full_data)
    
        id_ = item.id
    
        # add dereferenced values
        expected_data = deepcopy(name_full_data)
        expected_data["affiliations"][0][
            "name"
        ] = "European Organization for Nuclear Research"
    
        for k, v in expected_data.items():
            assert item.data[k] == v
    
        # Read it
        read_item = service.read(identity, id_)
        assert item.id == read_item.id
        assert item.data == read_item.data
    
        # Refresh index to make changes live.
        Name.index.refresh()
    
        # Search it
        res = service.search(identity, q=f"id:{id_}", size=25, page=1)
        assert res.total == 1
        assert list(res.hits)[0] == read_item.data
    
        # Update it
        data = read_item.data
        data["given_name"] = "Jane"
&gt;       update_item = service.update(identity, id_, data)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

app        = &lt;Flask 'invenio'&gt;
data       = {'affiliations': [{'id': 'cern',
                   'name': 'European Organization for Nuclear Research'},
                  {'name': 'CustomORG'}],
 'created': '2025-11-18T12:44:44.914207+00:00',
 'family_name': 'Doe',
 'given_name': 'Jane',
 'id': '0000-0001-8135-3489',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                 {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
 'internal_id': None,
 'links': {'self': 'https://127.0.0.1:5000/api/names/0000-0001-8135-3489'},
 'name': 'Doe, John',
 'revision_id': 3,
 'updated': '2025-11-18T12:44:44.927443+00:00'}
example_affiliation = &lt;invenio_records_resources.services.records.results.RecordItem object at 0x7f47e95fdf10&gt;
expected_data = {'affiliations': [{'id': 'cern',
                   'name': 'European Organization for Nuclear Research'},
                  {'name': 'CustomORG'}],
 'family_name': 'Doe',
 'given_name': 'John',
 'id': '0000-0001-8135-3489',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                 {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
 'name': 'Doe, John'}
id_        = '0000-0001-8135-3489'
identity   = &lt;Identity id="1" auth_type="None" provides={Need(method='system_role', value='system_process'), Need(method='system_role', value='any_user'), Need(method='id', value=1)}&gt;
item       = &lt;invenio_records_resources.services.records.results.RecordItem object at 0x7f47e95ffd10&gt;
k          = 'affiliations'
name_full_data = {'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}],
 'family_name': 'Doe',
 'given_name': 'John',
 'id': '0000-0001-8135-3489',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                 {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
 'name': 'Doe, John'}
read_item  = &lt;invenio_records_resources.services.records.results.RecordItem object at 0x7f47e992cc20&gt;
res        = &lt;invenio_records_resources.services.records.results.RecordList object at 0x7f47e961e840&gt;
service    = &lt;invenio_vocabularies.contrib.names.services.NamesService object at 0x7f47e9850f80&gt;
v          = [{'id': 'cern', 'name': 'European Organization for Nuclear Research'},
 {'name': 'CustomORG'}]

tests/contrib/names/test_names_service.py:58: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.venv/lib/python3.12/site-packages/invenio_db/uow.py:251: in inner
    res = f(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^
        args       = (&lt;Identity id="1" auth_type="None" provides={Need(method='system_role', value='system_process'), Need(method='system_role', value='any_user'), Need(method='id', value=1)}&gt;,
 '0000-0001-8135-3489',
 {'affiliations': [{'id': 'cern',
                    'name': 'European Organization for Nuclear Research'},
                   {'name': 'CustomORG'}],
  'created': '2025-11-18T12:44:44.914207+00:00',
  'family_name': 'Doe',
  'given_name': 'Jane',
  'id': '0000-0001-8135-3489',
  'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                  {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
  'internal_id': None,
  'links': {'self': 'https://127.0.0.1:5000/api/names/0000-0001-8135-3489'},
  'name': 'Doe, John',
  'revision_id': 3,
  'updated': '2025-11-18T12:44:44.927443+00:00'})
        f          = &lt;function RecordService.update at 0x7f47ef60f6a0&gt;
        kwargs     = {'uow': &lt;invenio_db.uow.UnitOfWork object at 0x7f47e9751eb0&gt;}
        self       = &lt;invenio_vocabularies.contrib.names.services.NamesService object at 0x7f47e9850f80&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47e9751eb0&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/records/service.py:495: in update
    uow.register(RecordCommitOp(record, self.indexer))
        _          = []
        data       = {'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}],
 'family_name': 'Doe',
 'given_name': 'Jane',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                 {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
 'name': 'Doe, Jane',
 'pid': '0000-0001-8135-3489'}
        expand     = False
        id_        = '0000-0001-8135-3489'
        identity   = &lt;Identity id="1" auth_type="None" provides={Need(method='system_role', value='system_process'), Need(method='system_role', value='any_user'), Need(method='id', value=1)}&gt;
        record     = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}],
 'family_name': 'Doe',
 'given_name': 'Jane',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                 {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
 'name': 'Doe, Jane',
 'pid': '0000-0001-8135-3489'}
        revision_id = None
        self       = &lt;invenio_vocabularies.contrib.names.services.NamesService object at 0x7f47e9850f80&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47e9751eb0&gt;
.venv/lib/python3.12/site-packages/invenio_db/uow.py:224: in register
    op.on_register(self)
        op         = &lt;invenio_records_resources.services.uow.RecordCommitOp object at 0x7f47e961d310&gt;
        self       = &lt;invenio_db.uow.UnitOfWork object at 0x7f47e9751eb0&gt;
.venv/lib/python3.12/site-packages/invenio_records_resources/services/uow.py:136: in on_register
    self._record.commit()
        self       = &lt;invenio_records_resources.services.uow.RecordCommitOp object at 0x7f47e961d310&gt;
        uow        = &lt;invenio_db.uow.UnitOfWork object at 0x7f47e9751eb0&gt;
.venv/lib/python3.12/site-packages/invenio_records/api.py:454: in commit
    json = self._validate(format_checker=format_checker, validator=validator)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        e          = &lt;invenio_records.systemfields.base.SystemFieldsExt object at 0x7f47ee5c7380&gt;
        format_checker = None
        kwargs     = {}
        self       = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}],
 'family_name': 'Doe',
 'given_name': 'Jane',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                 {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
 'name': 'Doe, Jane',
 'pid': '0000-0001-8135-3489'}
        validator  = None
.venv/lib/python3.12/site-packages/invenio_records/api.py:194: in _validate
    _records_state.validate(
        format_checker = None
        json       = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}],
 'family_name': 'Doe',
 'given_name': 'Jane',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                 {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
 'name': 'Doe, Jane',
 'pid': '0000-0001-8135-3489'}
        self       = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}],
 'family_name': 'Doe',
 'given_name': 'Jane',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                 {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
 'name': 'Doe, Jane',
 'pid': '0000-0001-8135-3489'}
        use_model  = False
        validator  = None
.venv/lib/python3.12/site-packages/invenio_records/ext.py:67: in validate
    return validate(data, schema, cls=validator_cls, resolver=resolver, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        data       = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}],
 'family_name': 'Doe',
 'given_name': 'Jane',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                 {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
 'name': 'Doe, Jane',
 'pid': '0000-0001-8135-3489'}
        kwargs     = {'format_checker': None}
        refresolver_cls_kwargs = {'store': {'local://affiliations/affiliation-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://affiliations/affiliation-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'country': {'type': 'string', 'description': "Represents a affiliation's country as a country code."}, 'country_name': {'type': 'string', 'description': "Represents a affiliation's country as a full name."}, 'location_name': {'type': 'string', 'description': "Represents a affiliation's location name (usually a city)."}, 'acronym': {'type': 'string'}, 'identifiers': {'description': 'Alternate identifiers for the record.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'status': {'type': 'string', 'description': 'Status of the affiliation organization.'}, 'aliases': {'description': 'Alternate names for the affiliation.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'types': {'description': 'Types of affiliation organization.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'name': {'type': 'string'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}, 'local://awards/award-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://awards/award-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'identifiers': {'description': 'Alternate identifiers for the award.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'number': {'type': 'string'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'funder': {'description': "Award's funder.", 'type': 'object', 'additionalProperties': False, 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}}}, 'acronym': {'type': 'string'}, 'program': {'type': 'string'}, 'start_date': {'type': 'string'}, 'end_date': {'type': 'string'}, 'description': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/description'}, 'subjects': {'description': "Award's subjects.", 'type': 'array', 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'subject': {'description': 'Human readable label.', 'type': 'string'}}}, 'organizations': {'description': "Award's organizations.", 'type': 'array', 'items': {'type': 'object', 'additionalProperties': False, 'properties': {'scheme': {'description': 'Identifier of the organization scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'id': {'description': 'Identifier of the organization for the given scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'organization': {'description': 'Human readable label.', 'type': 'string'}}}}}}, 'local://funders/funder-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://funders/funder-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'country': {'type': 'string', 'description': "Represents a funder's origin country as a country code."}, 'country_name': {'type': 'string', 'description': "Represents a funder's origin country as a full name."}, 'location_name': {'type': 'string', 'description': "Represents a funder's location name (usually a city)."}, 'identifiers': {'description': 'Alternate identifiers for the record.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'name': {'type': 'string', 'description': 'Funders name.'}, 'acronym': {'type': 'string', 'description': 'Acronym for funders name.'}, 'status': {'type': 'string', 'description': 'Status of the funder.'}, 'aliases': {'description': 'Alternate names for the funder.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'types': {'description': 'Types of funders.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}}}, 'local://vocabularies/definitions-v1.0.0.json': {'title': {'type': 'object', 'description': 'Title of vocabulary item. Keys are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'description': {'type': 'object', 'description': 'Description of vocabulary item. Keys are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'icon': {'type': 'string'}, 'tags': {'type': 'array', 'description': 'Tags for a vocabulary item.', 'items': {'type': 'string'}}}, 'local://vocabularies/vocabulary-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://vocabularies/vocabulary-v1.0.0.json', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'description': {'type': 'object', 'description': 'Description of vocabulary item. Key are locale codes.', 'patternProperties': {'^[a-z]{2}$': {'type': 'string'}}}, 'icon': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/icon'}, 'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'pid': {'$ref': 'local://definitions-v1.0.0.json#/internal-pid'}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'type': 'string'}}}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'title': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'type': {'type': 'object', 'additionalProperties': False, 'properties': {'id': {'type': 'string'}, 'pid_type': {'type': 'string'}}}}}, 'local://names/name-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://names/name-v1.0.0.json', 'description': 'Names vocabulary.', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'scheme': {'description': 'Identifier of the name scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}, 'given_name': {'type': 'string'}, 'family_name': {'type': 'string'}, 'identifiers': {'description': 'Identifiers for the person.', 'type': 'array', 'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'}, {'type': 'boolean'}]}}}, 'affiliations': {'description': 'Affiliations of the person.', 'type': 'array', 'items': {'type': 'object', 'additionalProperties': False, 'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'name': {'type': 'string'}}}, 'uniqueItems': True}}}, 'local://subjects/subject-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', '$id': 'local://subjects/subject-v1.0.0.json', 'description': 'Subjects from specific vocabularies.', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'id': {'description': 'URI or classification code as identifier - globally unique among all subject schemes.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'pid': {'$ref': 'local://definitions-v1.0.0.json#/internal-pid'}, 'scheme': {'description': 'Identifier of the subject scheme.', '$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'subject': {'description': 'Human readable label.', 'type': 'string'}, 'title': {'description': 'Human readable label in different languages.', '$ref': 'local://vocabularies/definitions-v1.0.0.json#/title'}, 'props': {'type': 'object', 'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'}, {'type': 'array', 'items': {'type': 'string'}}]}}, 'additionalProperties': False}, 'identifiers': {'description': 'Alternate identifiers for the subject.', 'type': 'array', 'items': {'$ref': 'local://definitions-v2.0.0.json#/identifiers_with_scheme'}, 'uniqueItems': True}, 'synonyms': {'description': 'Synonyms of the subject label.', 'type': 'array', 'items': {'type': 'string'}, 'uniqueItems': True}}}, 'local://definitions-v2.0.0.json': {'$schema': {'type': 'string'}, 'entity_reference': {'description': 'Reference to an entity, with the type as key and ID as value', 'type': ['object', 'null'], 'additionalProperties': False, 'patternProperties': {'^[a-z_]+$': {'type': 'string'}}}, 'identifier': {'description': 'An identifier.', 'type': 'string'}, 'identifiers_with_scheme': {'description': 'Identifiers object with identifier value and scheme in separate keys.', 'type': 'object', 'additionalProperties': False, 'properties': {'identifier': {'$ref': '#/identifier'}, 'scheme': {'$ref': '#/scheme'}}}, 'files': {'type': 'object', 'description': 'A file storage for a record.', 'properties': {'enabled': {'description': 'Flag to determine if files are enabled.', 'type': 'boolean'}, 'default_preview': {'description': 'File to preview by default.', 'type': 'string'}, 'order': {'description': 'Order of files.', 'type': 'array', 'items': {'type': 'string'}}, 'count': {'description': 'Number of files.', 'type': 'number'}, 'mimetypes': {'description': 'MIME Types of files.', 'type': 'array', 'items': {'type': 'string'}}, 'totalbytes': {'description': 'Total size of all files.', 'type': 'number'}, 'types': {'description': 'File extensions.', 'type': 'array', 'items': {'type': 'string'}}, 'entries': {'description': 'List of files.', 'type': 'object', 'patternProperties': {'.+': {'$ref': 'local://definitions-v2.0.0.json#/file'}}, 'additionalProperties': False}}}, 'files-simple': {'type': 'object', 'description': 'A file storage for a record.', 'properties': {'enabled': {}, 'default_preview': {}, 'order': {}}}, 'file': {'type': 'object', 'additionalProperties': False, 'description': 'A file object.', 'properties': {'uuid': {'description': 'File record ID.', 'type': 'string'}, 'version_id': {'description': 'File record version ID.', 'type': 'number'}, 'object_version_id': {'description': 'Object version identifier.', 'type': 'string'}, 'file_id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}, 'metadata': {'description': 'File metadata.', 'type': 'object', 'additionalProperties': True}, 'mimetype': {'description': 'File MIMEType.', 'type': 'string'}, 'checksum': {'description': 'Checksum of the file.', 'type': 'string'}, 'ext': {'description': 'Checksum of the file.', 'type': 'string'}, 'size': {'description': 'Size of the file in bytes.', 'type': 'number'}, 'key': {'description': 'Key (filename) of the file.', 'type': 'string'}, 'access': {'description': 'Access properties of the file.', 'type': 'object', 'additionalProperties': False, 'properties': {'hidden': {'description': 'Control whether to hide the file in the UI.', 'type': 'boolean'}}}}}, 'internal-pid': {'type': 'object', 'description': 'An internal persistent identifier object.', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'description': 'Primary key of the PID object.', 'type': 'integer'}, 'status': {'description': 'The status of the PID (from Invenio-PIDStore).', 'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}, 'pid_type': {'description': 'The type of the persistent identifier.', 'type': 'string'}, 'obj_type': {'description': 'The type of the associated object.', 'type': 'string'}}}, 'scheme': {'description': 'A scheme.', 'type': 'string'}}, 'local://definitions-v1.0.0.json': {'$schema': {'type': 'string'}, 'entity_reference': {'description': 'Reference to an entity, with the type as key and ID as value', 'type': ['object', 'null'], 'additionalProperties': False, 'patternProperties': {'^[a-z_]+$': {'type': 'string'}}}, 'identifier': {'description': 'An identifier.', 'type': 'string'}, 'identifiers_with_scheme': {'description': 'Identifiers object with identifier value and scheme in separate keys.', 'type': 'object', 'additionalProperties': False, 'properties': {'identifier': {'$ref': '#/identifier'}, 'scheme': {'$ref': '#/scheme'}}}, 'file': {'type': 'object', 'additionalProperties': False, 'description': 'A file object.', 'properties': {'version_id': {'description': 'Object version ID.', 'type': 'string'}, 'bucket_id': {'description': 'Object verison bucket ID.', 'type': 'string'}, 'mimetype': {'description': 'File MIMEType.', 'type': 'string'}, 'uri': {'description': 'File URI.', 'type': 'string'}, 'storage_class': {'description': 'File storage class.', 'type': 'string'}, 'checksum': {'description': 'Checksum of the file.', 'type': 'string'}, 'size': {'description': 'Size of the file in bytes.', 'type': 'number'}, 'key': {'description': 'Key (filename) of the file.', 'type': 'string'}, 'file_id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'}}}, 'internal-pid': {'type': 'object', 'description': 'An internal persistent identifier object.', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'description': 'Primary key of the PID object.', 'type': 'integer'}, 'status': {'description': 'The status of the PID (from Invenio-PIDStore).', 'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}, 'pid_type': {'description': 'The type of the persistent identifier.', 'type': 'string'}, 'obj_type': {'description': 'The type of the associated object.', 'type': 'string'}}}, 'scheme': {'description': 'A scheme.', 'type': 'string'}}, 'local://records/record-v1.0.0.json': {'$schema': 'http://json-schema.org/draft-07/schema#', 'id': 'local://test/records/record-v1.0.0.json', 'title': 'Test Record Schema v1.0.0', 'type': 'object', 'additionalProperties': False, 'properties': {'$schema': {'description': 'JSONSchema declaration.', 'type': 'string'}, 'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'}, 'id': {'description': 'Persistent record identifier (alphanumeric).', 'type': 'string'}, 'pid': {'type': 'object', 'additionalProperties': False, 'required': ['pk', 'status'], 'properties': {'pk': {'type': 'integer'}, 'status': {'type': 'string', 'enum': ['N', 'K', 'R', 'M', 'D']}}}, 'metadata': {'type': 'object', 'additionalProperties': False, 'properties': {'title': {'type': 'string'}, 'languages': {'type': 'array', 'items': {'type': 'object', 'properties': {'id': {'type': 'string'}}}}}}}}},
 'urljoin_cache': &lt;functools._lru_cache_wrapper object at 0x7f47ec0b24b0&gt;}
        resolver   = &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47e961d3d0&gt;
        schema     = {'$ref': 'local://names/name-v1.0.0.json'}
        self       = &lt;invenio_records.ext._RecordsState object at 0x7f47e98910a0&gt;
        validator_cls = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

instance = {'$schema': 'local://names/name-v1.0.0.json', 'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}], 'family_name': 'Doe', 'given_name': 'Jane', ...}
schema = {'$ref': 'local://names/name-v1.0.0.json'}
cls = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;, args = ()
kwargs = {'format_checker': None, 'resolver': &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47e961d3d0&gt;}
validator = Draft202012Validator(schema={'$ref': 'local://name...e-v1.0.0.json'}, format_checker=None)
error = &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;

    def validate(instance, schema, cls=None, *args, **kwargs):  # noqa: D417
        """
        Validate an instance under the given schema.
    
            &gt;&gt;&gt; validate([2, 3, 4], {"maxItems": 2})
            Traceback (most recent call last):
                ...
            ValidationError: [2, 3, 4] is too long
    
        :func:`~jsonschema.validators.validate` will first verify that the
        provided schema is itself valid, since not doing so can lead to less
        obvious error messages and fail in less obvious or consistent ways.
    
        If you know you have a valid schema already, especially
        if you intend to validate multiple instances with
        the same schema, you likely would prefer using the
        `jsonschema.protocols.Validator.validate` method directly on a
        specific validator (e.g. ``Draft202012Validator.validate``).
    
    
        Arguments:
    
            instance:
    
                The instance to validate
    
            schema:
    
                The schema to validate with
    
            cls (jsonschema.protocols.Validator):
    
                The class that will be used to validate the instance.
    
        If the ``cls`` argument is not provided, two things will happen
        in accordance with the specification. First, if the schema has a
        :kw:`$schema` keyword containing a known meta-schema [#]_ then the
        proper validator will be used. The specification recommends that
        all schemas contain :kw:`$schema` properties for this reason. If no
        :kw:`$schema` property is found, the default validator class is the
        latest released draft.
    
        Any other provided positional and keyword arguments will be passed
        on when instantiating the ``cls``.
    
        Raises:
    
            `jsonschema.exceptions.ValidationError`:
    
                if the instance is invalid
    
            `jsonschema.exceptions.SchemaError`:
    
                if the schema itself is invalid
    
        .. rubric:: Footnotes
        .. [#] known by a validator registered with
            `jsonschema.validators.validates`
    
        """
        if cls is None:
            cls = validator_for(schema)
    
        cls.check_schema(schema)
        validator = cls(schema, *args, **kwargs)
        error = exceptions.best_match(validator.iter_errors(instance))
        if error is not None:
&gt;           raise error
E           jsonschema.exceptions.ValidationError: Additional properties are not allowed ('pid' was unexpected)
E           
E           Failed validating 'additionalProperties' in schema:
E               {'$schema': 'http://json-schema.org/draft-07/schema#',
E                '$id': 'local://names/name-v1.0.0.json',
E                'description': 'Names vocabulary.',
E                'type': 'object',
E                'additionalProperties': False,
E                'properties': {'$schema': {'$ref': 'local://definitions-v1.0.0.json#/$schema'},
E                               'tags': {'$ref': 'local://vocabularies/definitions-v1.0.0.json#/tags'},
E                               'scheme': {'description': 'Identifier of the name '
E                                                         'scheme.',
E                                          '$ref': 'local://definitions-v1.0.0.json#/identifier'},
E                               'name': {'type': 'string'},
E                               'given_name': {'type': 'string'},
E                               'family_name': {'type': 'string'},
E                               'identifiers': {'description': 'Identifiers for the '
E                                                              'person.',
E                                               'type': 'array',
E                                               'items': {'$ref': 'local://definitions-v1.0.0.json#/identifiers_with_scheme'},
E                                               'uniqueItems': True},
E                               'props': {'type': 'object',
E                                         'patternProperties': {'^.*$': {'oneOf': [{'type': 'string'},
E                                                                                  {'type': 'boolean'}]}}},
E                               'affiliations': {'description': 'Affiliations of the '
E                                                               'person.',
E                                                'type': 'array',
E                                                'items': {'type': 'object',
E                                                          'additionalProperties': False,
E                                                          'properties': {'id': {'$ref': 'local://definitions-v1.0.0.json#/identifier'},
E                                                                         'name': {'type': 'string'}}},
E                                                'uniqueItems': True}}}
E           
E           On instance:
E               {'name': 'Doe, Jane',
E                '$schema': 'local://names/name-v1.0.0.json',
E                'given_name': 'Jane',
E                'family_name': 'Doe',
E                'identifiers': [{'identifier': '0000-0001-8135-3489',
E                                 'scheme': 'orcid'},
E                                {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
E                'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}],
E                'pid': '0000-0001-8135-3489'}

args       = ()
cls        = &lt;class 'jsonschema.validators.Draft202012Validator'&gt;
error      = &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;
instance   = {'$schema': 'local://names/name-v1.0.0.json',
 'affiliations': [{'id': 'cern'}, {'name': 'CustomORG'}],
 'family_name': 'Doe',
 'given_name': 'Jane',
 'identifiers': [{'identifier': '0000-0001-8135-3489', 'scheme': 'orcid'},
                 {'identifier': 'gnd:4079154-3', 'scheme': 'gnd'}],
 'name': 'Doe, Jane',
 'pid': '0000-0001-8135-3489'}
kwargs     = {'format_checker': None,
 'resolver': &lt;invenio_records.resolver.InvenioRefResolver object at 0x7f47e961d3d0&gt;}
schema     = {'$ref': 'local://names/name-v1.0.0.json'}
validator  = Draft202012Validator(schema={'$ref': 'local://name...e-v1.0.0.json'}, format_checker=None)

.venv/lib/python3.12/site-packages/jsonschema/validators.py:1332: ValidationError</failure></testcase><testcase classname="tests.contrib.names.test_names_service" name="test_extra_fields" time="0.016" /><testcase classname="tests.contrib.names.test_names_service" name="test_identifier_resolution" time="1.239" /><testcase classname="tests.contrib.names.test_names_service" name="test_names_dereferenced" time="1.165" /><testcase classname="tests.contrib.names.test_names_service" name="test_indexed_at_query" time="0.439" /><testcase classname="tests.contrib.subjects.conftest" name="PYDOCSTYLE" time="0.006" /><testcase classname="tests.contrib.subjects.conftest" name="ISORT" time="0.014" /><testcase classname="tests.contrib.subjects.conftest" name="black" time="0.179" /><testcase classname="tests.contrib.subjects.euroscivoc.test_subjects_euroscivoc_datastream" name="ISORT" time="0.035" /><testcase classname="tests.contrib.subjects.euroscivoc.test_subjects_euroscivoc_datastream" name="black" time="0.201" /><testcase classname="tests.contrib.subjects.euroscivoc.test_subjects_euroscivoc_datastream" name="test_euroscivoc_subjects_transformer_pref_label" time="0.021" /><testcase classname="tests.contrib.subjects.euroscivoc.test_subjects_euroscivoc_datastream" name="test_euroscivoc_subjects_transformer_alt_label" time="0.004" /><testcase classname="tests.contrib.subjects.gemet.test_subjects_gemet_datastream" name="ISORT" time="0.021" /><testcase classname="tests.contrib.subjects.gemet.test_subjects_gemet_datastream" name="black" time="0.186" /><testcase classname="tests.contrib.subjects.gemet.test_subjects_gemet_datastream" name="test_gemet_concept_transformer_pref_label" time="0.004" /><testcase classname="tests.contrib.subjects.nvs.test_subjects_nvs_datastream" name="ISORT" time="0.026" /><testcase classname="tests.contrib.subjects.nvs.test_subjects_nvs_datastream" name="black" time="0.187" /><testcase classname="tests.contrib.subjects.nvs.test_subjects_nvs_datastream" name="test_nvs_transformer_pref_label" time="0.004" /><testcase classname="tests.contrib.subjects.nvs.test_subjects_nvs_datastream" name="test_nvs_transformer_missing_id" time="0.002" /><testcase classname="tests.contrib.subjects.test_subjects_api" name="ISORT" time="0.017" /><testcase classname="tests.contrib.subjects.test_subjects_api" name="black" time="0.177" /><testcase classname="tests.contrib.subjects.test_subjects_api" name="test_subject_indexing" time="2.096" /><testcase classname="tests.contrib.subjects.test_subjects_api" name="test_subject_pid" time="0.312" /><testcase classname="tests.contrib.subjects.test_subjects_datastreams" name="ISORT" time="0.024" /><testcase classname="tests.contrib.subjects.test_subjects_datastreams" name="black" time="0.186" /><testcase classname="tests.contrib.subjects.test_subjects_datastreams" name="test_subjects_service_writer_create" time="2.846" /><testcase classname="tests.contrib.subjects.test_subjects_datastreams" name="test_subjects_service_writer_duplicate" time="1.119" /><testcase classname="tests.contrib.subjects.test_subjects_datastreams" name="test_subjects_service_writer_update_existing" time="1.167" /><testcase classname="tests.contrib.subjects.test_subjects_datastreams" name="test_subjects_service_writer_update_non_existing" time="1.398" /><testcase classname="tests.contrib.subjects.test_subjects_facets" name="ISORT" time="0.015" /><testcase classname="tests.contrib.subjects.test_subjects_facets" name="black" time="0.208" /><testcase classname="tests.contrib.subjects.test_subjects_facets" name="test_subjects_label_duplicates" time="0.001" /><testcase classname="tests.contrib.subjects.test_subjects_facets" name="test_subjects_label_empty" time="0.001" /><testcase classname="tests.contrib.subjects.test_subjects_jsonschema" name="ISORT" time="0.016" /><testcase classname="tests.contrib.subjects.test_subjects_jsonschema" name="black" time="0.177" /><testcase classname="tests.contrib.subjects.test_subjects_jsonschema" name="test_valid_full" time="0.828" /><testcase classname="tests.contrib.subjects.test_subjects_jsonschema" name="test_valid_empty" time="0.003" /><testcase classname="tests.contrib.subjects.test_subjects_jsonschema" name="test_fails_scheme" time="0.003" /><testcase classname="tests.contrib.subjects.test_subjects_jsonschema" name="test_fails_name" time="0.004" /><testcase classname="tests.contrib.subjects.test_subjects_resource" name="ISORT" time="0.031" /><testcase classname="tests.contrib.subjects.test_subjects_resource" name="black" time="0.200" /><testcase classname="tests.contrib.subjects.test_subjects_resource" name="test_get" time="2.803" /><testcase classname="tests.contrib.subjects.test_subjects_resource" name="test_get_invalid" time="0.014" /><testcase classname="tests.contrib.subjects.test_subjects_resource" name="test_forbidden_endpoints" time="1.158" /><testcase classname="tests.contrib.subjects.test_subjects_resource" name="test_search" time="1.081" /><testcase classname="tests.contrib.subjects.test_subjects_resource" name="test_suggest" time="1.635" /><testcase classname="tests.contrib.subjects.test_subjects_schema" name="ISORT" time="0.013" /><testcase classname="tests.contrib.subjects.test_subjects_schema" name="black" time="0.169" /><testcase classname="tests.contrib.subjects.test_subjects_schema" name="test_valid_full" time="1.711" /><testcase classname="tests.contrib.subjects.test_subjects_schema" name="test_invalid_missing_field" time="0.290" /><testcase classname="tests.contrib.subjects.test_subjects_service" name="ISORT" time="0.018" /><testcase classname="tests.contrib.subjects.test_subjects_service" name="black" time="0.179" /><testcase classname="tests.contrib.subjects.test_subjects_service" name="test_subject_simple_flow" time="1.907" /><testcase classname="tests.contrib.subjects.test_subjects_service" name="test_indexed_at_query" time="0.394" /><testcase classname="tests.custom_fields.test_custom_fields" name="ISORT" time="0.025" /><testcase classname="tests.custom_fields.test_custom_fields" name="black" time="0.194" /><testcase classname="tests.custom_fields.test_custom_fields" name="test_relation_cls" time="0.001" /><testcase classname="tests.custom_fields.test_custom_fields" name="test_cf_mapping" time="0.001" /><testcase classname="tests.custom_fields.test_custom_fields" name="test_field_load" time="0.003" /><testcase classname="tests.custom_fields.test_custom_fields" name="test_field_dump" time="0.001" /><testcase classname="tests.custom_fields.test_custom_fields" name="test_ui_field_dump" time="1.823" /><testcase classname="tests.custom_fields.test_custom_fields" name="test_options" time="0.228" /><testcase classname="tests.custom_fields.test_custom_fields" name="test_vocab_field_required" time="0.002" /><testcase classname="tests.custom_fields.test_custom_fields" name="test_vocab_ui_field_required" time="0.309" /><testcase classname="tests.datastreams.conftest" name="PYDOCSTYLE" time="0.015" /><testcase classname="tests.datastreams.conftest" name="ISORT" time="0.029" /><testcase classname="tests.datastreams.conftest" name="black" time="0.190" /><testcase classname="tests.datastreams.test_datastreams" name="ISORT" time="0.028" /><testcase classname="tests.datastreams.test_datastreams" name="black" time="0.198" /><testcase classname="tests.datastreams.test_datastreams" name="test_base_datastream" time="1.845" /><testcase classname="tests.datastreams.test_datastreams" name="test_base_datastream_fail_on_write" time="0.010" /><testcase classname="tests.datastreams.test_datastreams" name="test_piping_readers" time="0.365" /><testcase classname="tests.datastreams.test_datastreams_tasks" name="ISORT" time="0.013" /><testcase classname="tests.datastreams.test_datastreams_tasks" name="black" time="0.178" /><testcase classname="tests.datastreams.test_datastreams_tasks" name="test_write_entry" time="1.770" /><testcase classname="tests.datastreams.test_datastreams_tasks" name="test_write_many_entry" time="0.303" /><testcase classname="tests.datastreams.test_fixtures" name="ISORT" time="0.012" /><testcase classname="tests.datastreams.test_fixtures" name="black" time="0.173" /><testcase classname="tests.datastreams.test_fixtures" name="test_base_fixture" time="2.157" /><testcase classname="tests.datastreams.test_readers" name="ISORT" time="0.066" /><testcase classname="tests.datastreams.test_readers" name="black" time="0.238" /><testcase classname="tests.datastreams.test_readers" name="test_yaml_reader" time="0.004" /><testcase classname="tests.datastreams.test_readers" name="test_tar_reader" time="0.007" /><testcase classname="tests.datastreams.test_readers" name="test_tar_reader_item_tarfile_instance" time="0.005" /><testcase classname="tests.datastreams.test_readers" name="test_tar_reader_item_bytesio_not_tarfile_instance" time="0.005" /><testcase classname="tests.datastreams.test_readers" name="test_zip_reader" time="0.003" /><testcase classname="tests.datastreams.test_readers" name="test_zip_reader_item_zipfile_instance" time="0.002" /><testcase classname="tests.datastreams.test_readers" name="test_zip_reader_item_bytesio_not_zipfile_instance" time="0.002" /><testcase classname="tests.datastreams.test_readers" name="test_json_list_reader" time="0.001" /><testcase classname="tests.datastreams.test_readers" name="test_json_element_reader" time="0.001" /><testcase classname="tests.datastreams.test_readers" name="test_oaipmh_reader" time="2.127" /><testcase classname="tests.datastreams.test_readers" name="test_oaipmh_reader_list_identifiers" time="0.032" /><testcase classname="tests.datastreams.test_readers" name="test_oaipmh_reader_no_records_match" time="0.340" /><testcase classname="tests.datastreams.test_transformers" name="ISORT" time="0.021" /><testcase classname="tests.datastreams.test_transformers" name="black" time="0.194" /><testcase classname="tests.datastreams.test_transformers" name="test_xml_transformer" time="0.001" /><testcase classname="tests.datastreams.test_transformers" name="test_bad_xml_transformer" time="0.001" /><testcase classname="tests.datastreams.test_writers" name="ISORT" time="0.033" /><testcase classname="tests.datastreams.test_writers" name="black" time="0.205" /><testcase classname="tests.datastreams.test_writers" name="test_service_writer_non_existing" time="2.206" /><testcase classname="tests.datastreams.test_writers" name="test_service_writer_duplicate" time="0.073" /><testcase classname="tests.datastreams.test_writers" name="test_service_writer_update_existing" time="0.134" /><testcase classname="tests.datastreams.test_writers" name="test_service_writer_update_non_existing" time="0.062" /><testcase classname="tests.datastreams.test_writers" name="test_writer_wrong_config_no_insert_no_update" time="0.008" /><testcase classname="tests.datastreams.test_writers" name="test_writer_no_insert" time="0.013" /><testcase classname="tests.datastreams.test_writers" name="test_yaml_writer" time="0.004" /><testcase classname="tests.datastreams.test_writers" name="test_async_writer" time="0.458" /><testcase classname="tests.mock_module.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="tests.mock_module.__init__" name="ISORT" time="0.004" /><testcase classname="tests.mock_module.__init__" name="black" time="0.174" /><testcase classname="tests.mock_module.api" name="PYDOCSTYLE" time="0.005" /><testcase classname="tests.mock_module.api" name="ISORT" time="0.017" /><testcase classname="tests.mock_module.api" name="black" time="0.181" /><testcase classname="tests.mock_module.jsonschemas.__init__" name="PYDOCSTYLE" time="0.002" /><testcase classname="tests.mock_module.jsonschemas.__init__" name="ISORT" time="0.003" /><testcase classname="tests.mock_module.jsonschemas.__init__" name="black" time="0.169" /><testcase classname="tests.mock_module.mappings.__init__" name="PYDOCSTYLE" time="0.002" /><testcase classname="tests.mock_module.mappings.__init__" name="ISORT" time="0.003" /><testcase classname="tests.mock_module.mappings.__init__" name="black" time="0.171" /><testcase classname="tests.mock_module.mappings.v6.__init__" name="PYDOCSTYLE" time="0.002" /><testcase classname="tests.mock_module.mappings.v6.__init__" name="ISORT" time="0.003" /><testcase classname="tests.mock_module.mappings.v6.__init__" name="black" time="0.173" /><testcase classname="tests.mock_module.mappings.v7.__init__" name="PYDOCSTYLE" time="0.002" /><testcase classname="tests.mock_module.mappings.v7.__init__" name="ISORT" time="0.003" /><testcase classname="tests.mock_module.mappings.v7.__init__" name="black" time="0.172" /><testcase classname="tests.mock_module.models" name="PYDOCSTYLE" time="0.003" /><testcase classname="tests.mock_module.models" name="ISORT" time="0.008" /><testcase classname="tests.mock_module.models" name="black" time="0.181" /><testcase classname="tests.records.conftest" name="PYDOCSTYLE" time="0.007" /><testcase classname="tests.records.conftest" name="ISORT" time="0.019" /><testcase classname="tests.records.conftest" name="black" time="0.185" /><testcase classname="tests.records.test_api" name="ISORT" time="0.022" /><testcase classname="tests.records.test_api" name="black" time="0.202" /><testcase classname="tests.records.test_api" name="test_record_schema_validation" time="2.011" /><testcase classname="tests.records.test_api" name="test_record_indexing" time="0.070" /><testcase classname="tests.records.test_api" name="test_record_pids" time="0.356" /><testcase classname="tests.records.test_jsonschema" name="ISORT" time="0.023" /><testcase classname="tests.records.test_jsonschema" name="black" time="0.189" /><testcase classname="tests.records.test_jsonschema" name="test_valid_full" time="0.843" /><testcase classname="tests.records.test_jsonschema" name="test_valid_empty" time="0.003" /><testcase classname="tests.records.test_jsonschema" name="test_fails_description" time="0.010" /><testcase classname="tests.records.test_jsonschema" name="test_fails_icon" time="0.005" /><testcase classname="tests.records.test_jsonschema" name="test_fails_props" time="0.004" /><testcase classname="tests.records.test_jsonschema" name="test_fails_tags" time="0.004" /><testcase classname="tests.records.test_jsonschema" name="test_fails_title" time="0.011" /><testcase classname="tests.records.test_models" name="ISORT" time="0.010" /><testcase classname="tests.records.test_models" name="black" time="0.170" /><testcase classname="tests.records.test_models" name="test_well_formed_subtype" time="1.094" /><testcase classname="tests.records.test_relationship" name="ISORT" time="0.021" /><testcase classname="tests.records.test_relationship" name="black" time="0.192" /><testcase classname="tests.records.test_relationship" name="test_mock_record" time="1.864" /><testcase classname="tests.records.test_relationship" name="test_linked_record" time="0.040" /><testcase classname="tests.records.test_relationship" name="test_dereferencing" time="0.035" /><testcase classname="tests.records.test_relationship" name="test_dumping" time="0.037" /><testcase classname="tests.records.test_relationship" name="test_indexing" time="0.368" /><testcase classname="tests.resources.conftest" name="PYDOCSTYLE" time="0.003" /><testcase classname="tests.resources.conftest" name="ISORT" time="0.005" /><testcase classname="tests.resources.conftest" name="black" time="0.175" /><testcase classname="tests.resources.test_resources_get" name="ISORT" time="0.026" /><testcase classname="tests.resources.test_resources_get" name="black" time="0.185" /><testcase classname="tests.resources.test_resources_get" name="test_get" time="1.983" /><testcase classname="tests.resources.test_resources_get" name="test_not_found" time="0.434" /><testcase classname="tests.resources.test_resources_l10n" name="ISORT" time="0.030" /><testcase classname="tests.resources.test_resources_l10n" name="black" time="0.202" /><testcase classname="tests.resources.test_resources_l10n" name="test_get" time="2.031" /><testcase classname="tests.resources.test_resources_l10n" name="test_search" time="0.449" /><testcase classname="tests.resources.test_resources_search" name="ISORT" time="0.022" /><testcase classname="tests.resources.test_resources_search" name="black" time="0.192" /><testcase classname="tests.resources.test_resources_search" name="test_invalid_type" time="1.799" /><testcase classname="tests.resources.test_resources_search" name="test_type_as_query_arg" time="0.181" /><testcase classname="tests.resources.test_resources_search" name="test_search" time="0.029" /><testcase classname="tests.resources.test_resources_search" name="test_query_q" time="0.083" /><testcase classname="tests.resources.test_resources_search" name="test_tags_filter" time="0.337" /><testcase classname="tests.resources.test_tasks_resources" name="ISORT" time="0.021" /><testcase classname="tests.resources.test_tasks_resources" name="black" time="0.192" /><testcase classname="tests.resources.test_tasks_resources" name="test_task_creation" time="2.389" /><testcase classname="tests.services.conftest" name="PYDOCSTYLE" time="0.003" /><testcase classname="tests.services.conftest" name="ISORT" time="0.010" /><testcase classname="tests.services.conftest" name="black" time="0.168" /><testcase classname="tests.services.test_labels" name="ISORT" time="0.018" /><testcase classname="tests.services.test_labels" name="black" time="0.185" /><testcase classname="tests.services.test_labels" name="test_vocabulary_label_cache" time="1.956" /><testcase classname="tests.services.test_labels" name="test_vocabulary_label_no_cache" time="0.014" /><testcase classname="tests.services.test_labels" name="test_vocabulary_label_not_found" time="0.305" /><testcase classname="tests.services.test_permissions" name="ISORT" time="0.020" /><testcase classname="tests.services.test_permissions" name="black" time="0.184" /><testcase classname="tests.services.test_permissions" name="test_permissions_readonly" time="2.043" /><testcase classname="tests.services.test_permissions" name="test_non_searchable_tag" time="0.396" /><testcase classname="tests.services.test_schema" name="ISORT" time="0.016" /><testcase classname="tests.services.test_schema" name="black" time="0.185" /><testcase classname="tests.services.test_schema" name="test_valid_minimal" time="0.002" /><testcase classname="tests.services.test_schema" name="test_valid_full" time="0.002" /><testcase classname="tests.services.test_schema" name="test_invalid_empty[invalid0]" time="0.001" /><testcase classname="tests.services.test_schema" name="test_invalid_empty[invalid1]" time="0.001" /><testcase classname="tests.services.test_schema" name="test_invalid_empty[invalid2]" time="0.001" /><testcase classname="tests.services.test_schema" name="test_invalid_empty[invalid3]" time="0.001" /><testcase classname="tests.services.test_schema" name="test_invalid_empty[invalid4]" time="0.002" /><testcase classname="tests.services.test_schema" name="test_invalid_empty[invalid5]" time="0.001" /><testcase classname="tests.services.test_service" name="ISORT" time="0.033" /><testcase classname="tests.services.test_service" name="black" time="0.209" /><testcase classname="tests.services.test_service" name="test_simple_flow" time="2.043" /><testcase classname="tests.services.test_service" name="test_pid_already_registered" time="0.069" /><testcase classname="tests.services.test_service" name="test_extra_fields" time="0.015" /><testcase classname="tests.services.test_service" name="test_missing_or_invalid_type" time="0.025" /><testcase classname="tests.services.test_service" name="test_update" time="0.076" /><testcase classname="tests.services.test_service" name="test_read_all_no_cache" time="0.215" /><testcase classname="tests.services.test_service" name="test_read_all_cache" time="0.224" /><testcase classname="tests.services.test_service" name="test_read_many" time="1.209" /><testcase classname="tests.services.test_service" name="test_indexed_at_query" time="0.415" /><testcase classname="tests.test_alembic" name="ISORT" time="0.017" /><testcase classname="tests.test_alembic" name="black" time="0.182" /><testcase classname="tests.test_alembic" name="test_alembic" time="5.430" /><testcase classname="tests.test_cli" name="ISORT" time="0.030" /><testcase classname="tests.test_cli" name="black" time="0.183" /><testcase classname="tests.test_cli" name="test_process" time="1.898" /><testcase classname="tests.test_cli" name="test_update_cmd" time="0.390"><failure message="assert 1 == 0&#10; +  where 1 = &lt;Result &lt;ValidationError: &quot;Additional properties are not allowed ('pid' was unexpected)&quot;&gt;&gt;.exit_code">app = &lt;Flask 'invenio'&gt;, names_tar_file = PosixPath('cli_test.tar.gz')

    def test_update_cmd(app, names_tar_file):
        # cli update
        runner = app.test_cli_runner()
        result = runner.invoke(
            vocabularies,
            ["update", "-v", "names", "--origin", names_tar_file.absolute()],
        )
&gt;       assert result.exit_code == 0
E       assert 1 == 0
E        +  where 1 = &lt;Result &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;&gt;.exit_code

app        = &lt;Flask 'invenio'&gt;
names_tar_file = PosixPath('cli_test.tar.gz')
result     = &lt;Result &lt;ValidationError: "Additional properties are not allowed ('pid' was unexpected)"&gt;&gt;
runner     = &lt;flask.testing.FlaskCliRunner object at 0x7f47e6c294f0&gt;

tests/test_cli.py:121: AssertionError</failure></testcase><testcase classname="tests.test_factory" name="ISORT" time="0.022" /><testcase classname="tests.test_factory" name="black" time="0.185" /><testcase classname="tests.test_factory" name="test_vocabulary_config[conf0-ds_config0-awards-service]" time="1.786" /><testcase classname="tests.test_factory" name="test_vocabulary_config[conf1-ds_config1-names-service]" time="0.002" /><testcase classname="tests.test_factory" name="test_vocabulary_config[conf2-ds_config2-funders-service]" time="0.002" /><testcase classname="tests.test_factory" name="test_vocabulary_config[conf3-ds_config3-affiliations-service]" time="0.002" /><testcase classname="tests.test_factory" name="test_names_service" time="0.002" /><testcase classname="tests.test_factory" name="test_service_not_implemented[FundersVocabularyConfig-NotImplementedError]" time="0.002" /><testcase classname="tests.test_factory" name="test_service_not_implemented[AwardsVocabularyConfig-NotImplementedError]" time="0.279" /><testcase classname="tests.test_invenio_vocabularies" name="ISORT" time="0.011" /><testcase classname="tests.test_invenio_vocabularies" name="black" time="0.176" /><testcase classname="tests.test_invenio_vocabularies" name="test_version" time="0.001" /><testcase classname="tests.test_invenio_vocabularies" name="test_init" time="0.007" /><testcase classname="invenio_vocabularies.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.__init__" name="ISORT" time="0.007" /><testcase classname="invenio_vocabularies.__init__" name="black" time="0.174" /><testcase classname="invenio_vocabularies.administration.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.administration.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.administration.__init__" name="black" time="0.174" /><testcase classname="invenio_vocabularies.administration.views.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.administration.views.__init__" name="ISORT" time="0.005" /><testcase classname="invenio_vocabularies.administration.views.__init__" name="black" time="0.170" /><testcase classname="invenio_vocabularies.administration.views.vocabularies" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.administration.views.vocabularies" name="ISORT" time="0.013" /><testcase classname="invenio_vocabularies.administration.views.vocabularies" name="black" time="0.180" /><testcase classname="invenio_vocabularies.alembic.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.alembic.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.alembic.__init__" name="black" time="0.166" /><testcase classname="invenio_vocabularies.alembic.17c703ce1eb7_create_names_table" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.alembic.17c703ce1eb7_create_names_table" name="ISORT" time="0.015" /><testcase classname="invenio_vocabularies.alembic.17c703ce1eb7_create_names_table" name="black" time="0.177" /><testcase classname="invenio_vocabularies.alembic.3ba812d80559_add_internal_name_id" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.alembic.3ba812d80559_add_internal_name_id" name="ISORT" time="0.011" /><testcase classname="invenio_vocabularies.alembic.3ba812d80559_add_internal_name_id" name="black" time="0.172" /><testcase classname="invenio_vocabularies.alembic.4a9a4fd235f8_create_vocabulary_schemes" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.alembic.4a9a4fd235f8_create_vocabulary_schemes" name="ISORT" time="0.011" /><testcase classname="invenio_vocabularies.alembic.4a9a4fd235f8_create_vocabulary_schemes" name="black" time="0.172" /><testcase classname="invenio_vocabularies.alembic.4f365fced43f_create_vocabularies_tables" name="PYDOCSTYLE" time="0.009" /><testcase classname="invenio_vocabularies.alembic.4f365fced43f_create_vocabularies_tables" name="ISORT" time="0.022" /><testcase classname="invenio_vocabularies.alembic.4f365fced43f_create_vocabularies_tables" name="black" time="0.187" /><testcase classname="invenio_vocabularies.alembic.55a700f897b6_add_names_and_afiliations_pid_column" name="PYDOCSTYLE" time="0.008" /><testcase classname="invenio_vocabularies.alembic.55a700f897b6_add_names_and_afiliations_pid_column" name="ISORT" time="0.020" /><testcase classname="invenio_vocabularies.alembic.55a700f897b6_add_names_and_afiliations_pid_column" name="black" time="0.184" /><testcase classname="invenio_vocabularies.alembic.6312f33645c1_create_affiliations_table" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.alembic.6312f33645c1_create_affiliations_table" name="ISORT" time="0.015" /><testcase classname="invenio_vocabularies.alembic.6312f33645c1_create_affiliations_table" name="black" time="0.173" /><testcase classname="invenio_vocabularies.alembic.676dd587542d_create_funders_vocabulary_table" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.alembic.676dd587542d_create_funders_vocabulary_table" name="ISORT" time="0.016" /><testcase classname="invenio_vocabularies.alembic.676dd587542d_create_funders_vocabulary_table" name="black" time="0.174" /><testcase classname="invenio_vocabularies.alembic.8ff82dfb0be8_create_vocabularies_branch" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.alembic.8ff82dfb0be8_create_vocabularies_branch" name="ISORT" time="0.010" /><testcase classname="invenio_vocabularies.alembic.8ff82dfb0be8_create_vocabularies_branch" name="black" time="0.165" /><testcase classname="invenio_vocabularies.alembic.af2457652217_drop_unique_constraint_from_internal_id" name="PYDOCSTYLE" time="0.007" /><testcase classname="invenio_vocabularies.alembic.af2457652217_drop_unique_constraint_from_internal_id" name="ISORT" time="0.016" /><testcase classname="invenio_vocabularies.alembic.af2457652217_drop_unique_constraint_from_internal_id" name="black" time="0.168" /><testcase classname="invenio_vocabularies.alembic.e1146238edd3_create_awards_table" name="PYDOCSTYLE" time="0.007" /><testcase classname="invenio_vocabularies.alembic.e1146238edd3_create_awards_table" name="ISORT" time="0.016" /><testcase classname="invenio_vocabularies.alembic.e1146238edd3_create_awards_table" name="black" time="0.175" /><testcase classname="invenio_vocabularies.cli" name="PYDOCSTYLE" time="0.018" /><testcase classname="invenio_vocabularies.cli" name="ISORT" time="0.035" /><testcase classname="invenio_vocabularies.cli" name="black" time="0.211" /><testcase classname="invenio_vocabularies.config" name="PYDOCSTYLE" time="0.013" /><testcase classname="invenio_vocabularies.config" name="ISORT" time="0.040" /><testcase classname="invenio_vocabularies.config" name="black" time="0.206" /><testcase classname="invenio_vocabularies.contrib.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.__init__" name="black" time="0.165" /><testcase classname="invenio_vocabularies.contrib.affiliations.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.affiliations.__init__" name="ISORT" time="0.007" /><testcase classname="invenio_vocabularies.contrib.affiliations.__init__" name="black" time="0.167" /><testcase classname="invenio_vocabularies.contrib.affiliations.affiliations" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.affiliations.affiliations" name="ISORT" time="0.021" /><testcase classname="invenio_vocabularies.contrib.affiliations.affiliations" name="black" time="0.181" /><testcase classname="invenio_vocabularies.contrib.affiliations.api" name="PYDOCSTYLE" time="0.002" /><testcase classname="invenio_vocabularies.contrib.affiliations.api" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.affiliations.api" name="black" time="0.167" /><testcase classname="invenio_vocabularies.contrib.affiliations.config" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.contrib.affiliations.config" name="ISORT" time="0.021" /><testcase classname="invenio_vocabularies.contrib.affiliations.config" name="black" time="0.183" /><testcase classname="invenio_vocabularies.contrib.affiliations.datastreams" name="PYDOCSTYLE" time="0.020" /><testcase classname="invenio_vocabularies.contrib.affiliations.datastreams" name="ISORT" time="0.050" /><testcase classname="invenio_vocabularies.contrib.affiliations.datastreams" name="black" time="0.215" /><testcase classname="invenio_vocabularies.contrib.affiliations.facets" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.affiliations.facets" name="ISORT" time="0.009" /><testcase classname="invenio_vocabularies.contrib.affiliations.facets" name="black" time="0.170" /><testcase classname="invenio_vocabularies.contrib.affiliations.jsonschemas.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.affiliations.jsonschemas.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.affiliations.jsonschemas.__init__" name="black" time="0.161" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.__init__" name="black" time="0.161" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.os-v1.__init__" name="PYDOCSTYLE" time="0.002" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.os-v1.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.os-v1.__init__" name="black" time="0.165" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.os-v2.__init__" name="PYDOCSTYLE" time="0.002" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.os-v2.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.os-v2.__init__" name="black" time="0.164" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.v7.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.v7.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.affiliations.mappings.v7.__init__" name="black" time="0.163" /><testcase classname="invenio_vocabularies.contrib.affiliations.models" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.affiliations.models" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.affiliations.models" name="black" time="0.163" /><testcase classname="invenio_vocabularies.contrib.affiliations.resources" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.affiliations.resources" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.affiliations.resources" name="black" time="0.168" /><testcase classname="invenio_vocabularies.contrib.affiliations.schema" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.contrib.affiliations.schema" name="ISORT" time="0.018" /><testcase classname="invenio_vocabularies.contrib.affiliations.schema" name="black" time="0.174" /><testcase classname="invenio_vocabularies.contrib.affiliations.services" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.affiliations.services" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.affiliations.services" name="black" time="0.164" /><testcase classname="invenio_vocabularies.contrib.awards.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.awards.__init__" name="ISORT" time="0.008" /><testcase classname="invenio_vocabularies.contrib.awards.__init__" name="black" time="0.172" /><testcase classname="invenio_vocabularies.contrib.awards.api" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.awards.api" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.awards.api" name="black" time="0.171" /><testcase classname="invenio_vocabularies.contrib.awards.awards" name="PYDOCSTYLE" time="0.007" /><testcase classname="invenio_vocabularies.contrib.awards.awards" name="ISORT" time="0.027" /><testcase classname="invenio_vocabularies.contrib.awards.awards" name="black" time="0.181" /><testcase classname="invenio_vocabularies.contrib.awards.config" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.awards.config" name="ISORT" time="0.018" /><testcase classname="invenio_vocabularies.contrib.awards.config" name="black" time="0.171" /><testcase classname="invenio_vocabularies.contrib.awards.datastreams" name="PYDOCSTYLE" time="0.024" /><testcase classname="invenio_vocabularies.contrib.awards.datastreams" name="ISORT" time="0.061" /><testcase classname="invenio_vocabularies.contrib.awards.datastreams" name="black" time="0.230" /><testcase classname="invenio_vocabularies.contrib.awards.jsonschemas.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.awards.jsonschemas.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.awards.jsonschemas.__init__" name="black" time="0.162" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.__init__" name="black" time="0.165" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.os-v1.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.os-v1.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.os-v1.__init__" name="black" time="0.161" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.os-v2.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.os-v2.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.os-v2.__init__" name="black" time="0.160" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.v7.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.v7.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.awards.mappings.v7.__init__" name="black" time="0.161" /><testcase classname="invenio_vocabularies.contrib.awards.models" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.awards.models" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.awards.models" name="black" time="0.160" /><testcase classname="invenio_vocabularies.contrib.awards.resources" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.awards.resources" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.awards.resources" name="black" time="0.163" /><testcase classname="invenio_vocabularies.contrib.awards.schema" name="PYDOCSTYLE" time="0.010" /><testcase classname="invenio_vocabularies.contrib.awards.schema" name="ISORT" time="0.025" /><testcase classname="invenio_vocabularies.contrib.awards.schema" name="black" time="0.182" /><testcase classname="invenio_vocabularies.contrib.awards.serializer" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.contrib.awards.serializer" name="ISORT" time="0.013" /><testcase classname="invenio_vocabularies.contrib.awards.serializer" name="black" time="0.169" /><testcase classname="invenio_vocabularies.contrib.awards.services" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.awards.services" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.awards.services" name="black" time="0.160" /><testcase classname="invenio_vocabularies.contrib.common.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.common.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.common.__init__" name="black" time="0.162" /><testcase classname="invenio_vocabularies.contrib.common.openaire.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.common.openaire.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.common.openaire.__init__" name="black" time="0.163" /><testcase classname="invenio_vocabularies.contrib.common.openaire.datastreams" name="PYDOCSTYLE" time="0.007" /><testcase classname="invenio_vocabularies.contrib.common.openaire.datastreams" name="ISORT" time="0.019" /><testcase classname="invenio_vocabularies.contrib.common.openaire.datastreams" name="black" time="0.175" /><testcase classname="invenio_vocabularies.contrib.common.ror.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.common.ror.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.common.ror.__init__" name="black" time="0.160" /><testcase classname="invenio_vocabularies.contrib.common.ror.datastreams" name="PYDOCSTYLE" time="0.019" /><testcase classname="invenio_vocabularies.contrib.common.ror.datastreams" name="ISORT" time="0.042" /><testcase classname="invenio_vocabularies.contrib.common.ror.datastreams" name="black" time="0.207" /><testcase classname="invenio_vocabularies.contrib.funders.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.funders.__init__" name="ISORT" time="0.007" /><testcase classname="invenio_vocabularies.contrib.funders.__init__" name="black" time="0.165" /><testcase classname="invenio_vocabularies.contrib.funders.api" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.funders.api" name="ISORT" time="0.005" /><testcase classname="invenio_vocabularies.contrib.funders.api" name="black" time="0.161" /><testcase classname="invenio_vocabularies.contrib.funders.config" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.contrib.funders.config" name="ISORT" time="0.020" /><testcase classname="invenio_vocabularies.contrib.funders.config" name="black" time="0.170" /><testcase classname="invenio_vocabularies.contrib.funders.datastreams" name="PYDOCSTYLE" time="0.008" /><testcase classname="invenio_vocabularies.contrib.funders.datastreams" name="ISORT" time="0.020" /><testcase classname="invenio_vocabularies.contrib.funders.datastreams" name="black" time="0.174" /><testcase classname="invenio_vocabularies.contrib.funders.facets" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.funders.facets" name="ISORT" time="0.008" /><testcase classname="invenio_vocabularies.contrib.funders.facets" name="black" time="0.164" /><testcase classname="invenio_vocabularies.contrib.funders.funders" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.contrib.funders.funders" name="ISORT" time="0.022" /><testcase classname="invenio_vocabularies.contrib.funders.funders" name="black" time="0.174" /><testcase classname="invenio_vocabularies.contrib.funders.jsonschemas.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.funders.jsonschemas.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.funders.jsonschemas.__init__" name="black" time="0.158" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.__init__" name="black" time="0.163" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.os-v1.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.os-v1.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.os-v1.__init__" name="black" time="0.162" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.os-v2.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.os-v2.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.os-v2.__init__" name="black" time="0.164" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.v7.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.v7.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.funders.mappings.v7.__init__" name="black" time="0.169" /><testcase classname="invenio_vocabularies.contrib.funders.models" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.funders.models" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.funders.models" name="black" time="0.167" /><testcase classname="invenio_vocabularies.contrib.funders.resources" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.funders.resources" name="ISORT" time="0.010" /><testcase classname="invenio_vocabularies.contrib.funders.resources" name="black" time="0.164" /><testcase classname="invenio_vocabularies.contrib.funders.schema" name="PYDOCSTYLE" time="0.009" /><testcase classname="invenio_vocabularies.contrib.funders.schema" name="ISORT" time="0.020" /><testcase classname="invenio_vocabularies.contrib.funders.schema" name="black" time="0.182" /><testcase classname="invenio_vocabularies.contrib.funders.serializer" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.funders.serializer" name="ISORT" time="0.010" /><testcase classname="invenio_vocabularies.contrib.funders.serializer" name="black" time="0.175" /><testcase classname="invenio_vocabularies.contrib.funders.services" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.funders.services" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.funders.services" name="black" time="0.169" /><testcase classname="invenio_vocabularies.contrib.names.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.contrib.names.__init__" name="ISORT" time="0.007" /><testcase classname="invenio_vocabularies.contrib.names.__init__" name="black" time="0.167" /><testcase classname="invenio_vocabularies.contrib.names.api" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.names.api" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.names.api" name="black" time="0.167" /><testcase classname="invenio_vocabularies.contrib.names.components" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.names.components" name="ISORT" time="0.008" /><testcase classname="invenio_vocabularies.contrib.names.components" name="black" time="0.168" /><testcase classname="invenio_vocabularies.contrib.names.config" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.contrib.names.config" name="ISORT" time="0.020" /><testcase classname="invenio_vocabularies.contrib.names.config" name="black" time="0.175" /><testcase classname="invenio_vocabularies.contrib.names.datastreams" name="PYDOCSTYLE" time="0.037" /><testcase classname="invenio_vocabularies.contrib.names.datastreams" name="ISORT" time="0.080" /><testcase classname="invenio_vocabularies.contrib.names.datastreams" name="black" time="0.254" /><testcase classname="invenio_vocabularies.contrib.names.jsonschemas.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.names.jsonschemas.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.names.jsonschemas.__init__" name="black" time="0.164" /><testcase classname="invenio_vocabularies.contrib.names.mappings.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.names.mappings.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.names.mappings.__init__" name="black" time="0.164" /><testcase classname="invenio_vocabularies.contrib.names.mappings.os-v1.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.names.mappings.os-v1.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.names.mappings.os-v1.__init__" name="black" time="0.165" /><testcase classname="invenio_vocabularies.contrib.names.mappings.os-v2.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.names.mappings.os-v2.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.names.mappings.os-v2.__init__" name="black" time="0.163" /><testcase classname="invenio_vocabularies.contrib.names.mappings.v7.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.names.mappings.v7.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.names.mappings.v7.__init__" name="black" time="0.166" /><testcase classname="invenio_vocabularies.contrib.names.models" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.names.models" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.names.models" name="black" time="0.167" /><testcase classname="invenio_vocabularies.contrib.names.names" name="PYDOCSTYLE" time="0.007" /><testcase classname="invenio_vocabularies.contrib.names.names" name="ISORT" time="0.024" /><testcase classname="invenio_vocabularies.contrib.names.names" name="black" time="0.184" /><testcase classname="invenio_vocabularies.contrib.names.permissions" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.names.permissions" name="ISORT" time="0.011" /><testcase classname="invenio_vocabularies.contrib.names.permissions" name="black" time="0.171" /><testcase classname="invenio_vocabularies.contrib.names.resources" name="PYDOCSTYLE" time="0.007" /><testcase classname="invenio_vocabularies.contrib.names.resources" name="ISORT" time="0.015" /><testcase classname="invenio_vocabularies.contrib.names.resources" name="black" time="0.175" /><testcase classname="invenio_vocabularies.contrib.names.s3client" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.contrib.names.s3client" name="ISORT" time="0.013" /><testcase classname="invenio_vocabularies.contrib.names.s3client" name="black" time="0.187" /><testcase classname="invenio_vocabularies.contrib.names.schema" name="PYDOCSTYLE" time="0.012" /><testcase classname="invenio_vocabularies.contrib.names.schema" name="ISORT" time="0.024" /><testcase classname="invenio_vocabularies.contrib.names.schema" name="black" time="0.188" /><testcase classname="invenio_vocabularies.contrib.names.services" name="PYDOCSTYLE" time="0.007" /><testcase classname="invenio_vocabularies.contrib.names.services" name="ISORT" time="0.015" /><testcase classname="invenio_vocabularies.contrib.names.services" name="black" time="0.178" /><testcase classname="invenio_vocabularies.contrib.subjects.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.contrib.subjects.__init__" name="ISORT" time="0.007" /><testcase classname="invenio_vocabularies.contrib.subjects.__init__" name="black" time="0.166" /><testcase classname="invenio_vocabularies.contrib.subjects.api" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.api" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.subjects.api" name="black" time="0.165" /><testcase classname="invenio_vocabularies.contrib.subjects.config" name="PYDOCSTYLE" time="0.007" /><testcase classname="invenio_vocabularies.contrib.subjects.config" name="ISORT" time="0.022" /><testcase classname="invenio_vocabularies.contrib.subjects.config" name="black" time="0.178" /><testcase classname="invenio_vocabularies.contrib.subjects.datastreams" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.contrib.subjects.datastreams" name="ISORT" time="0.016" /><testcase classname="invenio_vocabularies.contrib.subjects.datastreams" name="black" time="0.174" /><testcase classname="invenio_vocabularies.contrib.subjects.euroscivoc.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.euroscivoc.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.subjects.euroscivoc.__init__" name="black" time="0.163" /><testcase classname="invenio_vocabularies.contrib.subjects.euroscivoc.datastreams" name="PYDOCSTYLE" time="0.008" /><testcase classname="invenio_vocabularies.contrib.subjects.euroscivoc.datastreams" name="ISORT" time="0.018" /><testcase classname="invenio_vocabularies.contrib.subjects.euroscivoc.datastreams" name="black" time="0.181" /><testcase classname="invenio_vocabularies.contrib.subjects.facets" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.contrib.subjects.facets" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.subjects.facets" name="black" time="0.165" /><testcase classname="invenio_vocabularies.contrib.subjects.gemet.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.gemet.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.subjects.gemet.__init__" name="black" time="0.167" /><testcase classname="invenio_vocabularies.contrib.subjects.gemet.datastreams" name="PYDOCSTYLE" time="0.012" /><testcase classname="invenio_vocabularies.contrib.subjects.gemet.datastreams" name="ISORT" time="0.026" /><testcase classname="invenio_vocabularies.contrib.subjects.gemet.datastreams" name="black" time="0.189" /><testcase classname="invenio_vocabularies.contrib.subjects.jsonschemas.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.jsonschemas.__init__" name="ISORT" time="0.005" /><testcase classname="invenio_vocabularies.contrib.subjects.jsonschemas.__init__" name="black" time="0.163" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.__init__" name="black" time="0.167" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.os-v1.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.os-v1.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.os-v1.__init__" name="black" time="0.169" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.os-v2.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.os-v2.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.os-v2.__init__" name="black" time="0.174" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.v7.__init__" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.v7.__init__" name="ISORT" time="0.005" /><testcase classname="invenio_vocabularies.contrib.subjects.mappings.v7.__init__" name="black" time="0.164" /><testcase classname="invenio_vocabularies.contrib.subjects.mesh.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.mesh.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.subjects.mesh.__init__" name="black" time="0.166" /><testcase classname="invenio_vocabularies.contrib.subjects.mesh.datastreams" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.subjects.mesh.datastreams" name="ISORT" time="0.012" /><testcase classname="invenio_vocabularies.contrib.subjects.mesh.datastreams" name="black" time="0.172" /><testcase classname="invenio_vocabularies.contrib.subjects.models" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.models" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.subjects.models" name="black" time="0.164" /><testcase classname="invenio_vocabularies.contrib.subjects.nvs.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.nvs.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.contrib.subjects.nvs.__init__" name="black" time="0.165" /><testcase classname="invenio_vocabularies.contrib.subjects.nvs.datastreams" name="PYDOCSTYLE" time="0.010" /><testcase classname="invenio_vocabularies.contrib.subjects.nvs.datastreams" name="ISORT" time="0.023" /><testcase classname="invenio_vocabularies.contrib.subjects.nvs.datastreams" name="black" time="0.184" /><testcase classname="invenio_vocabularies.contrib.subjects.resources" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.contrib.subjects.resources" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.contrib.subjects.resources" name="black" time="0.167" /><testcase classname="invenio_vocabularies.contrib.subjects.schema" name="PYDOCSTYLE" time="0.010" /><testcase classname="invenio_vocabularies.contrib.subjects.schema" name="ISORT" time="0.027" /><testcase classname="invenio_vocabularies.contrib.subjects.schema" name="black" time="0.182" /><testcase classname="invenio_vocabularies.contrib.subjects.services" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.contrib.subjects.services" name="ISORT" time="0.010" /><testcase classname="invenio_vocabularies.contrib.subjects.services" name="black" time="0.170" /><testcase classname="invenio_vocabularies.contrib.subjects.subjects" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.contrib.subjects.subjects" name="ISORT" time="0.018" /><testcase classname="invenio_vocabularies.contrib.subjects.subjects" name="black" time="0.176" /><testcase classname="invenio_vocabularies.datastreams.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.datastreams.__init__" name="ISORT" time="0.007" /><testcase classname="invenio_vocabularies.datastreams.__init__" name="black" time="0.188" /><testcase classname="invenio_vocabularies.datastreams.datastreams" name="PYDOCSTYLE" time="0.026" /><testcase classname="invenio_vocabularies.datastreams.datastreams" name="ISORT" time="0.045" /><testcase classname="invenio_vocabularies.datastreams.datastreams" name="black" time="0.214" /><testcase classname="invenio_vocabularies.datastreams.errors" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.datastreams.errors" name="ISORT" time="0.007" /><testcase classname="invenio_vocabularies.datastreams.errors" name="black" time="0.168" /><testcase classname="invenio_vocabularies.datastreams.factories" name="PYDOCSTYLE" time="0.009" /><testcase classname="invenio_vocabularies.datastreams.factories" name="ISORT" time="0.017" /><testcase classname="invenio_vocabularies.datastreams.factories" name="black" time="0.178" /><testcase classname="invenio_vocabularies.datastreams.readers" name="PYDOCSTYLE" time="0.045" /><testcase classname="invenio_vocabularies.datastreams.readers" name="ISORT" time="0.077" /><testcase classname="invenio_vocabularies.datastreams.readers" name="black" time="0.259" /><testcase classname="invenio_vocabularies.datastreams.tasks" name="PYDOCSTYLE" time="0.011" /><testcase classname="invenio_vocabularies.datastreams.tasks" name="ISORT" time="0.025" /><testcase classname="invenio_vocabularies.datastreams.tasks" name="black" time="0.199" /><testcase classname="invenio_vocabularies.datastreams.transformers" name="PYDOCSTYLE" time="0.015" /><testcase classname="invenio_vocabularies.datastreams.transformers" name="ISORT" time="0.026" /><testcase classname="invenio_vocabularies.datastreams.transformers" name="black" time="0.190" /><testcase classname="invenio_vocabularies.datastreams.writers" name="PYDOCSTYLE" time="0.023" /><testcase classname="invenio_vocabularies.datastreams.writers" name="ISORT" time="0.042" /><testcase classname="invenio_vocabularies.datastreams.writers" name="black" time="0.206" /><testcase classname="invenio_vocabularies.datastreams.xml" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.datastreams.xml" name="ISORT" time="0.009" /><testcase classname="invenio_vocabularies.datastreams.xml" name="black" time="0.173" /><testcase classname="invenio_vocabularies.ext" name="PYDOCSTYLE" time="0.017" /><testcase classname="invenio_vocabularies.ext" name="ISORT" time="0.028" /><testcase classname="invenio_vocabularies.ext" name="black" time="0.198" /><testcase classname="invenio_vocabularies.factories" name="PYDOCSTYLE" time="0.017" /><testcase classname="invenio_vocabularies.factories" name="ISORT" time="0.035" /><testcase classname="invenio_vocabularies.factories" name="black" time="0.195" /><testcase classname="invenio_vocabularies.fixtures" name="PYDOCSTYLE" time="0.008" /><testcase classname="invenio_vocabularies.fixtures" name="ISORT" time="0.013" /><testcase classname="invenio_vocabularies.fixtures" name="black" time="0.176" /><testcase classname="invenio_vocabularies.jobs" name="PYDOCSTYLE" time="0.016" /><testcase classname="invenio_vocabularies.jobs" name="ISORT" time="0.037" /><testcase classname="invenio_vocabularies.jobs" name="black" time="0.205" /><testcase classname="invenio_vocabularies.proxies" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.proxies" name="ISORT" time="0.009" /><testcase classname="invenio_vocabularies.proxies" name="black" time="0.173" /><testcase classname="invenio_vocabularies.records.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.records.__init__" name="ISORT" time="0.005" /><testcase classname="invenio_vocabularies.records.__init__" name="black" time="0.167" /><testcase classname="invenio_vocabularies.records.api" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.records.api" name="ISORT" time="0.016" /><testcase classname="invenio_vocabularies.records.api" name="black" time="0.175" /><testcase classname="invenio_vocabularies.records.jsonschemas.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.records.jsonschemas.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.records.jsonschemas.__init__" name="black" time="0.165" /><testcase classname="invenio_vocabularies.records.mappings.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.records.mappings.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.records.mappings.__init__" name="black" time="0.166" /><testcase classname="invenio_vocabularies.records.mappings.os-v1.__init__" name="PYDOCSTYLE" time="0.003" /><testcase classname="invenio_vocabularies.records.mappings.os-v1.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.records.mappings.os-v1.__init__" name="black" time="0.164" /><testcase classname="invenio_vocabularies.records.mappings.os-v2.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.records.mappings.os-v2.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.records.mappings.os-v2.__init__" name="black" time="0.164" /><testcase classname="invenio_vocabularies.records.mappings.v7.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.records.mappings.v7.__init__" name="ISORT" time="0.004" /><testcase classname="invenio_vocabularies.records.mappings.v7.__init__" name="black" time="0.164" /><testcase classname="invenio_vocabularies.records.models" name="PYDOCSTYLE" time="0.010" /><testcase classname="invenio_vocabularies.records.models" name="ISORT" time="0.018" /><testcase classname="invenio_vocabularies.records.models" name="black" time="0.183" /><testcase classname="invenio_vocabularies.records.pidprovider" name="PYDOCSTYLE" time="0.010" /><testcase classname="invenio_vocabularies.records.pidprovider" name="ISORT" time="0.020" /><testcase classname="invenio_vocabularies.records.pidprovider" name="black" time="0.184" /><testcase classname="invenio_vocabularies.records.systemfields.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.records.systemfields.__init__" name="ISORT" time="0.006" /><testcase classname="invenio_vocabularies.records.systemfields.__init__" name="black" time="0.168" /><testcase classname="invenio_vocabularies.records.systemfields.pid" name="PYDOCSTYLE" time="0.011" /><testcase classname="invenio_vocabularies.records.systemfields.pid" name="ISORT" time="0.022" /><testcase classname="invenio_vocabularies.records.systemfields.pid" name="black" time="0.180" /><testcase classname="invenio_vocabularies.records.systemfields.relations" name="PYDOCSTYLE" time="0.008" /><testcase classname="invenio_vocabularies.records.systemfields.relations" name="ISORT" time="0.013" /><testcase classname="invenio_vocabularies.records.systemfields.relations" name="black" time="0.170" /><testcase classname="invenio_vocabularies.resources.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.resources.__init__" name="ISORT" time="0.009" /><testcase classname="invenio_vocabularies.resources.__init__" name="black" time="0.170" /><testcase classname="invenio_vocabularies.resources.config" name="PYDOCSTYLE" time="0.008" /><testcase classname="invenio_vocabularies.resources.config" name="ISORT" time="0.024" /><testcase classname="invenio_vocabularies.resources.config" name="black" time="0.182" /><testcase classname="invenio_vocabularies.resources.resource" name="PYDOCSTYLE" time="0.015" /><testcase classname="invenio_vocabularies.resources.resource" name="ISORT" time="0.032" /><testcase classname="invenio_vocabularies.resources.resource" name="black" time="0.189" /><testcase classname="invenio_vocabularies.resources.schema" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.resources.schema" name="ISORT" time="0.009" /><testcase classname="invenio_vocabularies.resources.schema" name="black" time="0.170" /><testcase classname="invenio_vocabularies.resources.serializer" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.resources.serializer" name="ISORT" time="0.013" /><testcase classname="invenio_vocabularies.resources.serializer" name="black" time="0.175" /><testcase classname="invenio_vocabularies.services.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.services.__init__" name="ISORT" time="0.007" /><testcase classname="invenio_vocabularies.services.__init__" name="black" time="0.169" /><testcase classname="invenio_vocabularies.services.components" name="PYDOCSTYLE" time="0.008" /><testcase classname="invenio_vocabularies.services.components" name="ISORT" time="0.016" /><testcase classname="invenio_vocabularies.services.components" name="black" time="0.182" /><testcase classname="invenio_vocabularies.services.config" name="PYDOCSTYLE" time="0.012" /><testcase classname="invenio_vocabularies.services.config" name="ISORT" time="0.036" /><testcase classname="invenio_vocabularies.services.config" name="black" time="0.196" /><testcase classname="invenio_vocabularies.services.custom_fields.__init__" name="PYDOCSTYLE" time="0.004" /><testcase classname="invenio_vocabularies.services.custom_fields.__init__" name="ISORT" time="0.007" /><testcase classname="invenio_vocabularies.services.custom_fields.__init__" name="black" time="0.174" /><testcase classname="invenio_vocabularies.services.custom_fields.subject" name="PYDOCSTYLE" time="0.008" /><testcase classname="invenio_vocabularies.services.custom_fields.subject" name="ISORT" time="0.018" /><testcase classname="invenio_vocabularies.services.custom_fields.subject" name="black" time="0.178" /><testcase classname="invenio_vocabularies.services.custom_fields.vocabulary" name="PYDOCSTYLE" time="0.010" /><testcase classname="invenio_vocabularies.services.custom_fields.vocabulary" name="ISORT" time="0.021" /><testcase classname="invenio_vocabularies.services.custom_fields.vocabulary" name="black" time="0.188" /><testcase classname="invenio_vocabularies.services.facets" name="PYDOCSTYLE" time="0.013" /><testcase classname="invenio_vocabularies.services.facets" name="ISORT" time="0.026" /><testcase classname="invenio_vocabularies.services.facets" name="black" time="0.190" /><testcase classname="invenio_vocabularies.services.generators" name="PYDOCSTYLE" time="0.007" /><testcase classname="invenio_vocabularies.services.generators" name="ISORT" time="0.012" /><testcase classname="invenio_vocabularies.services.generators" name="black" time="0.172" /><testcase classname="invenio_vocabularies.services.permissions" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.services.permissions" name="ISORT" time="0.011" /><testcase classname="invenio_vocabularies.services.permissions" name="black" time="0.172" /><testcase classname="invenio_vocabularies.services.querystr" name="PYDOCSTYLE" time="0.008" /><testcase classname="invenio_vocabularies.services.querystr" name="ISORT" time="0.015" /><testcase classname="invenio_vocabularies.services.querystr" name="black" time="0.181" /><testcase classname="invenio_vocabularies.services.results" name="PYDOCSTYLE" time="0.012" /><testcase classname="invenio_vocabularies.services.results" name="ISORT" time="0.023" /><testcase classname="invenio_vocabularies.services.results" name="black" time="0.189" /><testcase classname="invenio_vocabularies.services.schema" name="PYDOCSTYLE" time="0.015" /><testcase classname="invenio_vocabularies.services.schema" name="ISORT" time="0.030" /><testcase classname="invenio_vocabularies.services.schema" name="black" time="0.194" /><testcase classname="invenio_vocabularies.services.service" name="PYDOCSTYLE" time="0.018" /><testcase classname="invenio_vocabularies.services.service" name="ISORT" time="0.036" /><testcase classname="invenio_vocabularies.services.service" name="black" time="0.202" /><testcase classname="invenio_vocabularies.services.tasks" name="PYDOCSTYLE" time="0.006" /><testcase classname="invenio_vocabularies.services.tasks" name="ISORT" time="0.012" /><testcase classname="invenio_vocabularies.services.tasks" name="black" time="0.171" /><testcase classname="invenio_vocabularies.views" name="PYDOCSTYLE" time="0.008" /><testcase classname="invenio_vocabularies.views" name="ISORT" time="0.012" /><testcase classname="invenio_vocabularies.views" name="black" time="0.177" /><testcase classname="invenio_vocabularies.webpack" name="PYDOCSTYLE" time="0.005" /><testcase classname="invenio_vocabularies.webpack" name="ISORT" time="0.013" /><testcase classname="invenio_vocabularies.webpack" name="black" time="0.219" /></testsuite></testsuites>