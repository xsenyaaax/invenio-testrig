 rabbitmq Pulling 
 opensearch Pulling 
 redis Pulling 
 redis Pulled 
 rabbitmq Pulled 
 opensearch Pulled 
 Network docker_services_cli_default  Creating
 Network docker_services_cli_default  Created
 Container docker_services_cli-redis-1  Creating
 Container docker_services_cli-opensearch-1  Creating
 Container docker_services_cli-rabbitmq-1  Creating
 Container docker_services_cli-opensearch-1  Created
 Container docker_services_cli-rabbitmq-1  Created
 Container docker_services_cli-redis-1  Created
 Container docker_services_cli-redis-1  Starting
 Container docker_services_cli-rabbitmq-1  Starting
 Container docker_services_cli-opensearch-1  Starting
 Container docker_services_cli-redis-1  Started
 Container docker_services_cli-rabbitmq-1  Started
 Container docker_services_cli-opensearch-1  Started
============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-8.4.2, pluggy-1.6.0 -- /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/bin/python
cachedir: .pytest_cache
rootdir: /home/runner/work/invenio-testrig/invenio-testrig/package-repo
configfile: setup.cfg
testpaths: docs, tests, invenio_indexer
plugins: github-actions-annotate-failures-0.3.0, pycodestyle-2.5.0, flask-1.3.0, black-ng-0.4.1, invenio-3.4.2, isort-4.0.0, cov-7.0.0, pydocstyle-2.4.0
collecting ... collected 100 items

docs/conf.py::PYDOCSTYLE PASSED
docs/conf.py::ISORT PASSED
docs/conf.py::black PASSED
tests/conftest.py::PYDOCSTYLE PASSED
tests/conftest.py::ISORT PASSED
tests/conftest.py::black PASSED
tests/data/__init__.py::PYDOCSTYLE PASSED
tests/data/__init__.py::ISORT PASSED
tests/data/__init__.py::black PASSED
tests/data/os-v1/__init__.py::PYDOCSTYLE PASSED
tests/data/os-v1/__init__.py::ISORT PASSED
tests/data/os-v1/__init__.py::black PASSED
tests/data/os-v2/__init__.py::PYDOCSTYLE PASSED
tests/data/os-v2/__init__.py::ISORT PASSED
tests/data/os-v2/__init__.py::black PASSED
tests/data/v7/__init__.py::PYDOCSTYLE PASSED
tests/data/v7/__init__.py::ISORT PASSED
tests/data/v7/__init__.py::black PASSED
tests/demo/__init__.py::PYDOCSTYLE PASSED
tests/demo/__init__.py::ISORT PASSED
tests/demo/__init__.py::black PASSED
tests/demo/json_resolver.py::PYDOCSTYLE PASSED
tests/demo/json_resolver.py::ISORT PASSED
tests/demo/json_resolver.py::black PASSED
tests/test_api.py::ISORT PASSED
tests/test_api.py::black PASSED
tests/test_api.py::test_indexer_bulk_index PASSED
tests/test_api.py::test_delete_action PASSED

tests/test_api.py::test_index_action PASSED

tests/test_api.py::test_process_bulk_queue PASSED

tests/test_api.py::test_process_bulk_queue_errors PASSED

tests/test_api.py::test_index PASSED

tests/test_api.py::test_refresh_with_indexer PASSED
tests/test_api.py::test_refresh_with_indexer_and_prefix PASSED
tests/test_api.py::test_refresh_with_index_name PASSED
tests/test_api.py::test_refresh_with_index_obj PASSED
tests/test_api.py::test_delete PASSED

tests/test_api.py::test_replace_refs PASSED
tests/test_api.py::test_bulkrecordindexer_index_delete_by_record_id PASSED
tests/test_api.py::test_bulkrecordindexer_index_delete_by_record PASSED

tests/test_api.py::test_before_record_index_dynamic_connect PASSED

tests/test_api.py::test_indexer_record_class PASSED
tests/test_cli.py::ISORT PASSED
tests/test_cli.py::black PASSED
tests/test_cli.py::test_run PASSED
tests/test_cli.py::test_reindex PASSED

tests/test_cli.py::test_queues_options PASSED
tests/test_invenio_indexer.py::ISORT PASSED
tests/test_invenio_indexer.py::black PASSED
tests/test_invenio_indexer.py::test_version PASSED
tests/test_invenio_indexer.py::test_init PASSED
tests/test_invenio_indexer.py::test_hook_initialization PASSED

tests/test_invenio_indexer.py::test_index_prefixing PASSED

tests/test_registry.py::ISORT PASSED
tests/test_registry.py::black PASSED
tests/test_registry.py::test_indexer_registry PASSED
tests/test_tasks.py::ISORT PASSED
tests/test_tasks.py::black PASSED
tests/test_tasks.py::test_process_bulk_queue PASSED
tests/test_tasks.py::test_index_record PASSED
tests/test_tasks.py::test_delete_record PASSED
tests/test_utils.py::ISORT PASSED
tests/test_utils.py::black PASSED
tests/test_utils.py::test_schema_to_index_with_names PASSED
tests/test_utils.py::test_schema_to_index[records/record-v1.0.0.json-records-record-v1.0.0-None] PASSED
tests/test_utils.py::test_schema_to_index[/records/record-v1.0.0.json-records-record-v1.0.0-None] PASSED
tests/test_utils.py::test_schema_to_index[default-v1.0.0.json-default-v1.0.0-None] PASSED
tests/test_utils.py::test_schema_to_index[default-v1.0.0.json-None-index_names3] PASSED
tests/test_utils.py::test_schema_to_index[invalidextension-None-None] PASSED
invenio_indexer/__init__.py::PYDOCSTYLE PASSED
invenio_indexer/__init__.py::ISORT PASSED
invenio_indexer/__init__.py::black PASSED
invenio_indexer/__init__.py::invenio_indexer PASSED

invenio_indexer/api.py::PYDOCSTYLE PASSED
invenio_indexer/api.py::ISORT PASSED
invenio_indexer/api.py::black PASSED
invenio_indexer/cli.py::PYDOCSTYLE PASSED
invenio_indexer/cli.py::ISORT PASSED
invenio_indexer/cli.py::black PASSED
invenio_indexer/config.py::PYDOCSTYLE PASSED
invenio_indexer/config.py::ISORT PASSED
invenio_indexer/config.py::black PASSED
invenio_indexer/ext.py::PYDOCSTYLE PASSED
invenio_indexer/ext.py::ISORT PASSED
invenio_indexer/ext.py::black PASSED
invenio_indexer/proxies.py::PYDOCSTYLE PASSED
invenio_indexer/proxies.py::ISORT PASSED
invenio_indexer/proxies.py::black PASSED
invenio_indexer/registry.py::PYDOCSTYLE PASSED
invenio_indexer/registry.py::ISORT PASSED
invenio_indexer/registry.py::black PASSED
invenio_indexer/signals.py::PYDOCSTYLE PASSED
invenio_indexer/signals.py::ISORT PASSED
invenio_indexer/signals.py::black PASSED
invenio_indexer/tasks.py::PYDOCSTYLE PASSED
invenio_indexer/tasks.py::ISORT PASSED
invenio_indexer/tasks.py::black PASSED
invenio_indexer/utils.py::PYDOCSTYLE PASSED
invenio_indexer/utils.py::ISORT PASSED
invenio_indexer/utils.py::black PASSED

=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/jsonresolver/contrib/jsonschema.py:31
.venv/lib/python3.12/site-packages/jsonresolver/contrib/jsonschema.py:31
    from jsonschema import RefResolver as _RefResolver

.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
    from jsonschema import RefResolutionError, RefResolver

.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
.venv/lib/python3.12/site-packages/invenio_records/resolver.py:14
    from jsonschema import RefResolutionError, RefResolver

    return util.wrap_callable(lambda ctx: fn(), fn)  # type: ignore

  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_records/api.py:335: SAWarning: nested transaction already deassociated from connection
    with db.session.begin_nested():

tests/test_api.py::test_delete_action
tests/test_cli.py::test_reindex
tests/test_invenio_indexer.py::test_index_prefixing
    target.updated = datetime.utcnow()

tests/test_api.py::test_delete_action
tests/test_cli.py::test_reindex
  /home/runner/work/invenio-testrig/invenio-testrig/package-repo/.venv/lib/python3.12/site-packages/invenio_records/api.py:496: SAWarning: nested transaction already deassociated from connection
    with db.session.begin_nested():

tests/test_cli.py::test_reindex
tests/test_cli.py::test_reindex
    .values(PersistentIdentifier.object_uuid)

- generated xml file: /home/runner/work/invenio-testrig/invenio-testrig/artifacts/test-report-patched.xml -
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.12-final-0 _______________

Name                          Stmts   Miss  Cover   Missing
invenio_indexer/__init__.py       4      0   100%
invenio_indexer/api.py          179     22    88%   106, 116, 118-127, 159, 195-200, 238-247, 261-262, 398-399, 459
invenio_indexer/cli.py           82      3    96%   26, 35, 82
invenio_indexer/config.py        21      0   100%
invenio_indexer/ext.py           26      0   100%
invenio_indexer/proxies.py        7      0   100%
invenio_indexer/registry.py      16      0   100%
invenio_indexer/signals.py       16      0   100%
invenio_indexer/tasks.py         21      3    86%   29, 44, 59
invenio_indexer/utils.py         26      0   100%
TOTAL                           398     28    93%
====================== 100 passed, 65 warnings in 10.17s =======================
 Container docker_services_cli-opensearch-1  Stopping
 Container docker_services_cli-rabbitmq-1  Stopping
 Container docker_services_cli-redis-1  Stopping
 Container docker_services_cli-redis-1  Stopped
 Container docker_services_cli-redis-1  Removing
 Container docker_services_cli-redis-1  Removed
 Container docker_services_cli-opensearch-1  Stopped
 Container docker_services_cli-opensearch-1  Removing
 Container docker_services_cli-opensearch-1  Removed
 Container docker_services_cli-rabbitmq-1  Stopped
 Container docker_services_cli-rabbitmq-1  Removing
 Container docker_services_cli-rabbitmq-1  Removed
 Network docker_services_cli_default  Removing
 Network docker_services_cli_default  Removed
